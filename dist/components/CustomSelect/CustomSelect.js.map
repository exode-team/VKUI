{"version":3,"sources":["../../../src/components/CustomSelect/CustomSelect.tsx"],"names":["React","SelectMimicry","debounce","multiRef","getTitleFromChildren","classNames","withAdaptivity","CustomSelectOption","Input","DropdownIcon","Caption","warnOnce","defaultFilterFn","getFormFieldModeFromSelectType","CustomSelectDropdown","SelectType","useIsomorphicLayoutEffect","findIndexAfter","options","startIndex","length","findIndex","option","i","disabled","findIndexBefore","endIndex","result","warn","checkOptionsValueType","Set","map","item","value","size","defaultRenderOptionFn","props","handleOptionDown","e","preventDefault","findSelectedIndex","Number","filter","inputValue","filterFn","defaultOptions","CustomSelectComponent","useState","opened","setOpened","before","name","className","getRef","getRootRef","popupDirection","sizeY","platform","style","onChange","children","onInputChangeProp","onInputChange","renderDropdown","onOpen","onClose","fetching","forceDropdownPortal","selectType","default","autoHideScrollbar","autoHideScrollbarDelay","searchable","renderOption","renderOptionProp","optionsProp","emptyText","icon","dropdownOffsetDistance","fixDropdownWidth","restProps","process","env","NODE_ENV","containerRef","useRef","scrollBoxRef","selectElRef","focusedOptionIndex","setFocusedOptionIndex","undefined","isControlledOutside","setIsControlledOutside","setInputValue","defaultValue","nativeSelectValue","setNativeSelectValue","keyboardInput","setKeyboardInput","popperPlacement","setPopperPlacement","setOptions","selectedOptionIndex","setSelectedOptionIndex","useEffect","some","event","Event","bubbles","current","dispatchEvent","selected","useMemo","openedClassNames","includes","resetKeyboardInput","useCallback","scrollToElement","index","center","dropdown","dropdownHeight","offsetHeight","scrollTop","itemTop","offsetTop","itemHeight","isValidIndex","focusOptionByIndex","scrollTo","areOptionsShown","onKeyboardInput","key","fullInput","optionIndex","label","toLowerCase","close","selectFocused","open","onBlur","resetFocusedOption","onFocus","onClick","handleKeyUp","focusOption","type","nextIndex","beforeIndex","onLabelClick","contains","target","onNativeSelectChange","newSelectedOptionIndex","currentTarget","onInputKeyDown","handleKeyDownSelect","handleOptionClick","Array","prototype","indexOf","call","parentNode","handleOptionHover","hovered","onMouseDown","onMouseOver","resolvedContent","defaultDropdownContent","placeholder","CustomSelect"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { SelectMimicry } from \"../SelectMimicry/SelectMimicry\";\nimport { debounce, multiRef, getTitleFromChildren } from \"../../lib/utils\";\nimport { classNames } from \"../../lib/classNames\";\nimport { NativeSelectProps } from \"../NativeSelect/NativeSelect\";\nimport { withAdaptivity } from \"../../hoc/withAdaptivity\";\nimport {\n  CustomSelectOption,\n  CustomSelectOptionProps,\n} from \"../CustomSelectOption/CustomSelectOption\";\nimport { FormFieldProps } from \"../FormField/FormField\";\nimport { HasPlatform } from \"../../types\";\nimport { Input } from \"../Input/Input\";\nimport { DropdownIcon } from \"../DropdownIcon/DropdownIcon\";\nimport { Caption } from \"../Typography/Caption/Caption\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport {\n  defaultFilterFn,\n  getFormFieldModeFromSelectType,\n} from \"../../lib/select\";\nimport { Placement } from \"../Popper/Popper\";\nimport { CustomSelectDropdown } from \"../CustomSelectDropdown/CustomSelectDropdown\";\nimport { TrackerOptionsProps } from \"../CustomScrollView/useTrackerVisibility\";\nimport { SelectType } from \"../Select/Select\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport \"./CustomSelect.css\";\n\nconst findIndexAfter = (\n  options: CustomSelectOptionInterface[] = [],\n  startIndex = -1\n) => {\n  if (startIndex >= options.length - 1) {\n    return -1;\n  }\n  return options.findIndex((option, i) => i > startIndex && !option.disabled);\n};\n\nconst findIndexBefore = (\n  options: CustomSelectOptionInterface[] = [],\n  endIndex: number = options.length\n) => {\n  let result = -1;\n  if (endIndex <= 0) {\n    return result;\n  }\n  for (let i = endIndex - 1; i >= 0; i--) {\n    let option = options[i];\n\n    if (!option.disabled) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n};\n\nconst warn = warnOnce(\"CustomSelect\");\n\nconst checkOptionsValueType = (options: CustomSelectOptionInterface[]) => {\n  if (new Set(options.map((item) => typeof item.value)).size > 1) {\n    warn(\n      \"Некоторые значения ваших опций имеют разные типы. onChange всегда возвращает строковый тип.\",\n      \"error\"\n    );\n  }\n};\n\nfunction defaultRenderOptionFn({\n  option,\n  ...props\n}: CustomSelectOptionProps): React.ReactNode {\n  return <CustomSelectOption {...props} />;\n}\n\nconst handleOptionDown: MouseEventHandler = (\n  e: React.MouseEvent<HTMLElement>\n) => {\n  e.preventDefault();\n};\n\nfunction findSelectedIndex(\n  options: CustomSelectOptionInterface[],\n  value: SelectValue\n) {\n  return (\n    options.findIndex((item) => {\n      value = typeof item.value === \"number\" ? Number(value) : value;\n      return item.value === value;\n    }) ?? -1\n  );\n}\n\nconst filter = (\n  options: CustomSelectProps[\"options\"],\n  inputValue: string,\n  filterFn: CustomSelectProps[\"filterFn\"]\n) => {\n  return typeof filterFn === \"function\"\n    ? options.filter((option) => filterFn(inputValue, option))\n    : options;\n};\n\nconst defaultOptions: CustomSelectOptionInterface[] = [];\n\ntype SelectValue = React.SelectHTMLAttributes<HTMLSelectElement>[\"value\"];\n\nexport interface CustomSelectOptionInterface {\n  value: SelectValue;\n  label: React.ReactElement | string;\n  disabled?: boolean;\n  [index: string]: any;\n}\n\nexport interface CustomSelectProps\n  extends NativeSelectProps,\n    HasPlatform,\n    FormFieldProps,\n    TrackerOptionsProps {\n  /**\n   * Если `true`, то при клике на селект в нём появится текстовое поле для поиска по `options`. По умолчанию поиск\n   * производится по `option.label`.\n   */\n  searchable?: boolean;\n  /**\n   * Текст, который будет отображен, если приходит пустой `options`.\n   */\n  emptyText?: string;\n  onInputChange?: (\n    e: React.ChangeEvent,\n    options: CustomSelectOptionInterface[]\n  ) => void | CustomSelectOptionInterface[];\n  options: CustomSelectOptionInterface[];\n  /**\n   * Функция для кастомной фильтрации. По умолчанию поиск производится по `option.label`.\n   */\n  filterFn?:\n    | false\n    | ((\n        value: string,\n        option: CustomSelectOptionInterface,\n        getOptionLabel?: (\n          option: Partial<CustomSelectOptionInterface>\n        ) => string\n      ) => boolean);\n  popupDirection?: \"top\" | \"bottom\";\n  /**\n   * Рендер-проп для кастомного рендера опции.\n   * В объекте аргумента приходят [свойства опции](https://vkcom.github.io/VKUI/#/CustomSelectOption?id=props)\n   */\n  renderOption?: (props: CustomSelectOptionProps) => React.ReactNode;\n  /**\n   * Рендер-проп для кастомного рендера содержимого дропдауна.\n   * В `defaultDropdownContent` содержится список опций в виде скроллящегося блока.\n   */\n  renderDropdown?: ({\n    defaultDropdownContent,\n  }: {\n    defaultDropdownContent: React.ReactNode;\n  }) => React.ReactNode;\n  /**\n   * Если `true`, то в дропдауне вместо списка опций рисуется спиннер. При переданных `renderDropdown` и `fetching: true`\n   * \"победит\" `renderDropdown`.\n   */\n  fetching?: boolean;\n  onClose?: VoidFunction;\n  onOpen?: VoidFunction;\n  icon?: React.ReactNode;\n  dropdownOffsetDistance?: number;\n  fixDropdownWidth?: boolean;\n  forceDropdownPortal?: boolean;\n  selectType?: keyof typeof SelectType;\n}\n\ntype MouseEventHandler = (event: React.MouseEvent<HTMLElement>) => void;\n\nfunction CustomSelectComponent(props: CustomSelectProps) {\n  const [opened, setOpened] = React.useState(false);\n  const {\n    before,\n    name,\n    className,\n    getRef,\n    getRootRef,\n    popupDirection,\n    sizeY,\n    platform,\n    style,\n    onChange,\n    children,\n    onInputChange: onInputChangeProp,\n    renderDropdown,\n    onOpen,\n    onClose,\n    fetching,\n    forceDropdownPortal,\n    selectType = SelectType.default,\n    autoHideScrollbar,\n    autoHideScrollbarDelay,\n    searchable = false,\n    renderOption: renderOptionProp = defaultRenderOptionFn,\n    options: optionsProp = defaultOptions,\n    emptyText = \"Ничего не найдено\",\n    filterFn = defaultFilterFn,\n    icon = <DropdownIcon opened={opened} />,\n    dropdownOffsetDistance = 0,\n    fixDropdownWidth = true,\n    ...restProps\n  } = props;\n\n  if (process.env.NODE_ENV === \"development\") {\n    checkOptionsValueType(optionsProp);\n  }\n\n  const containerRef = React.useRef<HTMLLabelElement>(null);\n  const scrollBoxRef = React.useRef<HTMLDivElement>(null);\n  const selectElRef = React.useRef<HTMLSelectElement>(null);\n\n  const [focusedOptionIndex, setFocusedOptionIndex] = React.useState<\n    number | undefined\n  >(-1);\n  const [isControlledOutside, setIsControlledOutside] = React.useState(\n    props.value !== undefined\n  );\n  const [inputValue, setInputValue] = React.useState(\"\");\n  const [nativeSelectValue, setNativeSelectValue] = React.useState(\n    props.value ?? props.defaultValue\n  );\n  const [keyboardInput, setKeyboardInput] = React.useState(\"\");\n  const [popperPlacement, setPopperPlacement] = React.useState<\n    Placement | undefined\n  >(undefined);\n  const [options, setOptions] = React.useState(optionsProp);\n  const [selectedOptionIndex, setSelectedOptionIndex] = React.useState<\n    number | undefined\n  >(findSelectedIndex(optionsProp, props.value ?? props.defaultValue));\n\n  React.useEffect(() => {\n    setIsControlledOutside(props.value !== undefined);\n    setNativeSelectValue(\n      (nativeSelectValue) => props.value ?? nativeSelectValue\n    );\n  }, [props.value]);\n\n  useIsomorphicLayoutEffect(() => {\n    if (options.some(({ value }) => nativeSelectValue === value)) {\n      const event = new Event(\"change\", { bubbles: true });\n\n      selectElRef.current?.dispatchEvent(event);\n    }\n  }, [nativeSelectValue]);\n\n  const selected = React.useMemo(() => {\n    if (!options.length) {\n      return null;\n    }\n\n    return selectedOptionIndex !== undefined\n      ? options[selectedOptionIndex]\n      : undefined;\n  }, [options, selectedOptionIndex]);\n\n  const openedClassNames = React.useMemo(\n    () =>\n      classNames(\n        opened && \"Select--open\",\n        opened &&\n          dropdownOffsetDistance === 0 &&\n          (popperPlacement?.includes(\"top\")\n            ? \"Select--pop-up\"\n            : \"Select--pop-down\")\n      ),\n    [dropdownOffsetDistance, opened, popperPlacement]\n  );\n\n  const resetKeyboardInput = React.useCallback(() => {\n    setKeyboardInput(\"\");\n  }, []);\n\n  const scrollToElement = React.useCallback((index: number, center = false) => {\n    const dropdown = scrollBoxRef.current;\n    const item = dropdown ? (dropdown.children[index] as HTMLElement) : null;\n\n    if (!item || !dropdown) {\n      return;\n    }\n\n    const dropdownHeight = dropdown.offsetHeight;\n    const scrollTop = dropdown.scrollTop;\n    const itemTop = item.offsetTop;\n    const itemHeight = item.offsetHeight;\n\n    if (center) {\n      dropdown.scrollTop = itemTop - dropdownHeight / 2 + itemHeight / 2;\n    } else if (itemTop + itemHeight > dropdownHeight + scrollTop) {\n      dropdown.scrollTop = itemTop - dropdownHeight + itemHeight;\n    } else if (itemTop < scrollTop) {\n      dropdown.scrollTop = itemTop;\n    }\n  }, []);\n\n  const isValidIndex = React.useCallback(\n    (index: number) => {\n      return index >= 0 && index < (options.length ?? 0);\n    },\n    [options.length]\n  );\n\n  const focusOptionByIndex = React.useCallback(\n    (index: number | undefined, scrollTo = true) => {\n      if (\n        index === undefined ||\n        index < 0 ||\n        index > (options.length ?? 0) - 1\n      ) {\n        return;\n      }\n\n      const option = options[index];\n\n      if (option?.disabled) {\n        return;\n      }\n\n      if (scrollTo) {\n        scrollToElement(index);\n      }\n\n      // Это оптимизация, прежде всего, под `onMouseOver`\n      setFocusedOptionIndex((focusedOptionIndex) =>\n        focusedOptionIndex !== index ? index : focusedOptionIndex\n      );\n    },\n    [options, scrollToElement]\n  );\n\n  const areOptionsShown = React.useCallback(() => {\n    return scrollBoxRef.current !== null;\n  }, []);\n\n  const onKeyboardInput = React.useCallback(\n    (key: string) => {\n      const fullInput = keyboardInput + key;\n\n      const optionIndex = options.findIndex((option) => {\n        return getTitleFromChildren(option.label)\n          .toLowerCase()\n          .includes(fullInput);\n      });\n\n      if (optionIndex !== undefined && optionIndex > -1) {\n        focusOptionByIndex(optionIndex);\n      }\n\n      setKeyboardInput(fullInput);\n    },\n    [focusOptionByIndex, keyboardInput, options]\n  );\n\n  const close = React.useCallback(() => {\n    resetKeyboardInput();\n\n    setInputValue(\"\");\n    setOpened(false);\n    setFocusedOptionIndex(-1);\n    setOptions(optionsProp);\n    onClose?.();\n  }, [onClose, optionsProp, resetKeyboardInput]);\n\n  const selectFocused = React.useCallback(() => {\n    if (focusedOptionIndex !== undefined && isValidIndex(focusedOptionIndex)) {\n      const item = options[focusedOptionIndex];\n\n      setNativeSelectValue(item?.value);\n      close();\n    }\n  }, [close, focusedOptionIndex, isValidIndex, options]);\n\n  const open = React.useCallback(() => {\n    setOpened(true);\n    setFocusedOptionIndex(selectedOptionIndex);\n\n    if (typeof onOpen === \"function\") {\n      onOpen();\n    }\n  }, [onOpen, selectedOptionIndex]);\n\n  React.useEffect(() => {\n    if (\n      opened &&\n      selectedOptionIndex !== undefined &&\n      isValidIndex(selectedOptionIndex)\n    ) {\n      scrollToElement(selectedOptionIndex, true);\n    }\n  }, [isValidIndex, opened, scrollToElement, selectedOptionIndex]);\n\n  const onBlur = React.useCallback(() => {\n    close();\n    const event = new Event(\"blur\");\n    selectElRef.current?.dispatchEvent(event);\n  }, [close]);\n\n  const resetFocusedOption = React.useCallback(() => {\n    setFocusedOptionIndex(-1);\n  }, []);\n\n  const onFocus = React.useCallback(() => {\n    const event = new Event(\"focus\");\n    selectElRef.current?.dispatchEvent(event);\n  }, []);\n\n  const onClick = React.useCallback(() => {\n    if (opened) {\n      close();\n    } else {\n      open();\n    }\n  }, [close, open, opened]);\n\n  const handleKeyUp = React.useMemo(\n    () => debounce(resetKeyboardInput, 1000),\n    [resetKeyboardInput]\n  );\n\n  const focusOption = React.useCallback(\n    (type: \"next\" | \"prev\") => {\n      let index = focusedOptionIndex;\n\n      if (type === \"next\") {\n        const nextIndex = findIndexAfter(options, index);\n        index = nextIndex === -1 ? findIndexAfter(options) : nextIndex; // Следующий за index или первый валидный до index\n      } else if (type === \"prev\") {\n        const beforeIndex = findIndexBefore(options, index);\n        index = beforeIndex === -1 ? findIndexBefore(options) : beforeIndex; // Предшествующий index или последний валидный после index\n      }\n\n      focusOptionByIndex(index);\n    },\n    [focusOptionByIndex, focusedOptionIndex, options]\n  );\n\n  React.useEffect(() => {\n    const value = props.value ?? nativeSelectValue ?? props.defaultValue;\n\n    const options =\n      searchable && inputValue !== undefined\n        ? filter(optionsProp, inputValue, filterFn)\n        : optionsProp;\n\n    setOptions(options);\n    setSelectedOptionIndex(findSelectedIndex(options, value));\n  }, [\n    filterFn,\n    inputValue,\n    nativeSelectValue,\n    optionsProp,\n    props.defaultValue,\n    props.value,\n    searchable,\n  ]);\n\n  /**\n   * Нужен для правильного поведения обработчика onClick на select. Фильтрует клики, которые были сделаны по\n   * выпадающему списку.\n   */\n  const onLabelClick = React.useCallback(\n    (e: React.MouseEvent<HTMLLabelElement>) => {\n      if (scrollBoxRef.current?.contains(e.target as Node)) {\n        e.preventDefault();\n      }\n    },\n    []\n  );\n\n  const onNativeSelectChange: React.ChangeEventHandler<HTMLSelectElement> =\n    React.useCallback(\n      (e) => {\n        const newSelectedOptionIndex = findSelectedIndex(\n          options,\n          e.currentTarget.value\n        );\n\n        if (selectedOptionIndex !== newSelectedOptionIndex) {\n          if (!isControlledOutside) {\n            setSelectedOptionIndex(newSelectedOptionIndex);\n          }\n          onChange?.(e);\n        }\n      },\n      [isControlledOutside, onChange, options, selectedOptionIndex]\n    );\n\n  const onInputKeyDown: React.KeyboardEventHandler<HTMLInputElement> =\n    React.useCallback(\n      (event) => {\n        [\"ArrowUp\", \"ArrowDown\", \"Escape\", \"Enter\"].includes(event.key) &&\n          areOptionsShown() &&\n          event.preventDefault();\n\n        switch (event.key) {\n          case \"ArrowUp\":\n            areOptionsShown() && focusOption(\"prev\");\n            break;\n          case \"ArrowDown\":\n            areOptionsShown() && focusOption(\"next\");\n            break;\n          case \"Escape\":\n            close();\n            break;\n          case \"Enter\":\n            areOptionsShown() && selectFocused();\n            break;\n        }\n      },\n      [areOptionsShown, close, focusOption, selectFocused]\n    );\n\n  const onInputChange: React.ChangeEventHandler<HTMLInputElement> =\n    React.useCallback(\n      (e) => {\n        if (onInputChangeProp) {\n          const options = onInputChangeProp(e, optionsProp);\n          if (options) {\n            if (process.env.NODE_ENV === \"development\") {\n              warn(\n                \"Этот метод фильтрации устарел. Возвращаемое значение onInputChange будет \" +\n                  \"проигнорировано в v5.0.0. Для фильтрации обновляйте props.options самостоятельно или используйте свойство filterFn.\"\n              );\n            }\n            setOptions(options);\n            setSelectedOptionIndex(\n              findSelectedIndex(options, nativeSelectValue)\n            );\n          }\n        } else {\n          const options = filter(optionsProp, e.target.value, filterFn);\n          setOptions(options);\n          setSelectedOptionIndex(findSelectedIndex(options, nativeSelectValue));\n        }\n        setInputValue(e.target.value);\n      },\n      [filterFn, nativeSelectValue, onInputChangeProp, optionsProp]\n    );\n\n  const handleKeyDownSelect = React.useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key.length === 1 && event.key !== \" \") {\n        onKeyboardInput(event.key);\n        return;\n      }\n\n      [\"ArrowUp\", \"ArrowDown\", \"Escape\", \"Enter\"].includes(event.key) &&\n        areOptionsShown() &&\n        event.preventDefault();\n\n      switch (event.key) {\n        case \"ArrowUp\":\n          if (opened) {\n            areOptionsShown() && focusOption(\"prev\");\n          } else {\n            open();\n          }\n          break;\n        case \"ArrowDown\":\n          if (opened) {\n            areOptionsShown() && focusOption(\"next\");\n          } else {\n            open();\n          }\n          break;\n        case \"Escape\":\n          close();\n          break;\n        case \"Enter\":\n        case \"Spacebar\":\n        case \" \":\n          if (opened) {\n            areOptionsShown() && selectFocused();\n          } else {\n            open();\n          }\n          break;\n      }\n    },\n    [\n      areOptionsShown,\n      close,\n      focusOption,\n      onKeyboardInput,\n      open,\n      opened,\n      selectFocused,\n    ]\n  );\n\n  const handleOptionClick = React.useCallback(\n    (e: React.MouseEvent<HTMLElement>) => {\n      const index = Array.prototype.indexOf.call(\n        e.currentTarget.parentNode?.children,\n        e.currentTarget\n      );\n      const option = options[index];\n\n      if (option && !option.disabled) {\n        selectFocused();\n      }\n    },\n    [options, selectFocused]\n  );\n\n  const handleOptionHover = React.useCallback(\n    (e: React.MouseEvent<HTMLElement>) => {\n      focusOptionByIndex(\n        Array.prototype.indexOf.call(\n          e.currentTarget.parentNode?.children,\n          e.currentTarget\n        ),\n        false\n      );\n    },\n    [focusOptionByIndex]\n  );\n\n  const renderOption = React.useCallback(\n    (option: CustomSelectOptionInterface, index: number) => {\n      const hovered = index === focusedOptionIndex;\n      const selected = index === selectedOptionIndex;\n\n      return (\n        <React.Fragment key={`${option.value}`}>\n          {renderOptionProp({\n            option,\n            hovered,\n            children: option.label,\n            selected,\n            disabled: option.disabled,\n            onClick: handleOptionClick,\n            onMouseDown: handleOptionDown,\n            // Используем `onMouseOver` вместо `onMouseEnter`.\n            // При параметре `searchable`, обновляется \"ребёнок\", из-за чего `onMouseEnter` не срабатывает в следующих кейсах:\n            //  1. До загрузки выпадающего списка, курсор мышки находится над произвольным элементом этого списка.\n            //     > Лечение: только увод курсора мыши и возвращении его обратно вызывает событие `onMouseEnter` на этот элемент.\n            //  2. Если это тач-устройство.\n            //     > Лечение: нужно нажать на какой-нибудь произвольный элемент списка, после чего `onMouseEnter` будет работать на соседние элементы,\n            //     но не на тот, на который нажали в первый раз.\n            // Более подробно по ссылке https://github.com/facebook/react/issues/13956#issuecomment-1082055744\n            onMouseOver: handleOptionHover,\n          })}\n        </React.Fragment>\n      );\n    },\n    [\n      focusedOptionIndex,\n      handleOptionClick,\n      handleOptionHover,\n      renderOptionProp,\n      selectedOptionIndex,\n    ]\n  );\n\n  const resolvedContent = React.useMemo(() => {\n    const defaultDropdownContent =\n      options?.length > 0 ? (\n        options.map(renderOption)\n      ) : (\n        <Caption vkuiClass=\"CustomSelect__empty\">{emptyText}</Caption>\n      );\n\n    if (typeof renderDropdown === \"function\") {\n      return renderDropdown({ defaultDropdownContent });\n    } else {\n      return defaultDropdownContent;\n    }\n  }, [emptyText, options, renderDropdown, renderOption]);\n\n  return (\n    <label\n      vkuiClass=\"CustomSelect\"\n      className={className}\n      style={style}\n      ref={multiRef(containerRef, getRootRef)}\n      onClick={onLabelClick}\n    >\n      {opened && searchable ? (\n        <Input\n          {...restProps}\n          autoFocus\n          onBlur={onBlur}\n          vkuiClass={openedClassNames}\n          value={inputValue}\n          onKeyDown={onInputKeyDown}\n          onChange={onInputChange}\n          // TODO Ожидается, что клик поймает нативный select, но его перехватывает Input. К сожалению, это приводит к конфликтам типизации.\n          // TODO Нужно перестать пытаться превратить CustomSelect в select. Тогда эта проблема уйдёт.\n          // @ts-ignore\n          onClick={props.onClick}\n          before={before}\n          after={icon}\n          placeholder={restProps.placeholder}\n          mode={getFormFieldModeFromSelectType(selectType)}\n        />\n      ) : (\n        <SelectMimicry\n          {...restProps}\n          aria-hidden={true}\n          onClick={onClick}\n          onKeyDown={handleKeyDownSelect}\n          onKeyUp={handleKeyUp}\n          onFocus={onFocus}\n          onBlur={onBlur}\n          vkuiClass={openedClassNames}\n          before={before}\n          after={icon}\n          selectType={selectType}\n        >\n          {selected?.label}\n        </SelectMimicry>\n      )}\n      <select\n        ref={selectElRef}\n        name={name}\n        onChange={onNativeSelectChange}\n        onBlur={props.onBlur}\n        onFocus={props.onFocus}\n        onClick={props.onClick}\n        value={nativeSelectValue}\n        aria-hidden={true}\n        vkuiClass=\"CustomSelect__control\"\n      >\n        {optionsProp.map((item) => (\n          <option key={`${item.value}`} value={item.value} />\n        ))}\n      </select>\n      {opened && (\n        <CustomSelectDropdown\n          targetRef={containerRef}\n          placement={popupDirection}\n          scrollBoxRef={scrollBoxRef}\n          onPlacementChange={setPopperPlacement}\n          onMouseLeave={resetFocusedOption}\n          fetching={fetching}\n          offsetDistance={dropdownOffsetDistance}\n          sameWidth={fixDropdownWidth}\n          forcePortal={forceDropdownPortal}\n          autoHideScrollbar={autoHideScrollbar}\n          autoHideScrollbarDelay={autoHideScrollbarDelay}\n          observableRefs={scrollBoxRef}\n        >\n          {resolvedContent}\n        </CustomSelectDropdown>\n      )}\n    </label>\n  );\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/CustomSelect\n */\nexport const CustomSelect = withAdaptivity(CustomSelectComponent, {\n  sizeY: true,\n});\n"],"file":"CustomSelect.js"}