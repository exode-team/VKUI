{"version":3,"file":"PromoBanner.js","names":["React","Icon24Dismiss","Button","SimpleCell","Avatar","Caption","warnOnce","warn","PromoBanner","bannerData","onClose","isCloseButtonHidden","restProps","ageRestrictions","parseInt","ageRestriction","process","env","NODE_ENV","useState","currentPixel","setCurrentPixel","statsPixels","useMemo","statistics","reduce","acc","item","type","url","onClick","useCallback","click","useEffect","playbackStarted","advertisingLabel","trackingLink","iconLink","title","undefined","ctaText","domain","length"],"sources":["../../../src/components/PromoBanner/PromoBanner.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Icon24Dismiss } from \"@vkontakte/icons\";\nimport { Button } from \"../Button/Button\";\nimport { SimpleCell } from \"../SimpleCell/SimpleCell\";\nimport { Avatar } from \"../Avatar/Avatar\";\nimport { Caption } from \"../Typography/Caption/Caption\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport \"./PromoBanner.css\";\n\ntype StatsType =\n  | \"playbackStarted\" // Начало показа\n  | \"click\"; // Клик по баннеру\n\ntype BannerData = {\n  title?: string;\n  url_types?: string; // eslint-disable-line camelcase\n  bannerID?: string;\n  imageWidth?: number;\n  imageHeight?: number;\n  imageLink?: string;\n  trackingLink?: string;\n  type?: string;\n  iconWidth?: number;\n  domain?: string;\n  ctaText?: string;\n  advertisingLabel?: string;\n  iconLink?: string;\n  statistics?: Array<{ type: StatsType; url: string }>;\n  openInBrowser?: boolean;\n  iconHeight?: number;\n  directLink?: boolean;\n  navigationType?: string;\n  description?: string;\n  ageRestrictions?: string;\n  /** @deprecated */\n  ageRestriction?: number;\n};\n\nexport interface PromoBannerProps extends React.HTMLAttributes<HTMLDivElement> {\n  /** Данные рекламного баннера, полученные из VKWebAppGetAds */\n  bannerData: BannerData;\n  /** Флаг скрытия кнопки закрытия рекламы */\n  isCloseButtonHidden?: boolean;\n  /** Хандлер закрытия рекламы */\n  onClose: () => void;\n}\n\nconst warn = warnOnce(\"PromoBanner\");\n\n/**\n * @see https://vkcom.github.io/VKUI/#/PromoBanner\n */\nexport const PromoBanner = ({\n  bannerData = {},\n  onClose,\n  isCloseButtonHidden,\n  ...restProps\n}: PromoBannerProps) => {\n  const ageRestrictions =\n    bannerData.ageRestrictions != null\n      ? parseInt(bannerData.ageRestrictions)\n      : bannerData.ageRestriction;\n\n  if (bannerData.ageRestriction && process.env.NODE_ENV === \"development\") {\n    warn(\n      \"Свойство bannerData.ageRestriction устарело и будет удалено в 5.0.0. Используйте bannerData.ageRestrictions\"\n    );\n  }\n\n  const [currentPixel, setCurrentPixel] = React.useState(\"\");\n\n  const statsPixels = React.useMemo(\n    () =>\n      (bannerData.statistics\n        ? bannerData.statistics.reduce(\n            (acc, item) => ({ ...acc, [item.type]: item.url }),\n            {}\n          )\n        : {}) as Record<StatsType, string | void>,\n    [bannerData.statistics]\n  );\n\n  const onClick = React.useCallback(\n    () => setCurrentPixel(statsPixels.click || \"\"),\n    [statsPixels.click]\n  );\n\n  React.useEffect(() => {\n    if (statsPixels.playbackStarted) {\n      setCurrentPixel(statsPixels.playbackStarted);\n    }\n  }, [statsPixels.playbackStarted]);\n\n  return (\n    <div vkuiClass=\"PromoBanner\" {...restProps}>\n      <div vkuiClass=\"PromoBanner__head\">\n        <Caption vkuiClass=\"PromoBanner__label\">\n          {bannerData.advertisingLabel || \"Advertisement\"}\n        </Caption>\n        {ageRestrictions != null && (\n          <Caption vkuiClass=\"PromoBanner__age\">{ageRestrictions}+</Caption>\n        )}\n\n        {!isCloseButtonHidden && (\n          <div vkuiClass=\"PromoBanner__close\" onClick={onClose}>\n            <Icon24Dismiss />\n          </div>\n        )}\n      </div>\n      <SimpleCell\n        href={bannerData.trackingLink}\n        onClick={onClick}\n        rel=\"nofollow noopener noreferrer\"\n        target=\"_blank\"\n        before={\n          bannerData.iconLink && (\n            <Avatar\n              mode=\"image\"\n              size={48}\n              src={bannerData.iconLink}\n              alt={bannerData.title}\n              data-testid={\n                process.env.NODE_ENV === \"test\" ? \"avatar\" : undefined\n              }\n            />\n          )\n        }\n        after={\n          bannerData.ctaText && (\n            <Button\n              mode=\"outline\"\n              data-testid={\n                process.env.NODE_ENV === \"test\" ? \"button-ctaText\" : undefined\n              }\n            >\n              {bannerData.ctaText}\n            </Button>\n          )\n        }\n        subtitle={bannerData.domain}\n      >\n        {bannerData.title}\n      </SimpleCell>\n\n      {currentPixel.length > 0 && (\n        <div vkuiClass=\"PromoBanner__pixels\">\n          <img src={currentPixel} alt=\"\" />\n        </div>\n      )}\n    </div>\n  );\n};\n"],"mappings":"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"}