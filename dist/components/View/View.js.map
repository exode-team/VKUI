{"version":3,"sources":["../../../src/components/View/View.tsx"],"names":["React","classNames","transitionEvent","animationEvent","IOS","Touch","withPlatform","withContext","ConfigProviderContext","SplitColContext","AppRootPortal","canUseDOM","withDOM","ScrollContext","NavTransitionProvider","getNavId","warnOnce","swipeBackExcluded","SwipeBackResults","scrollsCache","warn","ViewComponent","props","undefined","e","includes","animationName","state","prevPanel","flushTransition","Boolean","isBack","propertyName","target","pickPanel","swipeBackNextPanel","swipeBackResult","fail","onSwipeBackCancel","success","onSwipeBackSuccess","platform","configProvider","isWebView","startX","window","innerWidth","browserSwipe","setState","onSwipeBack","animated","swipingBack","history","length","activePanel","scrolls","scroll","getScroll","y","swipeBackStartX","swipeBackPrevPanel","slice","swipeBackShift","shiftX","speed","duration","visiblePanels","nextPanel","document","Children","toArray","children","process","env","NODE_ENV","popout","modal","id","animationFinishTimeout","clearTimeout","prevProps","prevState","blurActiveElement","firstLayerId","panels","map","panel","find","shouldDisableTransitionMotion","supported","setTimeout","transitionEndHandler","scrollTo","onTransition","from","to","onSwipeBackStart","waitTransitionFinish","swipingBackTransitionEndHandler","transitionMotionEnabled","splitCol","animate","elem","eventHandler","name","removeEventListener","addEventListener","transitionFinishTimeout","activeElement","blur","panelNodes","panelId","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","_1","nav","restProps","hasPopout","hasModal","filter","disableAnimation","onMoveX","onEnd","isTransitionTarget","compensateScroll","el","calcPanelSwipeStyles","marginTop","Component","View","displayName"],"mappings":";;;;;;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,UAAT;AACA,SAASC,eAAT,EAA0BC,cAA1B;AACA,SAASC,GAAT;AACA,SAASC,KAAT;AAEA,SAASC,YAAT;AACA,SAASC,WAAT;AACA,SACEC,qBADF;AAIA,SAASC,eAAT;AACA,SAASC,aAAT;AACA,SAASC,SAAT,EAAoBC,OAApB;AACA,SACEC,aADF;AAIA,SAASC,qBAAT;AACA,SAASC,QAAT;AACA,SAASC,QAAT;AACA,SAASC,iBAAT;IAGKC,gB;;WAAAA,gB;AAAAA,EAAAA,gB,CAAAA,gB;AAAAA,EAAAA,gB,CAAAA,gB;GAAAA,gB,KAAAA,gB;;AAeL,OAAO,IAAIC,YAA0B,GAAG,EAAjC;AAkEP,IAAMC,IAAI,GAAGJ,QAAQ,CAAC,MAAD,CAArB;;IAEMK,a;;;;;AACJ,yBAAYC,KAAZ,EAA8B;AAAA;;AAAA;;AAC5B,8BAAMA,KAAN;;AAD4B,8DA2BHH,YAAY,CAACJ,QAAQ,CAAC,MAAKO,KAAN,CAAT,CAAZ,IAAgD,EA3B7C;;AAAA,8EA4BwBC,SA5BxB;;AAAA,6EA6BuBA,SA7BvB;;AAAA,iEA2CwB,EA3CxB;;AAAA,2EAiQP,UAACC,CAAD,EAAoC;AACzD,UACE,CAAC,CAACA,CAAD,IACC,CACE,iCADF,EAEE,8BAFF,EAGE,kCAHF,EAIE,+BAJF,EAKEC,QALF,CAKWD,CAAC,CAACE,aALb,CADF,KAOA,MAAKC,KAAL,CAAWC,SAAX,KAAyB,IAR3B,EASE;AACA,cAAKC,eAAL,CAAqB,MAAKF,KAAL,CAAWC,SAAhC,EAA2CE,OAAO,CAAC,MAAKH,KAAL,CAAWI,MAAZ,CAAlD;AACD;AACF,KA9Q6B;;AAAA,sFAgRI,UAACP,CAAD,EAA+B;AAC/D;AACA,UACE,CAACA,CAAD,IACCA,CAAC,SAAD,IAAAA,CAAC,WAAD,IAAAA,CAAC,CAAEQ,YAAH,CAAgBP,QAAhB,CAAyB,WAAzB,KACC,CAAAD,CAAC,SAAD,IAAAA,CAAC,WAAD,YAAAA,CAAC,CAAES,MAAH,MAAc,MAAKC,SAAL,CAAe,MAAKP,KAAL,CAAWQ,kBAA1B,CAHlB,EAIE;AACA,gBAAQ,MAAKR,KAAL,CAAWS,eAAnB;AACE,eAAKlB,gBAAgB,CAACmB,IAAtB;AACE,kBAAKC,iBAAL;;AACA;;AACF,eAAKpB,gBAAgB,CAACqB,OAAtB;AACE,kBAAKC,kBAAL;;AALJ;AAOD;AACF,KA/R6B;;AAAA,8DAiTpB,UAAChB,CAAD,EAAyB;AACjC,UAAIP,iBAAiB,CAACO,CAAD,CAArB,EAA0B;AACxB;AACD;;AAED,wBAAqC,MAAKF,KAA1C;AAAA,UAAQmB,QAAR,eAAQA,QAAR;AAAA,UAAkBC,cAAlB,eAAkBA,cAAlB;;AAEA,UACED,QAAQ,KAAKrC,GAAb,IACA,EAACsC,cAAD,aAACA,cAAD,eAACA,cAAc,CAAEC,SAAjB,CADA,KAECnB,CAAC,CAACoB,MAAF,IAAY,EAAZ,IAAkBpB,CAAC,CAACoB,MAAF,IAAY,MAAKC,MAAL,CAAaC,UAAb,GAA0B,EAFzD,KAGA,CAAC,MAAKnB,KAAL,CAAWoB,YAJd,EAKE;AACA,cAAKC,QAAL,CAAc;AAAED,UAAAA,YAAY,EAAE;AAAhB,SAAd;AACD;;AAED,UACEN,QAAQ,KAAKrC,GAAb,IACAsC,cADA,aACAA,cADA,eACAA,cAAc,CAAEC,SADhB,IAEA,MAAKrB,KAAL,CAAW2B,WAHb,EAIE;AAAA;;AACA,YAAK,MAAKtB,KAAL,CAAWuB,QAAX,IAAuB1B,CAAC,CAACoB,MAAF,IAAY,EAApC,IAA2C,CAAC,MAAKC,MAArD,EAA6D;AAC3D;AACD;;AAED,YACErB,CAAC,CAACoB,MAAF,IAAY,EAAZ,IACA,CAAC,MAAKjB,KAAL,CAAWwB,WADZ,IAEA,iDAAC,MAAK7B,KAAL,CAAW8B,OAAZ,wDAAC,oBAAoBC,MAArB,yEAA+B,CAA/B,IAAoC,CAHtC,EAIE;AACA,cAAI,MAAK1B,KAAL,CAAW2B,WAAX,KAA2B,IAA/B,EAAqC;AAAA;;AACnC,kBAAKC,OAAL,CAAa,MAAK5B,KAAL,CAAW2B,WAAxB,0BACE,MAAKhC,KAAL,CAAWkC,MADb,uDACE,mBAAmBC,SAAnB,GAA+BC,CADjC;AAED;;AACD,gBAAKV,QAAL,CAAc;AACZG,YAAAA,WAAW,EAAE,IADD;AAEZQ,YAAAA,eAAe,EAAEnC,CAAC,CAACoB,MAFP;AAGZgB,YAAAA,kBAAkB,EAAE,MAAKjC,KAAL,CAAW2B,WAHnB;AAIZnB,YAAAA,kBAAkB,EAAE,MAAKb,KAAL,CAAW8B,OAAX,CAAoBS,KAApB,CAA0B,CAAC,CAA3B,EAA8B,CAA9B;AAJR,WAAd;AAMD;;AACD,YAAI,MAAKlC,KAAL,CAAWwB,WAAf,EAA4B;AAC1B,cAAIW,cAAc,GAAG,CAArB;;AACA,cAAItC,CAAC,CAACuC,MAAF,GAAW,CAAf,EAAkB;AAChBD,YAAAA,cAAc,GAAG,CAAjB;AACD,WAFD,MAEO,IACLtC,CAAC,CAACuC,MAAF,GACA,MAAKlB,MAAL,CAAYC,UAAZ,GAAyB,MAAKnB,KAAL,CAAWgC,eAF/B,EAGL;AAAA;;AACAG,YAAAA,cAAc,mBAAG,MAAKjB,MAAR,iDAAG,aAAaC,UAA9B;AACD,WALM,MAKA;AACLgB,YAAAA,cAAc,GAAGtC,CAAC,CAACuC,MAAnB;AACD;;AACD,gBAAKf,QAAL,CAAc;AAAEc,YAAAA,cAAc,EAAdA;AAAF,WAAd;AACD;AACF;AACF,KAzW6B;;AAAA,4DA2WtB,UAACtC,CAAD,EAAyB;AAC/B,UAAI,MAAKG,KAAL,CAAWwB,WAAX,IAA0B,MAAKN,MAAnC,EAA2C;AAAA;;AACzC,YAAMmB,KAAK,GAAI,MAAKrC,KAAL,CAAWmC,cAAX,GAA4BtC,CAAC,CAACyC,QAA/B,GAA2C,IAAzD;;AACA,YAAI,MAAKtC,KAAL,CAAWmC,cAAX,KAA8B,CAAlC,EAAqC;AACnC,gBAAKxB,iBAAL;AACD,SAFD,MAEO,IAAI,MAAKX,KAAL,CAAWmC,cAAX,+CAA8B,MAAKjB,MAAnC,kDAA8B,cAAaC,UAA3C,yEAAyD,CAAzD,CAAJ,EAAiE;AACtE,gBAAKN,kBAAL;AACD,SAFM,MAEA,IACLwB,KAAK,GAAG,GAAR,IACA,MAAKrC,KAAL,CAAWgC,eAAX,GAA6B,MAAKhC,KAAL,CAAWmC,cAAxC,GACE,MAAKjB,MAAL,CAAYC,UAAZ,GAAyB,CAHtB,EAIL;AACA,gBAAKE,QAAL,CAAc;AAAEZ,YAAAA,eAAe,EAAElB,gBAAgB,CAACqB;AAApC,WAAd;AACD,SANM,MAMA;AACL,gBAAKS,QAAL,CAAc;AAAEZ,YAAAA,eAAe,EAAElB,gBAAgB,CAACmB;AAApC,WAAd;AACD;AACF;AACF,KA5X6B;;AAG5B,UAAKV,KAAL,GAAa;AACXuB,MAAAA,QAAQ,EAAE,KADC;AAGXgB,MAAAA,aAAa,EAAE,CAAC5C,KAAK,CAACgC,WAAP,CAHJ;AAIXA,MAAAA,WAAW,EAAEhC,KAAK,CAACgC,WAJR;AAKXvB,MAAAA,MAAM,EAAER,SALG;AAMXK,MAAAA,SAAS,EAAE,IANA;AAOXuC,MAAAA,SAAS,EAAE,IAPA;AASXhB,MAAAA,WAAW,EAAE,KATF;AAUXQ,MAAAA,eAAe,EAAE,CAVN;AAWXG,MAAAA,cAAc,EAAE,CAXL;AAYX3B,MAAAA,kBAAkB,EAAE,IAZT;AAaXyB,MAAAA,kBAAkB,EAAE,IAbT;AAcXxB,MAAAA,eAAe,EAAE,IAdN;AAgBXW,MAAAA,YAAY,EAAE;AAhBH,KAAb;AAH4B;AAqB7B;;;;SAUD,eAAe;AACb,aAAO,KAAKzB,KAAL,CAAW8C,QAAlB;AACD;;;SAED,eAAa;AACX,aAAO,KAAK9C,KAAL,CAAWuB,MAAlB;AACD;;;SAED,eAAa;AACX,aAAO7C,KAAK,CAACqE,QAAN,CAAeC,OAAf,CAAuB,KAAKhD,KAAL,CAAWiD,QAAlC,CAAP;AACD;;;WAID,6BAAoB;AAClB,UAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,aAA7B,EAA4C;AAC1C,2BAA0B,KAAKpD,KAA/B;AAAA,YAAQqD,MAAR,gBAAQA,MAAR;AAAA,YAAgBC,KAAhB,gBAAgBA,KAAhB;AACAD,QAAAA,MAAM,IACJvD,IAAI,CACF,mGADE,CADN;AAIAwD,QAAAA,KAAK,IACHxD,IAAI,CACF,kGADE,CADN;AAID;AACF;;;WAED,gCAAuB;AACrB,UAAMyD,EAAE,GAAG9D,QAAQ,CAAC,KAAKO,KAAN,CAAnB;;AACA,UAAIuD,EAAJ,EAAQ;AACN1D,QAAAA,YAAY,CAAC0D,EAAD,CAAZ,GAAmB,KAAKtB,OAAxB;AACD;;AACD,UAAI,KAAKuB,sBAAT,EAAiC;AAC/BC,QAAAA,YAAY,CAAC,KAAKD,sBAAN,CAAZ;AACD;AACF;;;WAED,4BAAmBE,SAAnB,EAAyCC,SAAzC,EAA+D;AAAA;;AAC7D,WAAK3D,KAAL,CAAWqD,MAAX,IAAqB,CAACK,SAAS,CAACL,MAAhC,IAA0C,KAAKO,iBAAL,EAA1C;AACA,WAAK5D,KAAL,CAAWsD,KAAX,IAAoB,CAACI,SAAS,CAACJ,KAA/B,IAAwC,KAAKM,iBAAL,EAAxC,CAF6D,CAI7D;;AACA,UACEF,SAAS,CAAC1B,WAAV,KAA0B,KAAKhC,KAAL,CAAWgC,WAArC,IACA,CAAC2B,SAAS,CAAC9B,WADX,IAEA,CAAC8B,SAAS,CAAClC,YAHb,EAIE;AAAA;;AACA,YAAMoC,YAAY,GAAG,KAAKC,MAAL,CAClBC,GADkB,CACd,UAACC,KAAD;AAAA,iBAAWvE,QAAQ,CAACuE,KAAK,CAAChE,KAAP,EAAcF,IAAd,CAAnB;AAAA,SADc,EAElBmE,IAFkB,CAGjB,UAACV,EAAD;AAAA,iBAAQA,EAAE,KAAKG,SAAS,CAAC1B,WAAjB,IAAgCuB,EAAE,KAAK,MAAI,CAACvD,KAAL,CAAWgC,WAA1D;AAAA,SAHiB,CAArB;AAMA,YAAMvB,MAAM,GAAGoD,YAAY,KAAK,KAAK7D,KAAL,CAAWgC,WAA3C;AACA,aAAKC,OAAL,CAAayB,SAAS,CAAC1B,WAAvB,2BAAsC,KAAKhC,KAAL,CAAWkC,MAAjD,wDAAsC,oBAAmBC,SAAnB,GAA+BC,CAArE;;AAEA,YAAI,KAAK8B,6BAAL,EAAJ,EAA0C;AACxC,eAAK3D,eAAL,CAAqBmD,SAAS,CAAC1B,WAA/B,EAA4CvB,MAA5C;AACD,SAFD,MAEO;AACL,eAAKmD,iBAAL;AAEA,eAAKlC,QAAL,CAAc;AACZkB,YAAAA,aAAa,EAAE,CAACc,SAAS,CAAC1B,WAAX,EAAwB,KAAKhC,KAAL,CAAWgC,WAAnC,CADH;AAEZ1B,YAAAA,SAAS,EAAEoD,SAAS,CAAC1B,WAFT;AAGZa,YAAAA,SAAS,EAAE,KAAK7C,KAAL,CAAWgC,WAHV;AAIZA,YAAAA,WAAW,EAAE,IAJD;AAKZJ,YAAAA,QAAQ,EAAE,IALE;AAMZnB,YAAAA,MAAM,EAANA;AANY,WAAd,EAHK,CAYL;;AACA,cAAI,CAAC5B,cAAc,CAACsF,SAApB,EAA+B;AAC7B,gBAAI,KAAKX,sBAAT,EAAiC;AAC/BC,cAAAA,YAAY,CAAC,KAAKD,sBAAN,CAAZ;AACD;;AACD,iBAAKA,sBAAL,GAA8BY,UAAU,CACtC,KAAKC,oBADiC,EAEtC,KAAKrE,KAAL,CAAWmB,QAAX,KAAwBrC,GAAxB,GAA8B,GAA9B,GAAoC,GAFE,CAAxC;AAID;AACF;AACF,OA5C4D,CA8C7D;;;AACA,UACE4E,SAAS,CAAC1B,WAAV,KAA0B,KAAKhC,KAAL,CAAWgC,WAArC,IACA2B,SAAS,CAAC9B,WAFZ,EAGE;AACA,YAAMgB,SAAS,GAAG,KAAK7C,KAAL,CAAWgC,WAA7B;AACA,YAAM1B,SAAS,GAAGoD,SAAS,CAAC1B,WAA5B;;AACA,YAAI2B,SAAS,CAACrB,kBAAV,KAAiC,IAArC,EAA2C;AACzC,eAAKL,OAAL,CAAa0B,SAAS,CAACrB,kBAAvB,IAA6C,CAA7C;AACD;;AACD,aAAKZ,QAAL,CACE;AACEY,UAAAA,kBAAkB,EAAE,IADtB;AAEEzB,UAAAA,kBAAkB,EAAE,IAFtB;AAGEgB,UAAAA,WAAW,EAAE,KAHf;AAIEf,UAAAA,eAAe,EAAE,IAJnB;AAKEuB,UAAAA,eAAe,EAAE,CALnB;AAMEG,UAAAA,cAAc,EAAE,CANlB;AAOER,UAAAA,WAAW,EAAEa,SAPf;AAQED,UAAAA,aAAa,EAAE,CAACC,SAAD;AARjB,SADF,EAWE,YAAM;AACJ,cAAI,MAAI,CAACxC,KAAL,CAAW2B,WAAX,KAA2B,IAA/B,EAAqC;AAAA;;AACnC,mCAAA,MAAI,CAAChC,KAAL,CAAWkC,MAAX,4EAAmBoC,QAAnB,CACE,CADF,EAEE,MAAI,CAACrC,OAAL,CAAa,MAAI,CAAC5B,KAAL,CAAW2B,WAAxB,CAFF;AAID;;AACD0B,UAAAA,SAAS,CAACa,YAAV,IACEb,SAAS,CAACa,YAAV,CAAuB;AACrB9D,YAAAA,MAAM,EAAE,IADa;AAErB+D,YAAAA,IAAI,EAAElE,SAFe;AAGrBmE,YAAAA,EAAE,EAAE5B;AAHiB,WAAvB,CADF;AAMD,SAxBH;AA0BD,OAlF4D,CAoF7D;;;AACA,UAAI,CAACc,SAAS,CAAC9B,WAAX,IAA0B,KAAKxB,KAAL,CAAWwB,WAAzC,EAAsD;AACpD,aAAK7B,KAAL,CAAW0E,gBAAX,IAA+B,KAAK1E,KAAL,CAAW0E,gBAAX,EAA/B;AACD,OAvF4D,CAyF7D;;;AACA,UAAI,CAACf,SAAS,CAAC7C,eAAX,IAA8B,KAAKT,KAAL,CAAWS,eAA7C,EAA8D;AAC5D,aAAK6D,oBAAL,CACE,KAAK/D,SAAL,CAAe,KAAKP,KAAL,CAAWQ,kBAA1B,CADF,EAEE,KAAK+D,+BAFP;AAID,OA/F4D,CAiG7D;;;AACA,UACEjB,SAAS,CAAC7C,eAAV,KAA8BlB,gBAAgB,CAACmB,IAA/C,IACA,CAAC,KAAKV,KAAL,CAAWS,eADZ,IAEA,KAAKT,KAAL,CAAW2B,WAAX,KAA2B,IAH7B,EAIE;AAAA;;AACA,oCAAKhC,KAAL,CAAWkC,MAAX,4EAAmBoC,QAAnB,CAA4B,CAA5B,EAA+B,KAAKrC,OAAL,CAAa,KAAK5B,KAAL,CAAW2B,WAAxB,CAA/B;AACD,OAxG4D,CA0G7D;;;AACA,UACE0B,SAAS,CAAC1B,WAAV,KAA0B,KAAKhC,KAAL,CAAWgC,WAArC,IACA,KAAK3B,KAAL,CAAWoB,YAFb,EAGE;AACA,aAAKC,QAAL,CAAc;AACZD,UAAAA,YAAY,EAAE,KADF;AAEZoB,UAAAA,SAAS,EAAE,IAFC;AAGZvC,UAAAA,SAAS,EAAE,IAHC;AAIZsB,UAAAA,QAAQ,EAAE,KAJE;AAKZgB,UAAAA,aAAa,EAAE,CAAC,KAAK5C,KAAL,CAAWgC,WAAZ,CALH;AAMZA,UAAAA,WAAW,EAAE,KAAKhC,KAAL,CAAWgC;AANZ,SAAd;AAQD;AACF;;;WAED,yCAAyC;AAAA;;AACvC,aACE,+BAAKhC,KAAL,CAAWoB,cAAX,gFAA2ByD,uBAA3B,MAAuD,KAAvD,IACA,0BAAC,KAAK7E,KAAL,CAAW8E,QAAZ,iDAAC,qBAAqBC,OAAtB,CAFF;AAID;;;WAED,8BACEC,IADF,EAEEC,YAFF,EAGQ;AACN,UAAIrG,eAAe,CAACuF,SAAhB,IAA6BvF,eAAe,CAACsG,IAA7C,IAAqDF,IAAzD,EAA+D;AAC7DA,QAAAA,IAAI,CAACG,mBAAL,CACEvG,eAAe,CAACsG,IADlB,EAEED,YAFF;AAIAD,QAAAA,IAAI,CAACI,gBAAL,CACExG,eAAe,CAACsG,IADlB,EAEED,YAFF;AAID,OATD,MASO;AACL,YAAI,KAAKI,uBAAT,EAAkC;AAChC5B,UAAAA,YAAY,CAAC,KAAK4B,uBAAN,CAAZ;AACD;;AACD,aAAKA,uBAAL,GAA+BjB,UAAU,CACvCa,YADuC,EAEvC,KAAKjF,KAAL,CAAWmB,QAAX,KAAwBrC,GAAxB,GAA8B,GAA9B,GAAoC,GAFG,CAAzC;AAID;AACF;;;WAED,6BAA0B;AAAA;;AACxB,UAAI,OAAO,KAAKyC,MAAZ,KAAuB,WAAvB,sBAAsC,KAAKuB,QAA3C,2CAAsC,eAAewC,aAAzD,EAAwE;AACrE,aAAKxC,QAAL,CAAcwC,aAAf,CAA6CC,IAA7C;AACD;AACF;;;WAED,mBAAUhC,EAAV,EAA6B;AAC3B,UAAIA,EAAE,KAAK,IAAX,EAAiB;AACf,eAAOtD,SAAP;AACD;;AACD,aAAO,KAAKuF,UAAL,CAAgBjC,EAAhB,CAAP;AACD;;;WAED,yBAAgBjD,SAAhB,EAAmCG,MAAnC,EAAoD;AAAA;;AAClD,UAAMuB,WAAW,GAAG,KAAKhC,KAAL,CAAWgC,WAA/B;;AACA,UAAIvB,MAAJ,EAAY;AACV,aAAKwB,OAAL,CAAa3B,SAAb,IAA0B,CAA1B;AACD;;AACD,WAAKoB,QAAL,CACE;AACEpB,QAAAA,SAAS,EAAE,IADb;AAEEuC,QAAAA,SAAS,EAAE,IAFb;AAGED,QAAAA,aAAa,EAAE,CAACZ,WAAD,CAHjB;AAIEA,QAAAA,WAAW,EAAXA,WAJF;AAKEJ,QAAAA,QAAQ,EAAE,KALZ;AAMEnB,QAAAA,MAAM,EAAER;AANV,OADF,EASE,YAAM;AAAA;;AACJ,+BAAA,MAAI,CAACD,KAAL,CAAWkC,MAAX,4EAAmBoC,QAAnB,CAA4B,CAA5B,EAA+B7D,MAAM,GAAG,MAAI,CAACwB,OAAL,CAAaD,WAAb,CAAH,GAA+B,CAApE;AACA,QAAA,MAAI,CAAChC,KAAL,CAAWuE,YAAX,IACE,MAAI,CAACvE,KAAL,CAAWuE,YAAX,CAAwB;AAAE9D,UAAAA,MAAM,EAANA,MAAF;AAAU+D,UAAAA,IAAI,EAAElE,SAAhB;AAA2BmE,UAAAA,EAAE,EAAEzC;AAA/B,SAAxB,CADF;AAED,OAbH;AAeD;;;WAkCD,8BAA2B;AACzB,WAAKhC,KAAL,CAAW2B,WAAX,IAA0B,KAAK3B,KAAL,CAAW2B,WAAX,EAA1B;AACD;;;WAED,6BAA0B;AACxB,WAAK3B,KAAL,CAAWgB,iBAAX,IAAgC,KAAKhB,KAAL,CAAWgB,iBAAX,EAAhC;AACA,WAAKU,QAAL,CAAc;AACZY,QAAAA,kBAAkB,EAAE,IADR;AAEZzB,QAAAA,kBAAkB,EAAE,IAFR;AAGZgB,QAAAA,WAAW,EAAE,KAHD;AAIZf,QAAAA,eAAe,EAAE,IAJL;AAKZuB,QAAAA,eAAe,EAAE,CALL;AAMZG,QAAAA,cAAc,EAAE;AANJ,OAAd;AAQD;;;WA+ED,8BAAqBiD,OAArB,EAAuE;AACrE,UAAI,CAACpG,SAAD,IAAc,CAAC,KAAKkC,MAAxB,EAAgC;AAC9B,eAAO,EAAP;AACD;;AAED,UAAMmE,MAAM,GAAGD,OAAO,KAAK,KAAKpF,KAAL,CAAWiC,kBAAtC;AACA,UAAMqD,MAAM,GAAGF,OAAO,KAAK,KAAKpF,KAAL,CAAWQ,kBAAtC;;AAEA,UAAK,CAAC6E,MAAD,IAAW,CAACC,MAAb,IAAwB,KAAKtF,KAAL,CAAWS,eAAvC,EAAwD;AACtD,eAAO,EAAP;AACD;;AAED,UAAI8E,kBAAkB,aAAM,KAAKvF,KAAL,CAAWmC,cAAjB,OAAtB;AACA,UAAIqD,kBAAkB,aACpB,CAAC,EAAD,GAAO,KAAKxF,KAAL,CAAWmC,cAAX,GAA4B,GAA7B,GAAoC,KAAKjB,MAAL,CAAYC,UAAhD,GAA6D,CAD/C,MAAtB;AAGA,UAAIsE,eAAe,GAChB,OAAO,KAAKvE,MAAL,CAAYC,UAAZ,GAAyB,KAAKnB,KAAL,CAAWmC,cAA3C,CAAD,GACA,KAAKjB,MAAL,CAAYC,UAFd;;AAIA,UAAI,KAAKnB,KAAL,CAAWS,eAAf,EAAgC;AAC9B,eAAO4E,MAAM,GACT;AAAEK,UAAAA,SAAS,sCAA+BD,eAA/B;AAAX,SADS,GAET,EAFJ;AAGD;;AAED,UAAIH,MAAJ,EAAY;AACV,eAAO;AACLK,UAAAA,SAAS,wBAAiBH,kBAAjB,YADJ;AAELI,UAAAA,eAAe,wBAAiBJ,kBAAjB;AAFV,SAAP;AAID;;AACD,UAAIH,MAAJ,EAAY;AACV,eAAO;AACLM,UAAAA,SAAS,wBAAiBJ,kBAAjB,YADJ;AAELK,UAAAA,eAAe,wBAAiBL,kBAAjB,YAFV;AAGLG,UAAAA,SAAS,sCAA+BD,eAA/B;AAHJ,SAAP;AAKD;;AAED,aAAO,EAAP;AACD;;;WAED,kBAAS;AAAA;;AACP,yBAiBI,KAAK9F,KAjBT;AAAA,UACEqD,MADF,gBACEA,MADF;AAAA,UAEEC,KAFF,gBAEEA,KAFF;AAAA,UAGEnC,QAHF,gBAGEA,QAHF;AAAA,UAIe+E,EAJf,gBAIElE,WAJF;AAAA,UAKE8C,QALF,gBAKEA,QALF;AAAA,UAME1D,cANF,gBAMEA,cANF;AAAA,UAOEU,OAPF,gBAOEA,OAPF;AAAA,UAQEqE,GARF,gBAQEA,GARF;AAAA,UASE5B,YATF,gBASEA,YATF;AAAA,UAUE5C,WAVF,gBAUEA,WAVF;AAAA,UAWE+C,gBAXF,gBAWEA,gBAXF;AAAA,UAYE1D,iBAZF,gBAYEA,iBAZF;AAAA,UAaEO,MAbF,gBAaEA,MAbF;AAAA,UAcEuB,QAdF,gBAcEA,QAdF;AAAA,UAeEZ,MAfF,gBAeEA,MAfF;AAAA,UAgBKkE,SAhBL;;AAkBA,wBASI,KAAK/F,KATT;AAAA,UACEC,SADF,eACEA,SADF;AAAA,UAEEuC,SAFF,eAEEA,SAFF;AAAA,UAGEb,WAHF,eAGEA,WAHF;AAAA,UAIEM,kBAJF,eAIEA,kBAJF;AAAA,UAKEzB,kBALF,eAKEA,kBALF;AAAA,UAMEC,eANF,eAMEA,eANF;AAAA,UAOEL,MAPF,eAOEA,MAPF;AAAA,UAQEmB,QARF,eAQEA,QARF;AAWA,UAAMyE,SAAS,GAAG,CAAC,CAAChD,MAApB;AACA,UAAMiD,QAAQ,GAAG,CAAC,CAAChD,KAAnB;AAEA,UAAMQ,MAAM,GAAG,KAAKA,MAAL,CAAYyC,MAAZ,CAAmB,UAACvC,KAAD,EAA+B;AAC/D,YAAMyB,OAAO,GAAGhG,QAAQ,CAACuE,KAAK,CAAChE,KAAP,EAAcF,IAAd,CAAxB;AAEA,eACG2F,OAAO,KAAKxF,SAAZ,IAAyB,MAAI,CAACI,KAAL,CAAWuC,aAAX,CAAyBzC,QAAzB,CAAkCsF,OAAlC,CAA1B,IACAA,OAAO,KAAKnD,kBADZ,IAEAmD,OAAO,KAAK5E,kBAHd;AAKD,OARc,CAAf;AAUA,UAAM2F,gBAAgB,GAAG,KAAKtC,6BAAL,EAAzB;AAEA,aACE,oBAAC,KAAD;AACE,QAAA,SAAS,EAAC;AADZ,SAEMkC,SAFN;AAGE,QAAA,SAAS,EAAEzH,UAAU,CACnB,MADmB,EAEnBwC,QAAQ,KAAKrC,GAAb,IAAoB,WAFD,EAGnB,CAAC0H,gBAAD,IAAqB5E,QAArB,IAAiC,gBAHd,EAInB,CAAC4E,gBAAD,IAAqB,KAAKnG,KAAL,CAAWwB,WAAhC,IAA+C,oBAJ5B,EAKnB2E,gBAAgB,IAAI,iBALD,CAHvB;AAUE,QAAA,OAAO,EAAE,KAAKC,OAVhB;AAWE,QAAA,KAAK,EAAE,KAAKC;AAXd,UAaE;AAAK,QAAA,SAAS,EAAC;AAAf,SACG5C,MAAM,CAACC,GAAP,CAAW,UAACC,KAAD,EAA+B;AAAA;;AACzC,YAAMyB,OAAO,GAAGhG,QAAQ,CAACuE,KAAK,CAAChE,KAAP,EAAcF,IAAd,CAAxB;AACA,YAAM4F,MAAM,GACVD,OAAO,KAAKnF,SAAZ,IAAyBmF,OAAO,KAAKnD,kBADvC;AAEA,YAAMqE,kBAAkB,GACtB/E,QAAQ,IAAI6D,OAAO,MAAMhF,MAAM,GAAGH,SAAH,GAAeuC,SAA3B,CADrB;AAEA,YAAM+D,gBAAgB,GACpBlB,MAAM,IACND,OAAO,KAAK5E,kBADZ,IAEC4E,OAAO,KAAK5C,SAAZ,IAAyBpC,MAH5B;AAKA,eACE;AACE,UAAA,SAAS,EAAE9B,UAAU,CACnB,aADmB,EAEnB8G,OAAO,KAAKzD,WAAZ,IAA2B,qBAFR,EAGnByD,OAAO,KAAKnF,SAAZ,IAAyB,mBAHN,EAInBmF,OAAO,KAAK5C,SAAZ,IAAyB,mBAJN,EAKnB4C,OAAO,KAAKnD,kBAAZ,IACE,8BANiB,EAOnBmD,OAAO,KAAK5E,kBAAZ,IACE,8BARiB,EASnBC,eAAe,KAAKlB,gBAAgB,CAACqB,OAArC,IACE,iCAViB,EAWnBH,eAAe,KAAKlB,gBAAgB,CAACmB,IAArC,IACE,gCAZiB,CADvB;AAeE,UAAA,cAAc,EACZ4F,kBAAkB,GAAG,MAAI,CAACtC,oBAAR,GAA+BpE,SAhBrD;AAkBE,UAAA,GAAG,EAAE,aAAC4G,EAAD;AAAA,mBACHpB,OAAO,KAAKxF,SAAZ,KAA0B,MAAI,CAACuF,UAAL,CAAgBC,OAAhB,IAA2BoB,EAArD,CADG;AAAA,WAlBP;AAqBE,UAAA,KAAK,EAAE,MAAI,CAACC,oBAAL,CAA0BrB,OAA1B,CArBT;AAsBE,UAAA,GAAG,EAAEA;AAtBP,WAwBE;AACE,UAAA,SAAS,EAAC,gBADZ;AAEE,UAAA,KAAK,EAAE;AACLsB,YAAAA,SAAS,EAAEH,gBAAgB,GACvB,oBAAE,MAAI,CAAC3E,OAAL,CAAawD,OAAb,CAAF,2DAAqC,CAArC,CADuB,GAEvBxF;AAHC;AAFT,WAQE,oBAAC,qBAAD;AACE,UAAA,QAAQ,EACNwF,OAAO,KAAK5C,SAAZ,IAAyB4C,OAAO,KAAK5E;AAFzC,WAKGmD,KALH,CARF,CAxBF,CADF;AA2CD,OAtDA,CADH,CAbF,EAsEE,oBAAC,aAAD,QACGqC,SAAS,IAAI;AAAK,QAAA,SAAS,EAAC;AAAf,SAA+BhD,MAA/B,CADhB,EAEGiD,QAAQ,IAAI;AAAK,QAAA,SAAS,EAAC;AAAf,SAA8BhD,KAA9B,CAFf,CAtEF,CADF;AA6ED;;;;EApiByB5E,KAAK,CAACsI,S;AAuiBlC;AACA;AACA;;;gBAziBMjH,a,kBAwBsC;AACxC+B,EAAAA,OAAO,EAAE;AAD+B,C;;AAkhB5C,OAAO,IAAMmF,IAAI,GAAGhI,WAAW,CAC7BA,WAAW,CACTA,WAAW,CACTD,YAAY,CAACM,OAAO,CAAYS,aAAZ,CAAR,CADH,EAETZ,eAFS,EAGT,UAHS,CADF,EAMTD,qBANS,EAOT,gBAPS,CADkB,EAU7BK,aAV6B,EAW7B,QAX6B,CAAxB;AAcP0H,IAAI,CAACC,WAAL,GAAmB,MAAnB","sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { transitionEvent, animationEvent } from \"../../lib/supportEvents\";\nimport { IOS } from \"../../lib/platform\";\nimport { Touch, TouchEvent } from \"../Touch/Touch\";\nimport { HasPlatform } from \"../../types\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport { withContext } from \"../../hoc/withContext\";\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n} from \"../ConfigProvider/ConfigProviderContext\";\nimport { SplitColContext, SplitColContextProps } from \"../SplitCol/SplitCol\";\nimport { AppRootPortal } from \"../AppRoot/AppRootPortal\";\nimport { canUseDOM, withDOM, DOMProps } from \"../../lib/dom\";\nimport {\n  ScrollContext,\n  ScrollContextInterface,\n} from \"../AppRoot/ScrollContext\";\nimport { NavTransitionProvider } from \"../NavTransitionContext/NavTransitionContext\";\nimport { getNavId, NavIdProps } from \"../../lib/getNavId\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { swipeBackExcluded } from \"./utils\";\nimport \"./View.css\";\n\nenum SwipeBackResults {\n  fail = 1,\n  success,\n}\n\ninterface Scrolls {\n  [index: string]: number | undefined;\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\ntype TransitionEventHandler = (e?: TransitionEvent) => void;\n\nexport let scrollsCache: ViewsScrolls = {};\n\nexport interface ViewProps\n  extends React.HTMLAttributes<HTMLElement>,\n    HasPlatform,\n    NavIdProps {\n  activePanel: string;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `Alert`, `ActionSheet` и `ScreenSpinner`.\n   */\n  popout?: React.ReactNode;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `ModalRoot`.\n   */\n  modal?: React.ReactNode;\n  onTransition?(params: { isBack: boolean; from: string; to: string }): void;\n  /**\n   * callback свайпа назад\n   */\n  onSwipeBack?(): void;\n  /**\n   * callback начала анимации свайпа назад.\n   */\n  onSwipeBackStart?(): void;\n  /**\n   * callback завершения анимации отмененного пользователем свайпа\n   */\n  onSwipeBackCancel?(): void;\n  history?: string[];\n  /**\n   * @ignore\n   */\n  splitCol?: SplitColContextProps;\n  /**\n   * @ignore\n   */\n  configProvider?: ConfigProviderContextInterface;\n  /**\n   * @ignore\n   */\n  scroll?: ScrollContextInterface;\n}\n\nexport interface ViewState {\n  animated: boolean;\n\n  visiblePanels: string[];\n  activePanel: string | null;\n  isBack: boolean | undefined;\n  prevPanel: string | null;\n  nextPanel: string | null;\n\n  swipingBack: boolean;\n  swipeBackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string | null;\n  swipeBackPrevPanel: string | null;\n  swipeBackResult: SwipeBackResults | null;\n\n  browserSwipe: boolean;\n}\n\nconst warn = warnOnce(\"View\");\n\nclass ViewComponent extends React.Component<ViewProps & DOMProps, ViewState> {\n  constructor(props: ViewProps) {\n    super(props);\n\n    this.state = {\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false,\n    };\n  }\n\n  static defaultProps: Partial<ViewProps> = {\n    history: [],\n  };\n\n  private readonly scrolls = scrollsCache[getNavId(this.props) as string] || {};\n  private transitionFinishTimeout: number | undefined = undefined;\n  private animationFinishTimeout: number | undefined = undefined;\n\n  get document() {\n    return this.props.document;\n  }\n\n  get window() {\n    return this.props.window;\n  }\n\n  get panels() {\n    return React.Children.toArray(this.props.children) as React.ReactElement[];\n  }\n\n  panelNodes: { [id: string]: HTMLDivElement | null } = {};\n\n  componentDidMount() {\n    if (process.env.NODE_ENV === \"development\") {\n      const { popout, modal } = this.props;\n      popout &&\n        warn(\n          \"Свойство popout устарело и будет удалено в 5.0.0. Используйте одноименное свойство у SplitLayout.\"\n        );\n      modal &&\n        warn(\n          \"Свойство modal устарело и будет удалено в 5.0.0. Используйте одноименное свойство у SplitLayout.\"\n        );\n    }\n  }\n\n  componentWillUnmount() {\n    const id = getNavId(this.props);\n    if (id) {\n      scrollsCache[id] = this.scrolls;\n    }\n    if (this.animationFinishTimeout) {\n      clearTimeout(this.animationFinishTimeout);\n    }\n  }\n\n  componentDidUpdate(prevProps: ViewProps, prevState: ViewState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      !prevState.swipingBack &&\n      !prevState.browserSwipe\n    ) {\n      const firstLayerId = this.panels\n        .map((panel) => getNavId(panel.props, warn))\n        .find(\n          (id) => id === prevProps.activePanel || id === this.props.activePanel\n        );\n\n      const isBack = firstLayerId === this.props.activePanel;\n      this.scrolls[prevProps.activePanel] = this.props.scroll?.getScroll().y;\n\n      if (this.shouldDisableTransitionMotion()) {\n        this.flushTransition(prevProps.activePanel, isBack);\n      } else {\n        this.blurActiveElement();\n\n        this.setState({\n          visiblePanels: [prevProps.activePanel, this.props.activePanel],\n          prevPanel: prevProps.activePanel,\n          nextPanel: this.props.activePanel,\n          activePanel: null,\n          animated: true,\n          isBack,\n        });\n\n        // Фолбек анимации перехода\n        if (!animationEvent.supported) {\n          if (this.animationFinishTimeout) {\n            clearTimeout(this.animationFinishTimeout);\n          }\n          this.animationFinishTimeout = setTimeout(\n            this.transitionEndHandler,\n            this.props.platform === IOS ? 600 : 300\n          );\n        }\n      }\n    }\n\n    // Закончилась анимация свайпа назад\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      prevState.swipingBack\n    ) {\n      const nextPanel = this.props.activePanel;\n      const prevPanel = prevProps.activePanel;\n      if (prevState.swipeBackPrevPanel !== null) {\n        this.scrolls[prevState.swipeBackPrevPanel] = 0;\n      }\n      this.setState(\n        {\n          swipeBackPrevPanel: null,\n          swipeBackNextPanel: null,\n          swipingBack: false,\n          swipeBackResult: null,\n          swipeBackStartX: 0,\n          swipeBackShift: 0,\n          activePanel: nextPanel,\n          visiblePanels: [nextPanel],\n        },\n        () => {\n          if (this.state.activePanel !== null) {\n            this.props.scroll?.scrollTo(\n              0,\n              this.scrolls[this.state.activePanel]\n            );\n          }\n          prevProps.onTransition &&\n            prevProps.onTransition({\n              isBack: true,\n              from: prevPanel,\n              to: nextPanel,\n            });\n        }\n      );\n    }\n\n    // Начался свайп назад\n    if (!prevState.swipingBack && this.state.swipingBack) {\n      this.props.onSwipeBackStart && this.props.onSwipeBackStart();\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(\n        this.pickPanel(this.state.swipeBackNextPanel),\n        this.swipingBackTransitionEndHandler\n      );\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (\n      prevState.swipeBackResult === SwipeBackResults.fail &&\n      !this.state.swipeBackResult &&\n      this.state.activePanel !== null\n    ) {\n      this.props.scroll?.scrollTo(0, this.scrolls[this.state.activePanel]);\n    }\n\n    // Закончился Safari свайп\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      this.state.browserSwipe\n    ) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel,\n      });\n    }\n  }\n\n  shouldDisableTransitionMotion(): boolean {\n    return (\n      this.props.configProvider?.transitionMotionEnabled === false ||\n      !this.props.splitCol?.animate\n    );\n  }\n\n  waitTransitionFinish(\n    elem: HTMLElement | null | undefined,\n    eventHandler: TransitionEventHandler\n  ): void {\n    if (transitionEvent.supported && transitionEvent.name && elem) {\n      elem.removeEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener\n      );\n      elem.addEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener\n      );\n    } else {\n      if (this.transitionFinishTimeout) {\n        clearTimeout(this.transitionFinishTimeout);\n      }\n      this.transitionFinishTimeout = setTimeout(\n        eventHandler,\n        this.props.platform === IOS ? 600 : 300\n      );\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== \"undefined\" && this.document?.activeElement) {\n      (this.document.activeElement as HTMLElement).blur();\n    }\n  }\n\n  pickPanel(id: string | null) {\n    if (id === null) {\n      return undefined;\n    }\n    return this.panelNodes[id];\n  }\n\n  flushTransition(prevPanel: string, isBack: boolean) {\n    const activePanel = this.props.activePanel;\n    if (isBack) {\n      this.scrolls[prevPanel] = 0;\n    }\n    this.setState(\n      {\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel,\n        animated: false,\n        isBack: undefined,\n      },\n      () => {\n        this.props.scroll?.scrollTo(0, isBack ? this.scrolls[activePanel] : 0);\n        this.props.onTransition &&\n          this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      }\n    );\n  }\n\n  transitionEndHandler = (e?: React.AnimationEvent): void => {\n    if (\n      (!e ||\n        [\n          \"vkui-animation-ios-next-forward\",\n          \"vkui-animation-ios-prev-back\",\n          \"vkui-animation-view-next-forward\",\n          \"vkui-animation-view-prev-back\",\n        ].includes(e.animationName)) &&\n      this.state.prevPanel !== null\n    ) {\n      this.flushTransition(this.state.prevPanel, Boolean(this.state.isBack));\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    if (\n      !e ||\n      (e?.propertyName.includes(\"transform\") &&\n        e?.target === this.pickPanel(this.state.swipeBackNextPanel))\n    ) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.props.onSwipeBackCancel && this.props.onSwipeBackCancel();\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n    });\n  }\n\n  onMoveX = (e: TouchEvent): void => {\n    if (swipeBackExcluded(e)) {\n      return;\n    }\n\n    const { platform, configProvider } = this.props;\n\n    if (\n      platform === IOS &&\n      !configProvider?.isWebView &&\n      (e.startX <= 70 || e.startX >= this.window!.innerWidth - 70) &&\n      !this.state.browserSwipe\n    ) {\n      this.setState({ browserSwipe: true });\n    }\n\n    if (\n      platform === IOS &&\n      configProvider?.isWebView &&\n      this.props.onSwipeBack\n    ) {\n      if ((this.state.animated && e.startX <= 70) || !this.window) {\n        return;\n      }\n\n      if (\n        e.startX <= 70 &&\n        !this.state.swipingBack &&\n        (this.props.history?.length ?? 0) > 1\n      ) {\n        if (this.state.activePanel !== null) {\n          this.scrolls[this.state.activePanel] =\n            this.props.scroll?.getScroll().y;\n        }\n        this.setState({\n          swipingBack: true,\n          swipeBackStartX: e.startX,\n          swipeBackPrevPanel: this.state.activePanel,\n          swipeBackNextPanel: this.props.history!.slice(-2)[0],\n        });\n      }\n      if (this.state.swipingBack) {\n        let swipeBackShift = 0;\n        if (e.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (\n          e.shiftX >\n          this.window.innerWidth - this.state.swipeBackStartX\n        ) {\n          swipeBackShift = this.window?.innerWidth;\n        } else {\n          swipeBackShift = e.shiftX;\n        }\n        this.setState({ swipeBackShift });\n      }\n    }\n  };\n\n  onEnd = (e: TouchEvent): void => {\n    if (this.state.swipingBack && this.window) {\n      const speed = (this.state.swipeBackShift / e.duration) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= (this.window?.innerWidth ?? 0)) {\n        this.onSwipeBackSuccess();\n      } else if (\n        speed > 250 ||\n        this.state.swipeBackStartX + this.state.swipeBackShift >\n          this.window.innerWidth / 2\n      ) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string | undefined): React.CSSProperties {\n    if (!canUseDOM || !this.window) {\n      return {};\n    }\n\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if ((!isPrev && !isNext) || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${\n      -50 + (this.state.swipeBackShift * 100) / this.window.innerWidth / 2\n    }%`;\n    let prevPanelShadow =\n      (0.3 * (this.window.innerWidth - this.state.swipeBackShift)) /\n      this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev\n        ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` }\n        : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const {\n      popout,\n      modal,\n      platform,\n      activePanel: _1,\n      splitCol,\n      configProvider,\n      history,\n      nav,\n      onTransition,\n      onSwipeBack,\n      onSwipeBackStart,\n      onSwipeBackCancel,\n      window,\n      document,\n      scroll,\n      ...restProps\n    } = this.props;\n    const {\n      prevPanel,\n      nextPanel,\n      activePanel,\n      swipeBackPrevPanel,\n      swipeBackNextPanel,\n      swipeBackResult,\n      isBack,\n      animated,\n    } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels.filter((panel: React.ReactElement) => {\n      const panelId = getNavId(panel.props, warn);\n\n      return (\n        (panelId !== undefined && this.state.visiblePanels.includes(panelId)) ||\n        panelId === swipeBackPrevPanel ||\n        panelId === swipeBackNextPanel\n      );\n    });\n\n    const disableAnimation = this.shouldDisableTransitionMotion();\n\n    return (\n      <Touch\n        Component=\"section\"\n        {...restProps}\n        vkuiClass={classNames(\n          \"View\",\n          platform === IOS && \"View--ios\",\n          !disableAnimation && animated && \"View--animated\",\n          !disableAnimation && this.state.swipingBack && \"View--swiping-back\",\n          disableAnimation && \"View--no-motion\"\n        )}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        <div vkuiClass=\"View__panels\">\n          {panels.map((panel: React.ReactElement) => {\n            const panelId = getNavId(panel.props, warn);\n            const isPrev =\n              panelId === prevPanel || panelId === swipeBackPrevPanel;\n            const isTransitionTarget =\n              animated && panelId === (isBack ? prevPanel : nextPanel);\n            const compensateScroll =\n              isPrev ||\n              panelId === swipeBackNextPanel ||\n              (panelId === nextPanel && isBack);\n\n            return (\n              <div\n                vkuiClass={classNames(\n                  \"View__panel\",\n                  panelId === activePanel && \"View__panel--active\",\n                  panelId === prevPanel && \"View__panel--prev\",\n                  panelId === nextPanel && \"View__panel--next\",\n                  panelId === swipeBackPrevPanel &&\n                    \"View__panel--swipe-back-prev\",\n                  panelId === swipeBackNextPanel &&\n                    \"View__panel--swipe-back-next\",\n                  swipeBackResult === SwipeBackResults.success &&\n                    \"View__panel--swipe-back-success\",\n                  swipeBackResult === SwipeBackResults.fail &&\n                    \"View__panel--swipe-back-failed\"\n                )}\n                onAnimationEnd={\n                  isTransitionTarget ? this.transitionEndHandler : undefined\n                }\n                ref={(el) =>\n                  panelId !== undefined && (this.panelNodes[panelId] = el)\n                }\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div\n                  vkuiClass=\"View__panel-in\"\n                  style={{\n                    marginTop: compensateScroll\n                      ? -(this.scrolls[panelId as string] ?? 0)\n                      : undefined,\n                  }}\n                >\n                  <NavTransitionProvider\n                    entering={\n                      panelId === nextPanel || panelId === swipeBackNextPanel\n                    }\n                  >\n                    {panel}\n                  </NavTransitionProvider>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        <AppRootPortal>\n          {hasPopout && <div vkuiClass=\"View__popout\">{popout}</div>}\n          {hasModal && <div vkuiClass=\"View__modal\">{modal}</div>}\n        </AppRootPortal>\n      </Touch>\n    );\n  }\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/View\n */\nexport const View = withContext(\n  withContext(\n    withContext(\n      withPlatform(withDOM<ViewProps>(ViewComponent)),\n      SplitColContext,\n      \"splitCol\"\n    ),\n    ConfigProviderContext,\n    \"configProvider\"\n  ),\n  ScrollContext,\n  \"scroll\"\n);\n\nView.displayName = \"View\";\n"],"file":"View.js"}