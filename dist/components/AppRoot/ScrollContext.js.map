{"version":3,"file":"ScrollContext.js","names":["React","noop","useIsomorphicLayoutEffect","clamp","useDOM","useAdaptivityIsDesktop","clearDisableScrollStyle","node","Object","assign","style","position","top","left","right","overflowY","overflowX","getPageYOffsetWithoutKeyboardHeight","window","diffOfClientHeightAndViewportHeight","document","documentElement","clientHeight","innerHeight","pageYOffset","ScrollContext","createContext","getScroll","x","y","scrollTo","isScrollLock","enableScrollLock","disableScrollLock","useScroll","useContext","GlobalScrollController","children","useState","setScrollLock","beforeScrollLockFnSetRef","useRef","Set","useCallback","pageXOffset","body","scrollWidth","innerWidth","scrollHeight","current","forEach","fn","scrollY","scrollX","clientWidth","parseInt","scrollController","useMemo","ElementScrollController","elRef","scrollLeft","scrollTop","el","useScrollLockEffect","effect","deps","destructorRef","effectCallback","useEffect","beforeSet","add","delete","useScrollLock","enabled","isDesktop"],"sources":["../../../src/components/AppRoot/ScrollContext.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { noop } from \"../../lib/utils\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { clamp } from \"../../helpers/math\";\nimport { useDOM } from \"../../lib/dom\";\nimport { useAdaptivityIsDesktop } from \"../../hooks/useAdaptivity\";\n\nconst clearDisableScrollStyle = (node: HTMLElement) => {\n  Object.assign(node.style, {\n    position: \"\",\n    top: \"\",\n    left: \"\",\n    right: \"\",\n    overflowY: \"\",\n    overflowX: \"\",\n  });\n};\n\nconst getPageYOffsetWithoutKeyboardHeight = (window: Window) => {\n  // Note: здесь расчёт на то, что `clientHeight` равен `window.innerHeight`.\n  //  Это достигается тем, что тегу `html` задали`height: 100%` и у него нет отступов сверху и снизу. Если есть отступы,\n  //  то надо задать `box-sizing: border-box`, чтобы они не учитывались.\n  const diffOfClientHeightAndViewportHeight =\n    window.document.documentElement.clientHeight - window.innerHeight;\n  return window.pageYOffset - diffOfClientHeightAndViewportHeight;\n};\n\nexport interface ScrollContextInterface {\n  getScroll(this: void): { x: number; y: number };\n  scrollTo(this: void, x?: number, y?: number): void;\n  isScrollLock: boolean;\n  enableScrollLock(this: void): void;\n  disableScrollLock(this: void): void;\n  beforeScrollLockFnSetRef?: React.RefObject<Set<() => void>>;\n}\n\nexport const ScrollContext = React.createContext<ScrollContextInterface>({\n  getScroll: () => ({ x: 0, y: 0 }),\n  scrollTo: noop,\n  isScrollLock: false,\n  enableScrollLock: noop,\n  disableScrollLock: noop,\n});\n\nexport const useScroll = () => React.useContext(ScrollContext);\n\nexport interface ScrollControllerProps {\n  elRef: React.RefObject<HTMLElement>;\n  children?: React.ReactNode;\n}\n\nexport const GlobalScrollController = ({ children }: ScrollControllerProps) => {\n  const { window, document } = useDOM();\n  const [isScrollLock, setScrollLock] = React.useState(false);\n  const beforeScrollLockFnSetRef = React.useRef<Set<() => void>>(new Set());\n\n  const getScroll = React.useCallback<ScrollContextInterface[\"getScroll\"]>(\n    () => ({\n      x: window!.pageXOffset,\n      y: getPageYOffsetWithoutKeyboardHeight(window!),\n    }),\n    [window]\n  );\n  const scrollTo = React.useCallback<ScrollContextInterface[\"scrollTo\"]>(\n    (x = 0, y = 0) => {\n      // Some iOS versions do not normalize scroll — do it manually.\n      window!.scrollTo(\n        x ? clamp(x, 0, document!.body.scrollWidth - window!.innerWidth) : 0,\n        y ? clamp(y, 0, document!.body.scrollHeight - window!.innerHeight) : 0\n      );\n    },\n    [document, window]\n  );\n\n  const enableScrollLock = React.useCallback<\n    ScrollContextInterface[\"enableScrollLock\"]\n  >(() => {\n    beforeScrollLockFnSetRef.current.forEach((fn) => {\n      fn();\n    });\n\n    const scrollY = window!.pageYOffset;\n    const scrollX = window!.pageXOffset;\n    const overflowY =\n      window!.innerWidth > document!.documentElement.clientWidth\n        ? \"scroll\"\n        : \"\";\n    const overflowX =\n      window!.innerHeight > document!.documentElement.clientHeight\n        ? \"scroll\"\n        : \"\";\n\n    Object.assign(document!.body.style, {\n      position: \"fixed\",\n      top: `-${scrollY}px`,\n      left: `-${scrollX}px`,\n      right: \"0\",\n      overflowY,\n      overflowX,\n    });\n    setScrollLock(true);\n  }, [document, window]);\n\n  const disableScrollLock = React.useCallback<\n    ScrollContextInterface[\"disableScrollLock\"]\n  >(() => {\n    const scrollY = document!.body.style.top;\n    const scrollX = document!.body.style.left;\n\n    clearDisableScrollStyle(document!.body);\n    window!.scrollTo(-parseInt(scrollX || \"0\"), -parseInt(scrollY || \"0\"));\n    setScrollLock(false);\n  }, [document, window]);\n\n  const scrollController = React.useMemo<ScrollContextInterface>(\n    () => ({\n      getScroll,\n      scrollTo,\n      isScrollLock,\n      disableScrollLock,\n      enableScrollLock,\n\n      beforeScrollLockFnSetRef: beforeScrollLockFnSetRef,\n    }),\n    [getScroll, scrollTo, isScrollLock, disableScrollLock, enableScrollLock]\n  );\n\n  return (\n    <ScrollContext.Provider value={scrollController}>\n      {children}\n    </ScrollContext.Provider>\n  );\n};\n\nexport const ElementScrollController = ({\n  elRef,\n  children,\n}: ScrollControllerProps) => {\n  const [isScrollLock, setScrollLock] = React.useState(false);\n  const beforeScrollLockFnSetRef = React.useRef<Set<() => void>>(new Set());\n\n  const getScroll = React.useCallback<ScrollContextInterface[\"getScroll\"]>(\n    () => ({\n      x: elRef.current?.scrollLeft ?? 0,\n      y: elRef.current?.scrollTop ?? 0,\n    }),\n    [elRef]\n  );\n  const scrollTo = React.useCallback<ScrollContextInterface[\"scrollTo\"]>(\n    (x = 0, y = 0) => {\n      const el = elRef.current;\n      // Some iOS versions do not normalize scroll — do it manually.\n      el?.scrollTo(\n        x ? clamp(x, 0, el.scrollWidth - el.clientWidth) : 0,\n        y ? clamp(y, 0, el.scrollHeight - el.clientHeight) : 0\n      );\n    },\n    [elRef]\n  );\n\n  const enableScrollLock = React.useCallback<\n    ScrollContextInterface[\"enableScrollLock\"]\n  >(() => {\n    const el = elRef.current;\n    if (!el) {\n      return;\n    }\n    beforeScrollLockFnSetRef.current.forEach((fn) => {\n      fn();\n    });\n\n    const scrollY = el.scrollTop;\n    const scrollX = el.scrollLeft;\n    const overflowY = el.scrollWidth > el.clientWidth ? \"scroll\" : \"\";\n    const overflowX = el.scrollHeight > el.clientHeight ? \"scroll\" : \"\";\n\n    Object.assign(el.style, {\n      position: \"absolute\",\n      top: `-${scrollY}px`,\n      left: `-${scrollX}px`,\n      right: \"0\",\n      overflowY,\n      overflowX,\n    });\n    setScrollLock(true);\n  }, [elRef]);\n\n  const disableScrollLock = React.useCallback<\n    ScrollContextInterface[\"disableScrollLock\"]\n  >(() => {\n    const el = elRef.current;\n    if (!el) {\n      return;\n    }\n\n    const scrollY = el.style.top;\n    const scrollX = el.style.left;\n\n    clearDisableScrollStyle(el);\n    el.scrollTo(-parseInt(scrollX || \"0\"), -parseInt(scrollY || \"0\"));\n    setScrollLock(false);\n  }, [elRef]);\n\n  const scrollController = React.useMemo<ScrollContextInterface>(\n    () => ({\n      getScroll,\n      scrollTo,\n      isScrollLock,\n      disableScrollLock,\n      enableScrollLock,\n      beforeScrollLockFnSetRef,\n    }),\n    [getScroll, scrollTo, isScrollLock, disableScrollLock, enableScrollLock]\n  );\n\n  return (\n    <ScrollContext.Provider value={scrollController}>\n      {children}\n    </ScrollContext.Provider>\n  );\n};\n\n/**\n * Вызывает функцию effect, до блокировки прокрутки\n * @param effect функция, которая может возвращать функцию очистки\n * @param deps effect обновится только при изменении значений в списке.\n */\nexport const useScrollLockEffect = (\n  effect: React.EffectCallback,\n  deps: React.DependencyList\n) => {\n  const destructorRef = React.useRef<ReturnType<React.EffectCallback>>(noop);\n  const { isScrollLock, beforeScrollLockFnSetRef } = useScroll();\n\n  // Изменяем effectCallback только при изменении deps\n  const effectCallback = React.useCallback(() => {\n    destructorRef.current = effect();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  // Добавляем effectCallback в список функций, которые необходимо вызвать\n  // до блокировки\n  React.useEffect(() => {\n    const beforeSet = beforeScrollLockFnSetRef?.current;\n    if (!beforeSet) {\n      return noop;\n    }\n\n    beforeSet.add(effectCallback);\n\n    return () => {\n      beforeSet.delete(effectCallback);\n    };\n  }, [beforeScrollLockFnSetRef, effectCallback]);\n\n  // Вызываем сбрасывающую функцию, после отключения блокировки\n  React.useEffect(() => {\n    if (!isScrollLock && destructorRef.current) {\n      destructorRef.current();\n    }\n  }, [isScrollLock]);\n};\n\nexport const useScrollLock = (enabled = true) => {\n  const { enableScrollLock, disableScrollLock } = useScroll();\n  const isDesktop = useAdaptivityIsDesktop();\n\n  enabled = !isDesktop ? enabled : false;\n\n  useIsomorphicLayoutEffect(() => {\n    if (enabled) {\n      enableScrollLock();\n      return disableScrollLock;\n    }\n    return noop;\n  }, [enableScrollLock, disableScrollLock, enabled]);\n};\n"],"mappings":"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"}