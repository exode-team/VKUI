{"version":3,"file":"ModalRoot.js","names":["React","Touch","TouchRootContext","getClassName","classNames","setTransformStyle","rubber","ANDROID","IOS","VKCOM","transitionEvent","withPlatform","withContext","ModalRootContext","ConfigProviderContext","WebviewType","ModalType","MODAL_PAGE_DEFAULT_PERCENT_HEIGHT","withDOM","getNavId","warnOnce","FocusTrap","withModalManager","warn","IS_DEV","process","env","NODE_ENV","numberInRange","number","range","rangeTranslate","Math","max","min","ModalRootTouchComponent","props","createRef","undefined","event","originalEvent","preventDefault","modalState","getModalState","activeModal","animateTranslate","translateY","type","PAGE","dynamicContentHeight","enteringModal","waitTransitionFinish","requestAnimationFrame","checkPageContentHeight","e","exitingModal","onPageTouchMove","CARD","onCardTouchMove","onPageTouchEnd","onCardTouchEnd","target","contentElement","contains","contentScrolled","contentScrollStopTimeout","clearTimeout","setTimeout","state","touchDown","dragging","maskElementRef","modalRootContext","updateModalHeight","registerModal","id","data","Object","assign","onClose","onExit","isInsideModal","frameIds","platform","document","window","Children","toArray","children","addEventListener","updateModalTranslate","toggleDocumentScrolling","removeEventListener","prevProps","closeModal","enteringState","onEnter","innerElement","style","transitionDelay","onEntered","delayEnter","timeout","restoreFocusTo","activeElement","focus","enabled","documentScrolling","preventTouch","passive","modalElement","prevModalState","initPageModal","currentModalState","needAnimate","expandable","translateYFrom","setState","nextModalState","nextIsPage","prevIsPage","onExited","exitTranslate","isBack","setMaskOpacity","shiftY","isY","viewportRef","current","stopPropagation","collapsed","expanded","touchStartContentScrollTop","scrollTop","touchMovePositive","headerElement","shiftYPercent","innerHeight","shiftYCurrent","touchShiftYPercent","translateYCurrent","offsetHeight","startY","setStateCallback","shiftYEndPercent","expectTranslateY","duration","settlingHeight","expandedRange","collapsedRange","hiddenRange","hidden","eventHandler","supported","onceHandler","name","percent","frameId","cancelAnimationFrame","forceOpacity","history","maskAnimationFrame","opacity","toString","configProvider","webviewType","VKAPPS","onTouchMove","onTouchEnd","onScroll","getModals","map","Modal","modalId","_modalState","isPage","key","Component","ModalRootTouch","initModal","initCardModal","contentHeight","firstElementChild","prevTranslateY","clientHeight","shiftHalf","visiblePart","headerHeight","height","parentElement"],"sources":["../../../src/components/ModalRoot/ModalRoot.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Touch, TouchEvent } from \"../Touch/Touch\";\nimport TouchRootContext from \"../Touch/TouchContext\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { classNames } from \"../../lib/classNames\";\nimport { setTransformStyle } from \"../../lib/styles\";\nimport { rubber } from \"../../lib/touch\";\nimport { ANDROID, IOS, VKCOM } from \"../../lib/platform\";\nimport { transitionEvent } from \"../../lib/supportEvents\";\nimport { HasPlatform } from \"../../types\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport { withContext } from \"../../hoc/withContext\";\nimport {\n  ModalRootContext,\n  ModalRootContextInterface,\n} from \"./ModalRootContext\";\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n  WebviewType,\n} from \"../ConfigProvider/ConfigProviderContext\";\nimport { ModalsStateEntry, ModalType, TranslateRange } from \"./types\";\nimport { MODAL_PAGE_DEFAULT_PERCENT_HEIGHT } from \"./constants\";\nimport { DOMProps, withDOM } from \"../../lib/dom\";\nimport { getNavId } from \"../../lib/getNavId\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { FocusTrap } from \"../FocusTrap/FocusTrap\";\nimport { ModalTransitionProps, withModalManager } from \"./useModalManager\";\nimport \"./ModalRoot.css\";\n\nconst warn = warnOnce(\"ModalRoot\");\nconst IS_DEV = process.env.NODE_ENV === \"development\";\n\nfunction numberInRange(number: number, range: TranslateRange | undefined) {\n  if (!range) {\n    return false;\n  }\n  return number >= range[0] && number <= range[1];\n}\n\nfunction rangeTranslate(number: number) {\n  return Math.max(0, Math.min(98, number));\n}\n\nexport interface ModalRootProps extends HasPlatform {\n  activeModal?: string | null;\n\n  /**\n   * Будет вызвано при начале открытия активной модалки с её id\n   */\n  onOpen?(modalId: string): void;\n\n  /**\n   * Будет вызвано при окончательном открытии активной модалки с её id\n   */\n  onOpened?(modalId: string): void;\n\n  /**\n   * Будет вызвано при начале закрытия активной модалки с её id\n   */\n  onClose?(modalId: string): void;\n\n  /**\n   * Будет вызвано при окончательном закрытии активной модалки с её id\n   */\n  onClosed?(modalId: string): void;\n\n  /**\n   * @ignore\n   */\n  configProvider?: ConfigProviderContextInterface;\n  children?: React.ReactNode;\n}\n\ninterface ModalRootState {\n  touchDown?: boolean;\n  dragging?: boolean;\n}\n\nclass ModalRootTouchComponent extends React.Component<\n  ModalRootProps & DOMProps & ModalTransitionProps,\n  ModalRootState\n> {\n  constructor(props: ModalRootProps & ModalTransitionProps) {\n    super(props);\n    this.state = {\n      touchDown: false,\n      dragging: false,\n    };\n\n    this.maskElementRef = React.createRef();\n\n    this.modalRootContext = {\n      updateModalHeight: this.updateModalHeight,\n      registerModal: ({ id, ...data }) =>\n        Object.assign(this.getModalState(id), data),\n      onClose: () => this.props.onExit(),\n      isInsideModal: true,\n    };\n\n    this.frameIds = {};\n  }\n\n  private documentScrolling = false;\n  private readonly maskElementRef: React.RefObject<HTMLDivElement>;\n  private readonly viewportRef = React.createRef<HTMLDivElement>();\n  private maskAnimationFrame: number | undefined = undefined;\n  private readonly modalRootContext: ModalRootContextInterface;\n  private readonly frameIds: {\n    [index: string]: number;\n  };\n  private restoreFocusTo: HTMLElement | undefined | null = undefined;\n\n  get timeout(): number {\n    return this.props.platform === ANDROID || this.props.platform === VKCOM\n      ? 320\n      : 400;\n  }\n\n  get document() {\n    return this.props.document;\n  }\n\n  get window() {\n    return this.props.window;\n  }\n\n  getModalState(id: string | undefined | null) {\n    if (!id) {\n      return undefined;\n    }\n    return this.props.getModalState(id);\n  }\n\n  getModals() {\n    return React.Children.toArray(this.props.children) as React.ReactElement[];\n  }\n\n  componentDidMount() {\n    // Отслеживаем изменение размеров viewport (Необходимо для iOS)\n    if (this.props.platform === IOS) {\n      this.window?.addEventListener(\"resize\", this.updateModalTranslate, false);\n    }\n  }\n\n  componentWillUnmount() {\n    this.toggleDocumentScrolling(true);\n    this.window!.removeEventListener(\n      \"resize\",\n      this.updateModalTranslate,\n      false\n    );\n  }\n\n  componentDidUpdate(prevProps: ModalRootProps & ModalTransitionProps) {\n    // transition phase 2: animate exiting modal\n    if (\n      this.props.exitingModal &&\n      this.props.exitingModal !== prevProps.exitingModal\n    ) {\n      this.closeModal(this.props.exitingModal);\n    }\n\n    // transition phase 3: animate entering modal\n    if (\n      this.props.enteringModal &&\n      this.props.enteringModal !== prevProps.enteringModal\n    ) {\n      const { enteringModal } = this.props;\n      const enteringState = this.getModalState(enteringModal);\n      this.props.onEnter();\n      this.waitTransitionFinish(enteringState, () => {\n        if (enteringState?.innerElement) {\n          enteringState.innerElement.style.transitionDelay = \"\";\n        }\n        this.props.onEntered(enteringModal);\n      });\n\n      if (enteringState?.innerElement) {\n        enteringState.innerElement.style.transitionDelay = this.props.delayEnter\n          ? `${this.timeout}ms`\n          : \"\";\n        this.animateTranslate(enteringState, enteringState.translateY);\n      }\n    }\n\n    // focus restoration\n    if (this.props.activeModal && !prevProps.activeModal) {\n      this.restoreFocusTo = this.document!.activeElement as HTMLElement;\n    }\n    if (\n      !this.props.activeModal &&\n      !this.props.exitingModal &&\n      this.restoreFocusTo\n    ) {\n      this.restoreFocusTo.focus();\n      this.restoreFocusTo = null;\n    }\n\n    this.toggleDocumentScrolling(\n      !this.props.activeModal && !this.props.exitingModal\n    );\n  }\n\n  /* Отключает скролл документа */\n  toggleDocumentScrolling(enabled: boolean) {\n    if (this.documentScrolling === enabled) {\n      return;\n    }\n    this.documentScrolling = enabled;\n\n    if (enabled) {\n      // Здесь нужен последний аргумент с такими же параметрами, потому что\n      // некоторые браузеры на странных вендорах типа Meizu не удаляют обработчик.\n      // https://github.com/VKCOM/VKUI/issues/444\n      this.window!.removeEventListener(\"touchmove\", this.preventTouch, {\n        // @ts-ignore (В интерфейсе EventListenerOptions нет поля passive)\n        passive: false,\n      });\n    } else {\n      this.window!.addEventListener(\"touchmove\", this.preventTouch, {\n        passive: false,\n      });\n    }\n  }\n\n  preventTouch = (event: any) => {\n    if (!event) {\n      return false;\n    }\n    while (event.originalEvent) {\n      event = event.originalEvent;\n    }\n    if (event.preventDefault) {\n      event.preventDefault();\n    }\n    return false;\n  };\n\n  updateModalTranslate = () => {\n    const modalState = this.getModalState(this.props.activeModal);\n    modalState && this.animateTranslate(modalState, modalState.translateY);\n  };\n\n  checkPageContentHeight() {\n    const modalState = this.getModalState(this.props.activeModal);\n\n    if (modalState?.type === ModalType.PAGE && modalState?.modalElement) {\n      const prevModalState = { ...modalState };\n      initPageModal(modalState);\n      const currentModalState = { ...modalState };\n\n      let needAnimate = false;\n\n      if (prevModalState.expandable === currentModalState.expandable) {\n        if (\n          prevModalState.translateYFrom !== currentModalState.translateYFrom\n        ) {\n          needAnimate = true;\n        }\n      } else {\n        needAnimate = true;\n      }\n\n      if (needAnimate) {\n        this.animateTranslate(modalState, modalState.translateY);\n      }\n    }\n  }\n\n  updateModalHeight = () => {\n    const modalState = this.getModalState(this.props.activeModal);\n\n    if (\n      modalState &&\n      modalState.type === ModalType.PAGE &&\n      modalState.dynamicContentHeight\n    ) {\n      if (this.props.enteringModal) {\n        this.waitTransitionFinish(modalState, () => {\n          requestAnimationFrame(() => this.checkPageContentHeight());\n        });\n      } else {\n        requestAnimationFrame(() => this.checkPageContentHeight());\n      }\n    }\n  };\n\n  closeModal(id: string) {\n    // Сбрасываем состояния, которые могут помешать закрытию модального окна\n    this.setState({ touchDown: false });\n\n    const prevModalState = this.getModalState(id);\n\n    if (!prevModalState) {\n      id &&\n        warn(\n          `closeActiveModal: модальное окно (страница) ${id} не существует`,\n          \"error\"\n        );\n      return;\n    }\n\n    const nextModalState = this.getModalState(this.props.activeModal);\n    const nextIsPage =\n      !!nextModalState && nextModalState.type === ModalType.PAGE;\n\n    const prevIsPage =\n      !!prevModalState && prevModalState.type === ModalType.PAGE;\n    this.waitTransitionFinish(prevModalState, () => this.props.onExited(id));\n    const exitTranslate =\n      prevIsPage &&\n      nextIsPage &&\n      (prevModalState.translateY ?? 0) <=\n        (nextModalState?.translateYFrom ?? 0) &&\n      !this.props.isBack\n        ? (nextModalState?.translateYFrom ?? 0) + 10\n        : 100;\n    this.animateTranslate(prevModalState, exitTranslate);\n\n    if (!nextModalState) {\n      // NOTE: was only for clean exit\n      this.setMaskOpacity(prevModalState, 0);\n    }\n  }\n\n  onTouchMove = (e: TouchEvent) => {\n    if (this.props.exitingModal) {\n      return;\n    }\n    const modalState = this.getModalState(this.props.activeModal);\n    if (!modalState) {\n      return;\n    }\n\n    if (modalState.type === ModalType.PAGE) {\n      return this.onPageTouchMove(e, modalState);\n    }\n\n    if (modalState.type === ModalType.CARD) {\n      return this.onCardTouchMove(e, modalState);\n    }\n  };\n\n  onPageTouchMove(event: TouchEvent, modalState: ModalsStateEntry) {\n    const { shiftY, originalEvent } = event;\n    const target = originalEvent.target as HTMLElement;\n\n    if (!event.isY) {\n      if (this.viewportRef.current?.contains(target)) {\n        originalEvent.preventDefault();\n      }\n      return;\n    }\n\n    if (!modalState.innerElement?.contains(target)) {\n      return originalEvent.preventDefault();\n    }\n\n    originalEvent.stopPropagation();\n\n    const { expandable, contentScrolled, collapsed, expanded } = modalState;\n\n    if (!this.state.touchDown) {\n      modalState.touchStartContentScrollTop =\n        modalState.contentElement?.scrollTop ?? 0;\n      this.setState({ touchDown: true });\n    }\n\n    if (contentScrolled) {\n      return;\n    }\n\n    if (modalState.touchMovePositive === null) {\n      modalState.touchMovePositive = shiftY > 0;\n    }\n\n    if (\n      !modalState.expandable ||\n      collapsed ||\n      (expanded &&\n        modalState.touchMovePositive &&\n        modalState.touchStartContentScrollTop === 0) ||\n      modalState.headerElement?.contains(target)\n    ) {\n      originalEvent.preventDefault();\n\n      if ((!expandable && shiftY < 0) || !this.window) {\n        return;\n      }\n\n      !this.state.dragging && this.setState({ dragging: true });\n\n      const shiftYPercent = (shiftY / this.window.innerHeight) * 100;\n      const shiftYCurrent = rubber(\n        shiftYPercent,\n        72,\n        0.8,\n        this.props.platform === ANDROID || this.props.platform === VKCOM\n      );\n\n      modalState.touchShiftYPercent = shiftYPercent;\n      modalState.translateYCurrent = rangeTranslate(\n        (modalState.translateY ?? 0) + shiftYCurrent\n      );\n\n      this.animateTranslate(modalState, modalState.translateYCurrent);\n      this.setMaskOpacity(modalState);\n    }\n  }\n\n  onCardTouchMove(event: TouchEvent, modalState: ModalsStateEntry) {\n    const { originalEvent, shiftY } = event;\n    const target = originalEvent.target as HTMLElement;\n    if (modalState.innerElement?.contains(target)) {\n      if (!this.state.touchDown) {\n        this.setState({ touchDown: true, dragging: true });\n      }\n\n      const shiftYPercent =\n        (shiftY / modalState.innerElement.offsetHeight) * 100;\n      const shiftYCurrent = rubber(\n        shiftYPercent,\n        72,\n        1.2,\n        this.props.platform === ANDROID || this.props.platform === VKCOM\n      );\n\n      modalState.touchShiftYPercent = shiftYPercent;\n      modalState.translateYCurrent = Math.max(\n        0,\n        (modalState.translateY ?? 0) + shiftYCurrent\n      );\n\n      this.animateTranslate(modalState, modalState.translateYCurrent);\n      this.setMaskOpacity(modalState);\n    }\n  }\n\n  onTouchEnd = (e: TouchEvent) => {\n    const modalState = this.getModalState(this.props.activeModal);\n\n    if (modalState?.type === ModalType.PAGE) {\n      return this.onPageTouchEnd(e, modalState);\n    }\n\n    if (modalState?.type === ModalType.CARD) {\n      return this.onCardTouchEnd(e, modalState);\n    }\n  };\n\n  onPageTouchEnd(event: TouchEvent, modalState: ModalsStateEntry) {\n    const { startY, shiftY } = event;\n\n    modalState.contentScrolled = false;\n    modalState.touchMovePositive = null;\n\n    let setStateCallback;\n\n    if (this.state.dragging && this.window) {\n      const shiftYEndPercent =\n        ((startY + shiftY) / this.window.innerHeight) * 100;\n\n      let translateY = modalState.translateYCurrent ?? 0;\n      const expectTranslateY =\n        (translateY / event.duration) *\n        240 *\n        0.6 *\n        ((modalState.touchShiftYPercent ?? 0) < 0 ? -1 : 1);\n      translateY = rangeTranslate(translateY + expectTranslateY);\n\n      if (modalState.settlingHeight !== 100) {\n        if (numberInRange(translateY, modalState.expandedRange)) {\n          translateY = modalState.expandedRange?.[0] ?? 0;\n        } else if (numberInRange(translateY, modalState.collapsedRange)) {\n          translateY = modalState.translateYFrom ?? 0;\n        } else if (numberInRange(translateY, modalState.hiddenRange)) {\n          translateY = 100;\n        } else {\n          translateY = modalState.translateYFrom ?? 0;\n        }\n      } else {\n        if (numberInRange(translateY, [0, 25])) {\n          translateY = 0;\n        } else {\n          translateY = 100;\n        }\n      }\n\n      if (translateY !== 100 && shiftYEndPercent >= 75) {\n        translateY = 100;\n      }\n\n      modalState.translateY = translateY;\n      modalState.translateYCurrent = translateY;\n      modalState.collapsed = translateY > 0 && translateY < shiftYEndPercent;\n      modalState.expanded = translateY === 0;\n      modalState.hidden = translateY === 100;\n\n      if (modalState.hidden) {\n        this.props.onExit();\n      }\n\n      setStateCallback = () => {\n        if (!modalState.hidden) {\n          this.animateTranslate(modalState, modalState.translateY);\n        }\n\n        this.setMaskOpacity(modalState);\n      };\n    }\n\n    this.setState(\n      {\n        touchDown: false,\n        dragging: false,\n      },\n      setStateCallback\n    );\n  }\n\n  onCardTouchEnd({ duration }: TouchEvent, modalState: ModalsStateEntry) {\n    let setStateCallback;\n\n    if (this.state.dragging) {\n      let translateY = modalState.translateYCurrent ?? 0;\n\n      const expectTranslateY =\n        (translateY / duration) *\n        240 *\n        0.6 *\n        ((modalState.touchShiftYPercent ?? 0) < 0 ? -1 : 1);\n      translateY = Math.max(0, translateY + expectTranslateY);\n\n      if (translateY >= 30) {\n        translateY = 100;\n      } else {\n        translateY = 0;\n      }\n\n      modalState.translateY = translateY;\n      modalState.hidden = translateY === 100;\n\n      if (modalState.hidden) {\n        this.props.onExit();\n      }\n\n      setStateCallback = () => {\n        if (!modalState.hidden) {\n          this.animateTranslate(modalState, modalState.translateY);\n        }\n\n        this.setMaskOpacity(modalState);\n      };\n    }\n\n    this.setState(\n      {\n        touchDown: false,\n        dragging: false,\n      },\n      setStateCallback\n    );\n  }\n\n  onScroll = (e: React.SyntheticEvent) => {\n    const activeModal = this.props.activeModal;\n\n    const target = e.target as HTMLElement;\n\n    if (!activeModal) {\n      return;\n    }\n    const modalState = this.getModalState(activeModal);\n    if (\n      modalState?.type === ModalType.PAGE &&\n      modalState?.contentElement?.contains(target)\n    ) {\n      modalState.contentScrolled = true;\n\n      if (modalState.contentScrollStopTimeout) {\n        clearTimeout(modalState.contentScrollStopTimeout);\n      }\n\n      modalState.contentScrollStopTimeout = setTimeout(() => {\n        if (modalState.contentScrolled) {\n          modalState.contentScrolled = false;\n        }\n      }, 250);\n    }\n  };\n\n  waitTransitionFinish(\n    modalState: ModalsStateEntry | undefined,\n    eventHandler: () => void\n  ) {\n    if (transitionEvent.supported) {\n      const onceHandler = () => {\n        modalState?.innerElement?.removeEventListener(\n          transitionEvent.name as string,\n          onceHandler\n        );\n        eventHandler();\n      };\n\n      modalState?.innerElement?.addEventListener(\n        transitionEvent.name as string,\n        onceHandler\n      );\n    } else {\n      setTimeout(eventHandler, this.timeout);\n    }\n  }\n\n  /**\n   * Анимирует сдвиг модалки\n   *\n   * @param {ModalsStateEntry} modalState\n   * @param {number} percent Процент сдвига: 0 – полностью открыта, 100 – полностью закрыта\n   */\n  animateTranslate(modalState: ModalsStateEntry, percent: number | undefined) {\n    const frameId = `animateTranslateFrame${modalState.id}`;\n\n    cancelAnimationFrame(this.frameIds[frameId]);\n\n    this.frameIds[frameId] = requestAnimationFrame(() => {\n      setTransformStyle(\n        modalState.innerElement,\n        `translate3d(0, ${percent}%, 0)`\n      );\n    });\n  }\n\n  /* Устанавливает прозрачность для полупрозрачной подложки */\n  setMaskOpacity(\n    modalState: ModalsStateEntry,\n    forceOpacity: number | null = null\n  ) {\n    if (forceOpacity === null && this.props.history?.[0] !== modalState.id) {\n      return;\n    }\n    if (this.maskAnimationFrame) {\n      cancelAnimationFrame(this.maskAnimationFrame);\n    }\n    this.maskAnimationFrame = requestAnimationFrame(() => {\n      if (this.maskElementRef.current) {\n        const { translateY = 0, translateYCurrent = 0 } = modalState;\n\n        const opacity =\n          forceOpacity === null\n            ? 1 - (translateYCurrent - translateY) / (100 - translateY) || 0\n            : forceOpacity;\n        this.maskElementRef.current.style.opacity = Math.max(\n          0,\n          Math.min(100, opacity)\n        ).toString();\n      }\n    });\n  }\n\n  render() {\n    const { activeModal, exitingModal, enteringModal } = this.props;\n    const { touchDown, dragging } = this.state;\n\n    if (!activeModal && !exitingModal) {\n      return null;\n    }\n\n    return (\n      <TouchRootContext.Provider value={true}>\n        <ModalRootContext.Provider value={this.modalRootContext}>\n          <Touch\n            vkuiClass={classNames(\n              getClassName(\"ModalRoot\", this.props.platform),\n              this.props.configProvider?.webviewType === WebviewType.VKAPPS &&\n                \"ModalRoot--vkapps\",\n              touchDown && \"ModalRoot--touched\",\n              !!(enteringModal || exitingModal) && \"ModalRoot--switching\"\n            )}\n            onMove={this.onTouchMove}\n            onEnd={this.onTouchEnd}\n            onScroll={this.onScroll}\n          >\n            <div\n              vkuiClass=\"ModalRoot__mask\"\n              onClick={this.props.onExit}\n              ref={this.maskElementRef}\n            />\n            <div vkuiClass=\"ModalRoot__viewport\" ref={this.viewportRef}>\n              {this.getModals().map((Modal) => {\n                const modalId = getNavId(Modal.props, warn);\n                const _modalState = this.getModalState(modalId);\n                if (\n                  (modalId !== activeModal && modalId !== exitingModal) ||\n                  !_modalState\n                ) {\n                  return null;\n                }\n                const modalState = { ..._modalState };\n\n                const isPage = modalState.type === ModalType.PAGE;\n                const key = `modal-${modalId}`;\n\n                return (\n                  <FocusTrap\n                    key={key}\n                    getRootRef={(e) => {\n                      const modalState = this.getModalState(modalId);\n                      if (modalState) {\n                        modalState.modalElement = e;\n                      }\n                    }}\n                    onClose={this.props.onExit}\n                    timeout={this.timeout}\n                    vkuiClass={classNames(\n                      \"ModalRoot__modal\",\n                      modalId === activeModal && \"ModalRoot__modal--active\",\n                      modalId === exitingModal && \"ModalRoot__modal--prev\",\n                      ((exitingModal && modalId === activeModal) ||\n                        modalId === enteringModal) &&\n                        \"ModalRoot__modal--next\",\n\n                      dragging && \"ModalRoot__modal--dragging\",\n\n                      isPage &&\n                        modalState.expandable &&\n                        \"ModalRoot__modal--expandable\",\n                      isPage &&\n                        modalState.expanded &&\n                        \"ModalRoot__modal--expanded\",\n                      isPage &&\n                        modalState.collapsed &&\n                        \"ModalRoot__modal--collapsed\"\n                    )}\n                    restoreFocus={false}\n                  >\n                    {Modal}\n                  </FocusTrap>\n                );\n              })}\n            </div>\n          </Touch>\n        </ModalRootContext.Provider>\n      </TouchRootContext.Provider>\n    );\n  }\n}\n\nexport const ModalRootTouch = withContext(\n  withPlatform(\n    withDOM<ModalRootProps>(\n      withModalManager(initModal)(ModalRootTouchComponent)\n    )\n  ),\n  ConfigProviderContext,\n  \"configProvider\"\n);\n\n/**\n * Инициализирует модалку перед анимацией открытия\n */\nfunction initModal(modalState: ModalsStateEntry) {\n  switch (modalState.type) {\n    case ModalType.PAGE:\n      modalState.settlingHeight =\n        modalState.settlingHeight || MODAL_PAGE_DEFAULT_PERCENT_HEIGHT;\n      return initPageModal(modalState);\n    case ModalType.CARD:\n      return initCardModal(modalState);\n    default:\n      IS_DEV &&\n        warn(\n          `initActiveModal: modalState.type=\"${modalState.type}\" не поддерживается`,\n          \"error\"\n        );\n  }\n}\n\nfunction initPageModal(modalState: ModalsStateEntry) {\n  const { contentElement } = modalState;\n  const contentHeight = (contentElement?.firstElementChild as HTMLElement)\n    .offsetHeight;\n\n  let prevTranslateY = modalState.translateY;\n\n  modalState.expandable =\n    contentHeight > (contentElement?.clientHeight ?? 0) ||\n    modalState.settlingHeight === 100;\n\n  let collapsed = false;\n  let expanded = false;\n  let translateYFrom;\n  let translateY;\n  let expandedRange: TranslateRange;\n  let collapsedRange: TranslateRange;\n  let hiddenRange: TranslateRange;\n\n  if (modalState.expandable) {\n    translateYFrom = 100 - (modalState.settlingHeight ?? 0);\n\n    const shiftHalf = translateYFrom / 2;\n    const visiblePart = 100 - translateYFrom;\n\n    expandedRange = [0, shiftHalf];\n    collapsedRange = [shiftHalf, translateYFrom + visiblePart / 4];\n    hiddenRange = [translateYFrom + visiblePart / 4, 100];\n\n    collapsed = translateYFrom > 0;\n    expanded = translateYFrom <= 0;\n    translateY = translateYFrom;\n  } else {\n    const headerHeight = modalState.headerElement?.offsetHeight ?? 0;\n    const height = contentHeight + headerHeight;\n\n    translateYFrom =\n      100 -\n      (height / (modalState.innerElement?.parentElement?.offsetHeight ?? 0)) *\n        100;\n    translateY = translateYFrom;\n\n    expandedRange = [translateY, translateY + 25];\n    collapsedRange = [translateY + 25, translateY + 25];\n    hiddenRange = [translateY + 25, translateY + 100];\n  }\n\n  // Если модалка может открываться на весь экран, и новый сдвиг больше предыдущего, то откроем её на весь экран\n  if (\n    (modalState.expandable && translateY > (prevTranslateY ?? 100)) ||\n    modalState.settlingHeight === 100\n  ) {\n    translateY = 0;\n  }\n\n  // Если модалка уже раскрыта обновляем состояния\n  if (translateY === 0) {\n    expanded = true;\n    collapsed = false;\n  }\n\n  modalState.expandedRange = expandedRange;\n  modalState.collapsedRange = collapsedRange;\n  modalState.hiddenRange = hiddenRange;\n  modalState.translateY = translateY;\n  modalState.translateYFrom = translateYFrom;\n  modalState.collapsed = collapsed;\n  modalState.expanded = expanded;\n}\n\nfunction initCardModal(modalState: ModalsStateEntry) {\n  modalState.translateY = 0;\n}\n"],"mappings":"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"}