{"version":3,"file":"SSR.js","names":["React","platform","computeBrowserInfo","DOMContext","getDOM","SSRContext","createContext","userAgent","browserInfo","undefined","SSRWrapper","children","contextValue","dom"],"sources":["../../src/lib/SSR.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { PlatformType, platform } from \"./platform\";\nimport { BrowserInfo, computeBrowserInfo } from \"./browser\";\nimport { DOMContext, getDOM } from \"../lib/dom\";\n\nexport interface SSRContextInterface {\n  platform: PlatformType | null;\n  userAgent?: string;\n  browserInfo?: BrowserInfo;\n}\n\nexport const SSRContext = React.createContext<SSRContextInterface>({\n  platform: null,\n  userAgent: \"\",\n  browserInfo: undefined,\n});\n\nexport interface SSRWrapperProps {\n  userAgent?: string;\n  browserInfo?: BrowserInfo;\n  children?: React.ReactNode;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/SSR\n */\nexport const SSRWrapper = ({\n  userAgent,\n  browserInfo,\n  children,\n}: SSRWrapperProps) => {\n  if (!browserInfo && userAgent) {\n    browserInfo = computeBrowserInfo(userAgent);\n  }\n\n  // TODO: Каждый раз создаётся новый объект для контекста - плохо\n  const contextValue = {\n    platform: platform(browserInfo),\n    browserInfo,\n    userAgent,\n  };\n\n  // TODO: move to state, and update in effect?\n  const dom = getDOM();\n\n  return (\n    <SSRContext.Provider value={contextValue}>\n      <DOMContext.Provider value={dom}>{children}</DOMContext.Provider>\n    </SSRContext.Provider>\n  );\n};\n"],"mappings":";AAAA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,SAAuBC,QAAQ;AAC/B,SAAsBC,kBAAkB;AACxC,SAASC,UAAU,EAAEC,MAAM;AAQ3B,OAAO,IAAMC,UAAU,gBAAGL,KAAK,CAACM,aAAa,CAAsB;EACjEL,QAAQ,EAAE,IAAI;EACdM,SAAS,EAAE,EAAE;EACbC,WAAW,EAAEC;AACf,CAAC,CAAC;AAQF;AACA;AACA;AACA,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAU,OAIA;EAAA,IAHrBH,SAAS,QAATA,SAAS;IACTC,WAAW,QAAXA,WAAW;IACXG,QAAQ,QAARA,QAAQ;EAER,IAAI,CAACH,WAAW,IAAID,SAAS,EAAE;IAC7BC,WAAW,GAAGN,kBAAkB,CAACK,SAAS,CAAC;EAC7C;;EAEA;EACA,IAAMK,YAAY,GAAG;IACnBX,QAAQ,EAAEA,QAAQ,CAACO,WAAW,CAAC;IAC/BA,WAAW,EAAXA,WAAW;IACXD,SAAS,EAATA;EACF,CAAC;;EAED;EACA,IAAMM,GAAG,GAAGT,MAAM,EAAE;EAEpB,OACE,oBAAC,UAAU,CAAC,QAAQ;IAAC,KAAK,EAAEQ;EAAa,GACvC,oBAAC,UAAU,CAAC,QAAQ;IAAC,KAAK,EAAEC;EAAI,GAAEF,QAAQ,CAAuB,CAC7C;AAE1B,CAAC"}