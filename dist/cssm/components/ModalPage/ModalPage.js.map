{"version":3,"file":"ModalPage.js","names":["React","classNames","ModalRootContext","useModalRegistry","usePlatform","useOrientationChange","withAdaptivity","ModalDismissButton","multiRef","ModalType","getNavId","warnOnce","Platform","useAdaptivityIsDesktop","warn","ModalPageComponent","children","header","size","sizeProp","viewWidth","viewHeight","sizeX","hasMouse","onOpen","onOpened","onClose","onClosed","settlingHeight","dynamicContentHeight","getModalContentRef","nav","id","hideCloseButton","restProps","useContext","updateModalHeight","platform","orientation","useEffect","isDesktop","isCloseButtonShown","modalContext","PAGE","refs","IOS","VKCOM","innerElement","headerElement","contentElement","ModalPage","displayName"],"sources":["../../../../src/components/ModalPage/ModalPage.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport {\n  ModalRootContext,\n  useModalRegistry,\n} from \"../ModalRoot/ModalRootContext\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useOrientationChange } from \"../../hooks/useOrientationChange\";\nimport { withAdaptivity } from \"../../hoc/withAdaptivity\";\nimport {\n  AdaptivityContextInterface,\n  AdaptivityProps,\n} from \"../AdaptivityProvider/AdaptivityContext\";\nimport { ModalDismissButton } from \"../ModalDismissButton/ModalDismissButton\";\nimport { multiRef } from \"../../lib/utils\";\nimport { ModalType } from \"../ModalRoot/types\";\nimport { getNavId, NavIdProps } from \"../../lib/getNavId\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { Platform } from \"../../lib/platform\";\nimport { useAdaptivityIsDesktop } from \"../../hooks/useAdaptivity\";\nimport \"./ModalPage.css\";\n\nexport interface ModalPageProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    AdaptivityProps,\n    NavIdProps {\n  /**\n   * Шапка модальной страницы, `<ModalPageHeader />`\n   */\n  header?: React.ReactNode;\n  /**\n   * Задаёт контенту максимальную ширину.\n   *\n   * > ⚠️ **Заметки:**\n   * > - Для `viewWidth < SMALL_TABLET_SIZE` будет всегда `\"s\"`\n   * > - Для `platform === VKCOM` максимальная ширина зашита, её не изменить.\n   */\n  size?: \"s\" | \"m\" | \"l\";\n  /**\n   * Будет вызвано при начале открытия модалки.\n   */\n  onOpen?: VoidFunction;\n  /**\n   * Будет вызвано при окончательном открытии модалки.\n   */\n  onOpened?: VoidFunction;\n  /**\n   * Будет вызвано при начале закрытия модалки.\n   */\n  onClose?: VoidFunction;\n  /**\n   * Будет вызвано при окончательном закрытии модалки.\n   */\n  onClosed?: VoidFunction;\n  /**\n   * Процент, на который изначально будет открыта модальная страница. При `settlingHeight={100}` модальная страница раскрывается на всю высоту.\n   */\n  settlingHeight?: number;\n  /**\n   * Если высота контента в модальной странице может поменяться, нужно установить это свойство\n   */\n  dynamicContentHeight?: boolean;\n  getModalContentRef?: React.Ref<HTMLDivElement>;\n  /**\n   * Скрывает кнопку закрытия (актуально для iOS, т.к. можно отрисовать кнопку закрытия внутри модалки)\n   */\n  hideCloseButton?: boolean;\n}\n\nconst warn = warnOnce(\"ModalPage\");\n\nconst ModalPageComponent = ({\n  children,\n  header,\n  size: sizeProp = \"s\",\n  viewWidth,\n  viewHeight,\n  sizeX,\n  hasMouse,\n  onOpen,\n  onOpened,\n  onClose,\n  onClosed,\n  settlingHeight, // 75\n  dynamicContentHeight,\n  getModalContentRef,\n  nav,\n  id,\n  hideCloseButton = false,\n  ...restProps\n}: ModalPageProps & AdaptivityContextInterface) => {\n  const { updateModalHeight } = React.useContext(ModalRootContext);\n\n  const platform = usePlatform();\n  const orientation = useOrientationChange();\n\n  React.useEffect(updateModalHeight, [\n    children,\n    orientation,\n    updateModalHeight,\n  ]);\n\n  const isDesktop = useAdaptivityIsDesktop();\n  const isCloseButtonShown = !hideCloseButton && isDesktop;\n  const size = isDesktop ? sizeProp : \"s\";\n\n  const modalContext = React.useContext(ModalRootContext);\n  const { refs } = useModalRegistry(\n    getNavId({ nav, id }, warn),\n    ModalType.PAGE\n  );\n\n  return (\n    <div\n      {...restProps}\n      id={id}\n      vkuiClass={classNames(\n        \"ModalPage\",\n        platform === Platform.IOS && \"ModalPage--ios\",\n        platform === Platform.VKCOM && \"ModalPage--vkcom\",\n        `ModalPage--sizeX-${sizeX}`, // TODO v5.0.0 поправить под новую адаптивность\n        isDesktop && \"ModalPage--desktop\",\n        size && `ModalPage--${size}`\n      )}\n    >\n      <div vkuiClass=\"ModalPage__in-wrap\" ref={refs.innerElement}>\n        <div vkuiClass=\"ModalPage__in\">\n          <div vkuiClass=\"ModalPage__header\" ref={refs.headerElement}>\n            {header}\n          </div>\n\n          <div vkuiClass=\"ModalPage__content-wrap\">\n            <div\n              vkuiClass=\"ModalPage__content\"\n              ref={multiRef<HTMLDivElement>(\n                refs.contentElement,\n                getModalContentRef\n              )}\n            >\n              <div vkuiClass=\"ModalPage__content-in\">{children}</div>\n            </div>\n          </div>\n          {isCloseButtonShown && (\n            <ModalDismissButton onClick={onClose || modalContext.onClose} />\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n/**\n * @see https://vkcom.github.io/VKUI/#/ModalPage\n */\nexport const ModalPage = withAdaptivity(ModalPageComponent, {\n  viewWidth: true,\n  viewHeight: true,\n  sizeX: true,\n  hasMouse: true,\n});\n\nModalPage.displayName = \"ModalPage\";\n"],"mappings":"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"}