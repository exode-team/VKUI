{"version":3,"file":"Avatar.js","names":["React","Icon12Circle","Icon12OnlineMobile","classNames","useAdaptivity","Tappable","AVATAR_DEFAULT_SIZE","AVATAR_DEFAULT_SHADOW","Avatar","alt","crossOrigin","decoding","height","loading","referrerPolicy","sizes","src","srcSet","useMap","width","getRef","size","shadow","mode","className","children","getRootRef","style","ariaLabel","badge","overlayIcon","overlayMode","passedOverlayAction","overlayAction","onClick","restProps","hasMouse","useState","failedImage","setFailedImage","onImageError","onImageLoad","borderRadius","hasSrc","undefined"],"sources":["../../../../src/components/Avatar/Avatar.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Icon12Circle, Icon12OnlineMobile } from \"@vkontakte/icons\";\nimport { classNames } from \"../../lib/classNames\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { Tappable } from \"../Tappable/Tappable\";\nimport { HasRef, HasRootRef } from \"../../types\";\nimport \"./Avatar.css\";\n\nexport interface AvatarProps\n  extends React.ImgHTMLAttributes<HTMLElement>,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLImageElement> {\n  /**\n   * Рекомендуемый сет значений: 96 | 88 | 80 | 72 | 64 | 56 | 48 | 44 | 40 | 36 | 32 | 28 | 24\n   */\n  size?: number;\n  mode?: \"default\" | \"image\" | \"app\";\n  shadow?: boolean;\n  badge?: \"online\" | \"online-mobile\" | JSX.Element;\n  overlayIcon?: JSX.Element;\n  overlayMode?: \"dark\" | \"light\";\n  /**\n   * Поведение показа overlay: \"hover\" - при наведении, \"always\" - всегда\n   */\n  overlayAction?: \"hover\" | \"always\";\n}\n\nexport const AVATAR_DEFAULT_SIZE = 48;\nexport const AVATAR_DEFAULT_SHADOW = true;\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Avatar\n */\nexport const Avatar = ({\n  alt,\n  crossOrigin,\n  decoding,\n  height,\n  loading,\n  referrerPolicy,\n  sizes,\n  src,\n  srcSet,\n  useMap,\n  width,\n  getRef,\n  size = AVATAR_DEFAULT_SIZE,\n  shadow = AVATAR_DEFAULT_SHADOW,\n  mode = \"default\",\n  className,\n  children,\n  getRootRef,\n  style,\n  \"aria-label\": ariaLabel,\n  badge,\n  overlayIcon,\n  overlayMode = \"light\",\n  overlayAction: passedOverlayAction,\n  onClick,\n  ...restProps\n}: AvatarProps) => {\n  const { hasMouse } = useAdaptivity();\n  const [failedImage, setFailedImage] = React.useState(false);\n\n  const overlayAction = passedOverlayAction ?? (hasMouse ? \"hover\" : \"always\");\n\n  const onImageError = () => {\n    setFailedImage(true);\n  };\n\n  const onImageLoad = () => {\n    setFailedImage(false);\n  };\n\n  let borderRadius: string | number = \"50%\";\n\n  switch (mode) {\n    case \"image\":\n      size < 64 && (borderRadius = 4);\n      size >= 64 && size < 96 && (borderRadius = 6);\n      size >= 96 && (borderRadius = 8);\n      break;\n    case \"app\":\n      size <= 40 && (borderRadius = 8);\n      size > 40 && size < 56 && (borderRadius = 10);\n      size >= 56 && size < 64 && (borderRadius = 12);\n      size >= 64 && size < 84 && (borderRadius = 16);\n      size >= 84 && (borderRadius = 18);\n      break;\n    default:\n      break;\n  }\n\n  const hasSrc = src || srcSet;\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        \"Avatar\",\n        `Avatar--type-${mode}`,\n        `Avatar--sz-${size}`,\n        shadow && \"Avatar--shadow\",\n        failedImage && \"Avatar--failed\"\n      )}\n      className={className}\n      ref={getRootRef}\n      role={hasSrc ? \"img\" : \"presentation\"}\n      aria-label={alt || ariaLabel}\n      onClick={!overlayIcon ? onClick : undefined}\n      style={{ ...style, width: size, height: size, borderRadius }}\n    >\n      {hasSrc && (\n        <img\n          crossOrigin={crossOrigin}\n          decoding={decoding}\n          height={height}\n          loading={loading}\n          referrerPolicy={referrerPolicy}\n          sizes={sizes}\n          src={src}\n          srcSet={srcSet}\n          useMap={useMap}\n          width={width}\n          ref={getRef}\n          onError={onImageError}\n          onLoad={onImageLoad}\n          vkuiClass=\"Avatar__img\"\n          alt=\"\"\n        />\n      )}\n      {children && <div vkuiClass=\"Avatar__children\">{children}</div>}\n      {overlayIcon && (\n        <Tappable\n          Component=\"button\"\n          vkuiClass={classNames(\n            \"Avatar__overlay\",\n            overlayAction === \"always\" && \"Avatar__overlay--visible\",\n            overlayMode === \"light\" && \"Avatar__overlay--light\",\n            overlayMode === \"dark\" && \"Avatar__overlay--dark\"\n          )}\n          hoverMode=\"Avatar__overlay--visible\"\n          focusVisibleMode=\"Avatar__overlay--focus-visible\"\n          hasActive={false}\n          onClick={onClick}\n        >\n          {overlayIcon}\n        </Tappable>\n      )}\n      {badge && (\n        <div\n          vkuiClass={classNames(\n            \"Avatar__badge\",\n            size >= 96 && \"Avatar__badge--large\",\n            badge !== \"online\" &&\n              badge !== \"online-mobile\" &&\n              \"Avatar__badge--shadow\"\n          )}\n        >\n          {badge === \"online\" ? (\n            <div vkuiClass=\"Avatar__badge-online\">\n              <Icon12Circle\n                width={size >= 72 ? 15 : 12}\n                height={size >= 72 ? 15 : 12}\n              />\n            </div>\n          ) : badge === \"online-mobile\" ? (\n            <div vkuiClass=\"Avatar__badge-online-mobile\">\n              <Icon12OnlineMobile\n                width={size >= 72 ? 9 : 8}\n                height={size >= 72 ? 15 : 12}\n              />\n            </div>\n          ) : (\n            badge\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n"],"mappings":"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"}