{"version":3,"sources":["../../../../src/components/BaseGallery/BaseGallery.tsx"],"names":["React","classNames","Touch","HorizontalScrollArrow","useExternRef","useDOM","useAdaptivity","useIsomorphicLayoutEffect","useGlobalEventListener","calcMax","calcMin","ANIMATION_DURATION","LAYOUT_DEFAULT_STATE","containerWidth","viewportOffsetWidth","layerWidth","min","max","slides","isFullyVisible","SHIFT_DEFAULT_STATE","animation","undefined","shiftX","dragging","deltaX","indent","BaseGallery","bullets","getRootRef","children","slideWidth","slideIndex","isDraggable","isDraggableProp","onDragStart","onDragEnd","onChange","onPrevClick","onNextClick","onEndProp","onEnd","align","showArrows","getRef","arrowSize","restProps","slidesStore","useRef","layoutState","useState","shiftState","setShiftState","rootRef","viewportRef","window","hasMouse","isCenterWithCustomWidth","validateIndent","value","localMax","current","localMin","calculateIndent","targetIndex","targetSlide","length","coordX","width","viewportWidth","calculateDragIndent","Number","initializeSlides","options","localSlides","Children","map","_item","i","elem","offsetLeft","offsetWidth","localContainerWidth","localViewportOffsetWidth","localLayerWidth","reduce","val","slide","adjustShiftX","prevState","onResize","slideLeft","event","slideRight","getTarget","e","expectDeltaX","duration","shift","direction","item","index","previousValue","Math","abs","currentValue","onStart","onMoveX","originalEvent","preventDefault","isSlideX","isSlide","nextShiftState","shiftXStick","layerStyle","WebkitTransform","transform","WebkitTransition","transition","setSlideRef","slideRef","canSlideLeft","canSlideRight","el"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { Touch, TouchEvent } from \"../Touch/Touch\";\nimport { HorizontalScrollArrow } from \"../HorizontalScroll/HorizontalScrollArrow\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { useDOM } from \"../../lib/dom\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport { calcMax, calcMin } from \"./helpers\";\nimport {\n  BaseGalleryProps,\n  GallerySlidesState,\n  LayoutState,\n  ShiftingState,\n} from \"./types\";\nimport \"./BaseGallery.css\";\n\nconst ANIMATION_DURATION = 0.24;\n\nconst LAYOUT_DEFAULT_STATE = {\n  containerWidth: 0,\n  viewportOffsetWidth: 0,\n  layerWidth: 0,\n  min: 0,\n  max: 0,\n  slides: [],\n  isFullyVisible: true,\n};\n\nconst SHIFT_DEFAULT_STATE = {\n  animation: undefined,\n  shiftX: 0,\n  dragging: false,\n  deltaX: 0,\n  indent: 0,\n};\n\nexport const BaseGallery = ({\n  bullets = false,\n  getRootRef,\n  children,\n  slideWidth = \"100%\",\n  slideIndex = 0,\n  isDraggable: isDraggableProp = true,\n  onDragStart,\n  onDragEnd,\n  onChange,\n  onPrevClick,\n  onNextClick,\n  onEnd: onEndProp,\n  align = \"left\",\n  showArrows,\n  getRef,\n  arrowSize = \"l\",\n  ...restProps\n}: BaseGalleryProps) => {\n  const slidesStore = React.useRef<Record<string, HTMLDivElement | null>>({});\n  const layoutState = React.useRef<LayoutState>(LAYOUT_DEFAULT_STATE);\n  const [shiftState, setShiftState] =\n    React.useState<ShiftingState>(SHIFT_DEFAULT_STATE);\n\n  const rootRef = useExternRef(getRootRef);\n  const viewportRef = useExternRef(getRef);\n\n  const { window } = useDOM();\n  const { hasMouse } = useAdaptivity();\n\n  const isCenterWithCustomWidth = slideWidth === \"custom\" && align === \"center\";\n\n  const validateIndent = (value: number) => {\n    const localMax = layoutState.current.max ?? 0;\n    const localMin = layoutState.current.min ?? 0;\n\n    if (value < localMin) {\n      return localMin;\n    } else if (value > localMax) {\n      return localMax;\n    }\n\n    return value;\n  };\n\n  /*\n   * Считает отступ слоя галереи\n   */\n  const calculateIndent = (targetIndex: number) => {\n    if (layoutState.current.isFullyVisible) {\n      return 0;\n    }\n\n    const targetSlide = layoutState.current.slides?.length\n      ? layoutState.current.slides[targetIndex]\n      : null;\n\n    if (targetSlide) {\n      const { coordX, width } = targetSlide;\n\n      if (isCenterWithCustomWidth) {\n        const viewportWidth = layoutState.current.viewportOffsetWidth ?? 0;\n        return viewportWidth / 2 - coordX - width / 2;\n      }\n\n      return validateIndent(-1 * coordX);\n    }\n\n    return 0;\n  };\n\n  /*\n   * Считает отступ слоя галереи во время драга\n   */\n  const calculateDragIndent = () => {\n    const localMax = layoutState.current.max ?? 0;\n    const localMin = layoutState.current.min ?? 0;\n    const indent = shiftState.shiftX + shiftState.deltaX;\n\n    if (indent > localMax) {\n      return localMax + Number((indent - localMax) / 3);\n    } else if (indent < localMin) {\n      return localMin + Number((indent - localMin) / 3);\n    }\n\n    return indent;\n  };\n\n  const initializeSlides = (options: { animation?: boolean } = {}) => {\n    const localSlides =\n      React.Children.map(\n        children,\n        (_item: React.ReactNode, i: number): GallerySlidesState => {\n          const elem = slidesStore.current[`slide-${i}`];\n          return {\n            coordX: elem?.offsetLeft ?? 0,\n            width: elem?.offsetWidth ?? 0,\n          };\n        }\n      ) ?? [];\n\n    const localContainerWidth = rootRef.current?.offsetWidth ?? 0;\n    const localViewportOffsetWidth = viewportRef.current?.offsetWidth ?? 0;\n    const localLayerWidth = localSlides.reduce(\n      (val: number, slide: GallerySlidesState) => slide.width + val,\n      0\n    );\n    const adjustShiftX =\n      localSlides.length <= layoutState.current.slides.length ||\n      layoutState.current.slides[slideIndex]?.coordX !==\n        localSlides[slideIndex]?.coordX;\n\n    layoutState.current = {\n      containerWidth: localContainerWidth,\n      viewportOffsetWidth: localViewportOffsetWidth,\n      layerWidth: localLayerWidth,\n      max: calcMax({\n        slides: localSlides,\n        viewportOffsetWidth: localViewportOffsetWidth,\n        isCenterWithCustomWidth,\n      }),\n      min: calcMin({\n        containerWidth: localContainerWidth,\n        layerWidth: localLayerWidth,\n        slides: localSlides,\n        viewportOffsetWidth: localViewportOffsetWidth,\n        isCenterWithCustomWidth,\n        align,\n      }),\n      slides: localSlides,\n      isFullyVisible: localLayerWidth <= localContainerWidth,\n    };\n\n    setShiftState((prevState) => ({\n      ...prevState,\n      shiftX: adjustShiftX ? calculateIndent(slideIndex) : prevState.shiftX,\n      animation:\n        options.animation ??\n        prevState.shiftX === validateIndent(prevState.shiftX),\n    }));\n  };\n\n  const onResize = () => {\n    if (shiftState.animation !== undefined) {\n      initializeSlides({ animation: false });\n    }\n  };\n\n  useGlobalEventListener(window, \"resize\", onResize);\n\n  useIsomorphicLayoutEffect(() => {\n    initializeSlides({ animation: false });\n  }, [children, align, slideWidth]);\n\n  useIsomorphicLayoutEffect(() => {\n    if (shiftState.animation !== undefined) {\n      setShiftState((prevState) => ({\n        ...prevState,\n        animation: true,\n        deltaX: 0,\n        shiftX: calculateIndent(slideIndex ?? 0),\n      }));\n    }\n  }, [slideIndex]);\n\n  const slideLeft = (event: React.MouseEvent) => {\n    onChange?.(slideIndex - 1);\n    onPrevClick?.(event);\n  };\n\n  const slideRight = (event: React.MouseEvent) => {\n    onChange?.(slideIndex + 1);\n    onNextClick?.(event);\n  };\n\n  /*\n   * Получает индекс слайда, к которому будет осуществлен переход\n   */\n  const getTarget = (e: TouchEvent) => {\n    const expectDeltaX = (shiftState.deltaX / e.duration) * 240 * 0.6;\n    const shift =\n      shiftState.shiftX +\n      shiftState.deltaX +\n      expectDeltaX -\n      (layoutState.current.max ?? 0);\n    const direction = shiftState.deltaX < 0 ? 1 : -1;\n\n    // Находим ближайшую границу слайда к текущему отступу\n    let targetIndex = layoutState.current.slides.reduce(\n      (val: number, item: GallerySlidesState, index: number) => {\n        const previousValue = Math.abs(\n          layoutState.current.slides[val].coordX + shift\n        );\n        const currentValue = Math.abs(item.coordX + shift);\n\n        return previousValue < currentValue ? val : index;\n      },\n      slideIndex\n    );\n\n    if (targetIndex === slideIndex) {\n      let targetSlide = slideIndex + direction;\n\n      if (targetSlide >= 0 && targetSlide < layoutState.current.slides.length) {\n        if (\n          Math.abs(shiftState.deltaX) >\n          layoutState.current.slides[targetSlide].width * 0.05\n        ) {\n          targetIndex = targetSlide;\n        }\n      }\n    }\n\n    return targetIndex;\n  };\n\n  const onStart = () => {\n    setShiftState((prevState) => ({ ...prevState, animation: false }));\n  };\n\n  const onMoveX = (e: TouchEvent) => {\n    if (isDraggableProp && !layoutState.current.isFullyVisible) {\n      e.originalEvent.preventDefault();\n\n      if (e.isSlideX) {\n        // TODO исправить в рамках issue #2698\n        onDragStart?.(e);\n\n        if (shiftState.deltaX !== e.shiftX) {\n          setShiftState((prevState) => ({\n            ...prevState,\n            deltaX: e.shiftX,\n            dragging: e.isSlideX,\n          }));\n        }\n      }\n    }\n  };\n\n  const onEnd = (e: TouchEvent) => {\n    const targetIndex = e.isSlide ? getTarget(e) : slideIndex ?? 0;\n    onDragEnd?.(e);\n\n    const nextShiftState: Partial<ShiftingState> = {\n      animation: true,\n      dragging: false,\n      deltaX: 0,\n    };\n\n    const shiftXStick = calculateDragIndent();\n    if (targetIndex !== slideIndex) {\n      // Сохраняем сдвиг слайда в том положении, в каком его оставили после драга (fix issue #2185)\n      nextShiftState.shiftX = shiftXStick;\n    }\n\n    setShiftState((prevState) => ({ ...prevState, ...nextShiftState }));\n    if (targetIndex !== slideIndex) {\n      onChange?.(targetIndex);\n    }\n\n    // TODO исправить в рамках issue #2698\n    onEndProp?.({ targetIndex });\n  };\n\n  const indent = shiftState.dragging\n    ? calculateDragIndent()\n    : shiftState.shiftX;\n\n  const layerStyle = {\n    WebkitTransform: `translateX(${indent}px)`,\n    transform: `translateX(${indent}px)`,\n    WebkitTransition: shiftState.animation\n      ? `-webkit-transform ${ANIMATION_DURATION}s cubic-bezier(.1, 0, .25, 1)`\n      : \"none\",\n    transition: shiftState.animation\n      ? `transform ${ANIMATION_DURATION}s cubic-bezier(.1, 0, .25, 1)`\n      : \"none\",\n  };\n\n  const setSlideRef = (slideRef: HTMLDivElement | null, slideIndex: number) => {\n    slidesStore.current[`slide-${slideIndex}`] = slideRef;\n  };\n\n  // shiftX is negative number <= 0, we can swipe back only if it is < 0\n  const canSlideLeft =\n    !layoutState.current.isFullyVisible && shiftState.shiftX < 0;\n\n  const canSlideRight =\n    !layoutState.current.isFullyVisible &&\n    // we can't move right when gallery layer fully scrolled right, if gallery aligned by left side\n    ((align === \"left\" &&\n      layoutState.current.containerWidth - shiftState.shiftX <\n        (layoutState.current.layerWidth ?? 0)) ||\n      // otherwise we need to check current slide index (align = right or align = center)\n      (align !== \"left\" && slideIndex < layoutState.current.slides.length - 1));\n\n  const isDraggable = isDraggableProp && !layoutState.current.isFullyVisible;\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        \"Gallery\",\n        `Gallery--${align}`,\n        shiftState.dragging && \"Gallery--dragging\",\n        isDraggable && \"Gallery--draggable\",\n        slideWidth === \"custom\" && \"Gallery--custom-width\"\n      )}\n      ref={rootRef}\n    >\n      <Touch\n        vkuiClass=\"Gallery__viewport\"\n        onStartX={onStart}\n        onMoveX={onMoveX}\n        onEnd={onEnd}\n        style={{ width: slideWidth === \"custom\" ? \"100%\" : slideWidth }}\n        getRootRef={viewportRef}\n        noSlideClick\n      >\n        <div vkuiClass=\"Gallery__layer\" style={layerStyle}>\n          {React.Children.map(children, (item: React.ReactNode, i: number) => (\n            <div\n              vkuiClass=\"Gallery__slide\"\n              key={`slide-${i}`}\n              ref={(el) => setSlideRef(el, i)}\n            >\n              {item}\n            </div>\n          ))}\n        </div>\n      </Touch>\n\n      {bullets && (\n        <div\n          aria-hidden=\"true\"\n          vkuiClass={classNames(\n            \"Gallery__bullets\",\n            `Gallery__bullets--${bullets}`\n          )}\n        >\n          {React.Children.map(\n            children,\n            (_item: React.ReactNode, index: number) => (\n              <div\n                vkuiClass={classNames(\n                  \"Gallery__bullet\",\n                  index === slideIndex && \"Gallery__bullet--active\"\n                )}\n                key={index}\n              />\n            )\n          )}\n        </div>\n      )}\n\n      {showArrows && hasMouse && canSlideLeft && (\n        <HorizontalScrollArrow\n          direction=\"left\"\n          onClick={slideLeft}\n          size={arrowSize}\n        />\n      )}\n      {showArrows && hasMouse && canSlideRight && (\n        <HorizontalScrollArrow\n          direction=\"right\"\n          onClick={slideRight}\n          size={arrowSize}\n        />\n      )}\n    </div>\n  );\n};\n"],"file":"BaseGallery.js"}