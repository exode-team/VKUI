{"version":3,"file":"Cell.js","names":["React","classNames","noop","warnOnce","IOS","SimpleCell","Removable","usePlatform","useExternRef","useDraggable","ListContext","CellDragger","CellCheckbox","warn","Cell","propsMode","mode","onRemove","removePlaceholder","onDragFinish","before","after","disabled","deprecatedRemovable","removable","draggable","deprecatedSelectable","selectable","Component","onChange","name","value","checked","defaultChecked","getRootRef","draggerLabel","className","style","restProps","process","env","NODE_ENV","platform","rootElRef","dragging","draggableProps","useContext","toggleDrag","useEffect","undefined","dragger","checkbox","checkboxProps","simpleCellDisabled","hasActive","cellClasses","simpleCell","e","current"],"sources":["../../../../src/components/Cell/Cell.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { noop } from \"../../lib/utils\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { IOS } from \"../../lib/platform\";\nimport { SimpleCell, SimpleCellProps } from \"../SimpleCell/SimpleCell\";\nimport { HasPlatform, HasRootRef } from \"../../types\";\nimport { Removable, RemovableProps } from \"../Removable/Removable\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { useDraggable } from \"./useDraggable\";\nimport { ListContext } from \"../List/ListContext\";\nimport { CellDragger } from \"./CellDragger/CellDragger\";\nimport { CellCheckbox, CellCheckboxProps } from \"./CellCheckbox/CellCheckbox\";\nimport \"./Cell.css\";\n\nexport interface CellProps\n  extends Omit<SimpleCellProps, \"getRootRef\">,\n    HasPlatform,\n    RemovableProps,\n    HasRootRef<HTMLDivElement> {\n  mode?: \"removable\" | \"selectable\";\n  /**\n   * В режиме перетаскивания ячейка перестает быть кликабельной, то есть при клике переданный onClick вызываться не будет\n   */\n  draggable?: boolean;\n  /**\n   * @deprecated Будет удалено в 5.0.0. Используйте mode=\"removable\"\n   */\n  removable?: boolean;\n  /**\n   * Имя для input в режиме selectable\n   */\n  name?: string;\n  /**\n   * @deprecated Будет удалено в 5.0.0. Используйте mode=\"selectable\"\n   */\n  selectable?: boolean;\n  /**\n   * В режиме selectable реагирует на входящие значения пропса checked, как зависящий напрямую от входящего значения\n   */\n  checked?: boolean;\n  /**\n   * В режиме selectable реагирует на входящие значения пропса defaultChecked как неконтролируемый компонент\n   */\n  defaultChecked?: boolean;\n  /**\n   * Коллбэк срабатывает при завершении перетаскивания.\n   * **Важно:** режим перетаскивания не меняет порядок ячеек в DOM. В коллбэке есть объект с полями `from` и `to`.\n   * Эти числа нужны для того, чтобы разработчик понимал, с какого индекса на какой произошел переход. В песочнице\n   * есть рабочий пример с обработкой этих чисел и перерисовкой списка.\n   */\n  onDragFinish?: ({ from, to }: { from: number; to: number }) => void;\n  /**\n   * aria-label для кнопки перетаскивания ячейки\n   */\n  draggerLabel?: string;\n}\n\nconst warn = warnOnce(\"Cell\");\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Cell\n */\nexport const Cell = ({\n  mode: propsMode, // TODO: убрать переименование в propsMode перед 5.0.0\n  onRemove = noop,\n  removePlaceholder = \"Удалить\",\n  onDragFinish,\n  before,\n  after,\n  disabled,\n  removable: deprecatedRemovable, // TODO: удалить перед 5.0.0\n  draggable,\n  selectable: deprecatedSelectable, // TODO: удалить перед 5.0.0\n  Component,\n  onChange,\n  name,\n  value,\n  checked,\n  defaultChecked,\n  getRootRef,\n  draggerLabel = \"Перенести ячейку\",\n  className,\n  style,\n  ...restProps\n}: CellProps) => {\n  // TODO: удалить перед 5.0.0\n  let mode: CellProps[\"mode\"] = propsMode;\n\n  if (!propsMode && (deprecatedSelectable || deprecatedRemovable)) {\n    mode = deprecatedSelectable ? \"selectable\" : \"removable\";\n\n    if (process.env.NODE_ENV === \"development\") {\n      deprecatedSelectable &&\n        warn(\n          'Свойство selectable устарело и будет удалено в 5.0.0. Используйте mode=\"selectable\".'\n        );\n      deprecatedRemovable &&\n        warn(\n          'Свойство removable устарело и будет удалено в 5.0.0. Используйте mode=\"removable\".'\n        );\n    }\n  }\n  // /end TODO\n\n  const selectable = mode === \"selectable\";\n  const removable = mode === \"removable\";\n\n  const platform = usePlatform();\n\n  const rootElRef = useExternRef(getRootRef);\n\n  const { dragging, ...draggableProps } = useDraggable({\n    rootElRef,\n    onDragFinish,\n  });\n\n  const { toggleDrag } = React.useContext(ListContext);\n  React.useEffect(() => {\n    if (dragging) {\n      toggleDrag(true);\n      return () => toggleDrag(false);\n    }\n    return undefined;\n  }, [dragging, toggleDrag]);\n\n  let dragger;\n  if (draggable) {\n    dragger = (\n      <CellDragger\n        vkuiClass=\"Cell__dragger\"\n        aria-label={draggerLabel}\n        {...draggableProps}\n      />\n    );\n  }\n\n  let checkbox;\n  if (selectable) {\n    const checkboxProps: CellCheckboxProps = {\n      name,\n      value,\n      onChange,\n      defaultChecked,\n      checked,\n      disabled,\n    };\n    checkbox = <CellCheckbox vkuiClass=\"Cell__checkbox\" {...checkboxProps} />;\n  }\n\n  const simpleCellDisabled =\n    (draggable && !selectable) || removable || disabled;\n  const hasActive = !simpleCellDisabled && !dragging;\n\n  const cellClasses = classNames(\n    \"Cell\",\n    platform === IOS && \"Cell--ios\",\n    dragging && \"Cell--dragging\",\n    removable && \"Cell--removable\",\n    selectable && \"Cell--selectable\",\n    disabled && \"Cell--disabled\"\n  );\n\n  const simpleCell = (\n    <SimpleCell\n      hasActive={hasActive}\n      hasHover={hasActive}\n      {...restProps}\n      vkuiClass=\"Cell__content\"\n      disabled={simpleCellDisabled}\n      Component={selectable ? \"label\" : Component}\n      before={\n        <React.Fragment>\n          {draggable && platform !== IOS && dragger}\n          {selectable && checkbox}\n          {before}\n        </React.Fragment>\n      }\n      after={\n        <React.Fragment>\n          {draggable && platform === IOS && dragger}\n          {after}\n        </React.Fragment>\n      }\n    />\n  );\n\n  if (removable) {\n    return (\n      <Removable\n        vkuiClass={cellClasses}\n        className={className}\n        style={style}\n        getRootRef={rootElRef}\n        removePlaceholder={removePlaceholder}\n        onRemove={(e) => onRemove(e, rootElRef.current)}\n      >\n        {simpleCell}\n      </Removable>\n    );\n  }\n\n  return (\n    <div\n      vkuiClass={cellClasses}\n      className={className}\n      style={style}\n      ref={rootElRef}\n    >\n      {simpleCell}\n    </div>\n  );\n};\n"],"mappings":"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"}