{"version":3,"sources":["../../../../src/components/Calendar/Calendar.tsx"],"names":["React","isSameMonth","isSameDay","CalendarHeader","CalendarDays","CalendarTime","useIsomorphicLayoutEffect","navigateDate","setTimeEqual","isFirstDay","isLastDay","useCalendar","classNames","warnOnce","warn","Calendar","value","onChange","disablePast","disableFuture","shouldDisableDate","onClose","enableTime","doneButtonText","weekStartsOn","getRootRef","disablePickers","changeHoursAriaLabel","changeMinutesAriaLabel","prevMonthAriaLabel","nextMonthAriaLabel","changeMonthAriaLabel","changeYearAriaLabel","showNeighboringMonth","changeDayAriaLabel","size","externalViewDate","viewDate","onHeaderChange","onNextMonth","onPrevMonth","prevMonthIcon","nextMonthIcon","prevMonthProps","nextMonthProps","dayProps","listenDayChangesForUpdate","props","setViewDate","setPrevMonth","setNextMonth","focusedDay","setFocusedDay","isDayFocused","isDayDisabled","resetSelectedDay","process","env","NODE_ENV","handleKeyDown","useCallback","event","includes","key","preventDefault","newFocusedDay","onDayChange","date","isDayActive","day","Boolean"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { isSameMonth, isSameDay } from \"../../lib/date\";\nimport {\n  CalendarHeader,\n  CalendarHeaderProps,\n} from \"../CalendarHeader/CalendarHeader\";\nimport { CalendarDays, CalendarDaysProps } from \"../CalendarDays/CalendarDays\";\nimport { CalendarTime, CalendarTimeProps } from \"../CalendarTime/CalendarTime\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport {\n  navigateDate,\n  setTimeEqual,\n  isFirstDay,\n  isLastDay,\n} from \"../../lib/calendar\";\nimport { useCalendar } from \"../../hooks/useCalendar\";\nimport { HasRootRef } from \"../../types\";\nimport { classNames } from \"../../lib/classNames\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport \"./Calendar.css\";\n\nexport interface CalendarProps\n  extends Omit<React.HTMLAttributes<HTMLDivElement>, \"onChange\">,\n    Pick<CalendarTimeProps, \"changeHoursAriaLabel\" | \"changeMinutesAriaLabel\">,\n    Pick<\n      CalendarHeaderProps,\n      | \"prevMonthAriaLabel\"\n      | \"nextMonthAriaLabel\"\n      | \"changeMonthAriaLabel\"\n      | \"changeYearAriaLabel\"\n      | \"onNextMonth\"\n      | \"onPrevMonth\"\n      | \"prevMonthIcon\"\n      | \"nextMonthIcon\"\n      | \"prevMonthProps\"\n      | \"nextMonthProps\"\n    >,\n    Pick<CalendarDaysProps, \"dayProps\" | \"listenDayChangesForUpdate\">,\n    HasRootRef<HTMLDivElement> {\n  value?: Date;\n  disablePast?: boolean;\n  disableFuture?: boolean;\n  enableTime?: boolean;\n  disablePickers?: boolean;\n  doneButtonText?: string;\n  changeDayAriaLabel?: string;\n  weekStartsOn?: 0 | 1 | 2 | 3 | 4 | 5 | 6;\n  showNeighboringMonth?: boolean;\n  size?: \"s\" | \"m\";\n  onChange?(value?: Date): void;\n  shouldDisableDate?(value: Date): boolean;\n  onClose?(): void;\n  /**\n   * Дата отображаемого месяца.\n   * При использовании обновление даты должно происходить вне компонента.\n   */\n  viewDate?: Date;\n  /**\n   * Изменение даты в шапке календаря.\n   */\n  onHeaderChange?(value: Date): void;\n}\n\nconst warn = warnOnce(\"Calendar\");\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Calendar\n */\nexport const Calendar = ({\n  value,\n  onChange,\n  disablePast,\n  disableFuture,\n  shouldDisableDate,\n  onClose,\n  enableTime = false,\n  doneButtonText,\n  weekStartsOn = 1,\n  getRootRef,\n  disablePickers,\n  changeHoursAriaLabel,\n  changeMinutesAriaLabel,\n  prevMonthAriaLabel,\n  nextMonthAriaLabel,\n  changeMonthAriaLabel,\n  changeYearAriaLabel,\n  showNeighboringMonth,\n  changeDayAriaLabel = \"Изменить день\",\n  size = \"m\",\n  viewDate: externalViewDate,\n  onHeaderChange,\n  onNextMonth,\n  onPrevMonth,\n  prevMonthIcon,\n  nextMonthIcon,\n  prevMonthProps,\n  nextMonthProps,\n  dayProps,\n  listenDayChangesForUpdate,\n  ...props\n}: CalendarProps) => {\n  const {\n    viewDate,\n    setViewDate,\n    setPrevMonth,\n    setNextMonth,\n    focusedDay,\n    setFocusedDay,\n    isDayFocused,\n    isDayDisabled,\n    resetSelectedDay,\n  } = useCalendar({\n    value,\n    disableFuture,\n    disablePast,\n    shouldDisableDate,\n    onHeaderChange,\n    onNextMonth,\n    onPrevMonth,\n  });\n\n  useIsomorphicLayoutEffect(() => {\n    if (value) {\n      setViewDate(value);\n    }\n  }, [value]);\n\n  if (\n    process.env.NODE_ENV === \"development\" &&\n    !disablePickers &&\n    size === \"s\"\n  ) {\n    warn(\n      \"Нельзя включить селекты выбора месяца/года, если размер календаря 's'\",\n      \"error\"\n    );\n  }\n\n  if (process.env.NODE_ENV === \"development\" && enableTime && size === \"s\") {\n    warn(\"Нельзя включить выбор времени, если размер календаря 's'\", \"error\");\n  }\n\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent) => {\n      if (\n        [\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\"].includes(event.key)\n      ) {\n        event.preventDefault();\n      }\n\n      const newFocusedDay = navigateDate(focusedDay ?? value, event.key);\n\n      if (newFocusedDay && !isSameMonth(newFocusedDay, viewDate)) {\n        setViewDate(newFocusedDay);\n      }\n      setFocusedDay(newFocusedDay);\n    },\n    [focusedDay, setFocusedDay, setViewDate, value, viewDate]\n  );\n\n  const onDayChange = React.useCallback(\n    (date: Date) => {\n      onChange?.(setTimeEqual(date, value as Date | undefined | null));\n    },\n    [value, onChange]\n  );\n\n  const isDayActive = React.useCallback(\n    (day: Date) => Boolean(value && isSameDay(day, value)),\n    [value]\n  );\n\n  return (\n    <div\n      {...props}\n      ref={getRootRef}\n      vkuiClass={classNames(\"Calendar\", `Calendar--size-${size}`)}\n    >\n      <CalendarHeader\n        viewDate={externalViewDate || viewDate}\n        onChange={setViewDate}\n        onNextMonth={setNextMonth}\n        onPrevMonth={setPrevMonth}\n        disablePickers={disablePickers || size === \"s\"}\n        vkuiClass=\"Calendar__header\"\n        prevMonthAriaLabel={prevMonthAriaLabel}\n        nextMonthAriaLabel={nextMonthAriaLabel}\n        changeMonthAriaLabel={changeMonthAriaLabel}\n        changeYearAriaLabel={changeYearAriaLabel}\n        prevMonthIcon={prevMonthIcon}\n        nextMonthIcon={nextMonthIcon}\n        prevMonthProps={prevMonthProps}\n        nextMonthProps={nextMonthProps}\n      />\n      <CalendarDays\n        viewDate={externalViewDate || viewDate}\n        value={value}\n        weekStartsOn={weekStartsOn}\n        isDayFocused={isDayFocused}\n        tabIndex={0}\n        aria-label={changeDayAriaLabel}\n        onKeyDown={handleKeyDown}\n        onDayChange={onDayChange}\n        isDayActive={isDayActive}\n        isDaySelectionStart={isFirstDay}\n        isDaySelectionEnd={isLastDay}\n        isDayDisabled={isDayDisabled}\n        onBlur={resetSelectedDay}\n        showNeighboringMonth={showNeighboringMonth}\n        size={size}\n        dayProps={dayProps}\n        listenDayChangesForUpdate={listenDayChangesForUpdate}\n      />\n      {enableTime && value && size !== \"s\" && (\n        <div vkuiClass=\"Calendar__time\">\n          <CalendarTime\n            value={value}\n            onChange={onChange}\n            onClose={onClose}\n            doneButtonText={doneButtonText}\n            changeHoursAriaLabel={changeHoursAriaLabel}\n            changeMinutesAriaLabel={changeMinutesAriaLabel}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n"],"file":"Calendar.js"}