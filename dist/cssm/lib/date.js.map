{"version":3,"sources":["../../../src/lib/date.ts"],"names":["dayjs","startOfDay","date","startOf","toDate","endOfDay","endOf","startOfWeek","weekStart","day","weekDay","diff","endOfWeek","startOfMonth","endOfMonth","isFirstDayOfMonth","isLastDayOfMonth","isSame","format","isBefore","date1","date2","isAfter","isSameDay","isSameMonth","isWithinInterval","start","end","setMinutes","minute","set","setHours","hour","setMonth","month","setYear","year","addDays","add","subDays","subtract","addWeeks","week","subWeeks","addMonths","subMonths","eachDayOfInterval","dates","startDate","endDate","endTime","getTime","currentDate","push","Date","setDate","getDate","parse","input","referenceDate","match2","match4","entries","val","numVal","okay","parseInt","superRegExp","RegExp","map","item","join","store","Y","getFullYear","M","getMonth","D","h","getHours","m","getMinutes","s","getSeconds","ms","getMilliseconds","prevInputIndex","lastNonFormatting","lastFormatIndex","found","match","exec","length","atIndex","lastIndex","find","slice","value","key","newValue","isMatch","isNaN"],"mappings":"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","sourcesContent":["import dayjs from \"dayjs\";\n\n// Using date-fns-like type for migration\ntype DirtyDate = Date | number;\n\nexport function startOfDay(date: DirtyDate) {\n  return dayjs(date).startOf(\"day\").toDate();\n}\n\nexport function endOfDay(date: DirtyDate) {\n  return dayjs(date).endOf(\"day\").toDate();\n}\n\nexport function startOfWeek(date: DirtyDate, weekStart = 0) {\n  weekStart = weekStart % 7;\n\n  const day = dayjs(date);\n  const weekDay = day.day();\n  const diff = (weekDay < weekStart ? 7 : 0) + weekDay - weekStart;\n\n  return day.date(day.date() - diff).toDate();\n}\n\nexport function endOfWeek(date: DirtyDate, weekStart = 0) {\n  const day = dayjs(startOfWeek(date, weekStart));\n\n  return day.date(day.date() + 6).toDate();\n}\n\nexport function startOfMonth(date: DirtyDate) {\n  return dayjs(date).startOf(\"month\").toDate();\n}\n\nexport function endOfMonth(date: DirtyDate) {\n  return dayjs(date).endOf(\"month\").toDate();\n}\n\nexport function isFirstDayOfMonth(date: DirtyDate) {\n  return dayjs(date).date() === 1;\n}\n\nexport function isLastDayOfMonth(date: DirtyDate) {\n  // isSameDay -- shorter, but not exact with date-fns behavior\n  // return isSameDay(date, dayjs(date).endOf(\"month\"));\n  return dayjs(date).endOf(\"day\").isSame(dayjs(date).endOf(\"month\"));\n}\n\nexport function format(date: DirtyDate, format: string) {\n  return dayjs(date).format(format);\n}\n\nexport function isBefore(date1: DirtyDate, date2: DirtyDate) {\n  // Exactly as date-fns does\n  // dayjs().isBefore() for slightly different approach\n  return dayjs(date1) < dayjs(date2);\n}\n\nexport function isAfter(date1: DirtyDate, date2: DirtyDate) {\n  return dayjs(date1) > dayjs(date2);\n}\n\nexport function isSameDay(date1: DirtyDate, date2: DirtyDate) {\n  return dayjs(date1).isSame(date2, \"day\");\n}\n\nexport function isSameMonth(date1: DirtyDate, date2: DirtyDate) {\n  return dayjs(date1).isSame(date2, \"month\");\n}\n\nexport function isWithinInterval(\n  date: DirtyDate,\n  start: DirtyDate,\n  end: DirtyDate\n) {\n  const day = dayjs(date);\n  return day >= dayjs(start) && day <= dayjs(end);\n}\n\nexport function setMinutes(date: DirtyDate, minute: number) {\n  return dayjs(date).set(\"minute\", minute).toDate();\n}\n\nexport function setHours(date: DirtyDate, hour: number) {\n  return dayjs(date).set(\"hour\", hour).toDate();\n}\n\nexport function setMonth(date: DirtyDate, month: number) {\n  return dayjs(date).set(\"month\", month).toDate();\n}\n\nexport function setYear(date: DirtyDate, year: number) {\n  return dayjs(date).set(\"year\", year).toDate();\n}\n\nexport function addDays(date: DirtyDate, day: number) {\n  return dayjs(date).add(day, \"day\").toDate();\n}\n\nexport function subDays(date: DirtyDate, day: number) {\n  return dayjs(date).subtract(day, \"day\").toDate();\n}\n\nexport function addWeeks(date: DirtyDate, week: number) {\n  return dayjs(date).add(week, \"week\").toDate();\n}\n\nexport function subWeeks(date: DirtyDate, week: number) {\n  return dayjs(date).subtract(week, \"week\").toDate();\n}\n\nexport function addMonths(date: DirtyDate, month: number) {\n  return dayjs(date).add(month, \"month\").toDate();\n}\n\nexport function subMonths(date: DirtyDate, month: number) {\n  return dayjs(date).subtract(month, \"month\").toDate();\n}\n\n// Rip off date-fns\nexport function eachDayOfInterval(start: DirtyDate, end: DirtyDate) {\n  const dates: Date[] = [];\n  const startDate = dayjs(start).toDate();\n  const endDate = dayjs(end).toDate();\n\n  const endTime = endDate.getTime();\n  const currentDate = startDate;\n  currentDate.setHours(0, 0, 0, 0);\n\n  while (currentDate.getTime() <= endTime) {\n    dates.push(new Date(currentDate.getTime()));\n    currentDate.setDate(currentDate.getDate() + 1);\n    currentDate.setHours(0, 0, 0, 0);\n  }\n\n  return dates;\n}\n\nexport function parse(\n  input: string,\n  format: string,\n  referenceDate: Date = new Date()\n) {\n  const match2 = /^\\d\\d/; // 00 - 99\n  const match4 = /^\\d{4}/; // 0000 - 9999\n\n  const entries: Array<\n    [string, RegExp, (val: string) => [string, number, boolean]]\n  > = [\n    [\"YYYY\", match4, (val) => [\"Y\", +val, true]],\n    [\n      \"MM\",\n      match2,\n      (val) => {\n        const numVal = +val;\n        const okay = numVal > 0 && numVal <= 12;\n\n        return [\"M\", numVal - 1, okay];\n      },\n    ],\n    [\"DD\", match2, (val) => [\"D\", +val, true]],\n    [\n      \"HH\",\n      match2,\n      (val) => {\n        const numVal = parseInt(val, 10);\n        const okay = numVal >= 0 && numVal < 24;\n\n        return [\"h\", numVal, okay];\n      },\n    ],\n    [\n      \"mm\",\n      match2,\n      (val) => {\n        const numVal = parseInt(val, 10);\n        const okay = numVal >= 0 && numVal < 60;\n\n        return [\"m\", numVal, okay];\n      },\n    ],\n  ];\n\n  const superRegExp = new RegExp(entries.map((item) => item[0]).join(\"|\"), \"g\");\n\n  const store: {\n    [key: string]: number;\n  } = {\n    Y: referenceDate.getFullYear(),\n    M: referenceDate.getMonth(),\n    D: referenceDate.getDate(),\n    h: referenceDate.getHours(),\n    m: referenceDate.getMinutes(),\n    s: referenceDate.getSeconds(),\n    ms: referenceDate.getMilliseconds(),\n  };\n\n  let prevInputIndex = 0;\n  let lastNonFormatting = \"\";\n  let lastFormatIndex = 0;\n  let found = false;\n\n  while (true) {\n    const match = superRegExp.exec(format);\n\n    if (!match) {\n      break;\n    }\n\n    const length = match[0].length;\n    const atIndex = superRegExp.lastIndex - length;\n\n    const item = entries.find((item) => item[0] === match[0]);\n\n    if (!item) {\n      return new Date(\"\");\n    }\n\n    lastNonFormatting = format.slice(lastFormatIndex, atIndex);\n    lastFormatIndex = superRegExp.lastIndex;\n\n    if (\n      input.slice(prevInputIndex, prevInputIndex + lastNonFormatting.length) !==\n      lastNonFormatting\n    ) {\n      return new Date(\"\");\n    }\n\n    const value = input\n      .slice(prevInputIndex + lastNonFormatting.length)\n      .match(item[1]);\n\n    if (!value) {\n      return new Date(\"\");\n    }\n\n    prevInputIndex =\n      prevInputIndex + lastNonFormatting.length + value[0].length;\n\n    const [key, newValue, okay] = item[2](value[0]);\n\n    if (!okay) {\n      return new Date(\"\");\n    }\n\n    store[key] = newValue;\n    found = true;\n  }\n\n  if (!found) {\n    return new Date(\"\");\n  }\n\n  const date = new Date(\n    store.Y,\n    store.M,\n    store.D,\n    store.h,\n    store.m,\n    store.s,\n    store.ms\n  );\n\n  // Since days of months are dynamic, they can't be validated in entries,\n  // so we check it here, in the finalized date\n  if (date.getMonth() !== store.M || date.getDate() !== store.D) {\n    return new Date(\"\");\n  }\n\n  return date;\n}\n\nexport function isMatch(input: string, format: string) {\n  return !isNaN(+parse(input, format));\n}\n"],"file":"date.js"}