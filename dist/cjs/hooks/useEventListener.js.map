{"version":3,"file":"useEventListener.js","names":["useEventListener","event","_cb","_options","cbRef","React","useRef","useIsomorphicLayoutEffect","current","cb","useCallback","e","detach","noop","remove","add","el","canUseDOM","options","addEventListener","removeEventListener","useEffect"],"sources":["../../../src/hooks/useEventListener.ts"],"sourcesContent":["import * as React from \"react\";\nimport { noop } from \"../lib/utils\";\nimport { canUseDOM } from \"../lib/dom\";\nimport { useIsomorphicLayoutEffect } from \"../lib/useIsomorphicLayoutEffect\";\n\ninterface EventListenerHandle {\n  add: (el: HTMLElement | Document | Window) => void;\n  remove: () => void;\n}\n\nexport function useEventListener<K extends keyof GlobalEventHandlersEventMap>(\n  event: K,\n  _cb:\n    | false\n    | null\n    | undefined\n    | ((ev: GlobalEventHandlersEventMap[K]) => void),\n  _options?: AddEventListenerOptions\n): EventListenerHandle;\nexport function useEventListener<E extends Event>(\n  event: string,\n  _cb: false | null | undefined | ((ev: E) => void),\n  _options?: AddEventListenerOptions\n): EventListenerHandle;\nexport function useEventListener<\n  E extends Event,\n  K extends keyof GlobalEventHandlersEventMap\n>(\n  event: string | K,\n  _cb: false | null | undefined | ((ev: E) => void),\n  _options?: AddEventListenerOptions\n): EventListenerHandle {\n  const cbRef = React.useRef(_cb);\n  useIsomorphicLayoutEffect(() => {\n    cbRef.current = _cb;\n  }, [_cb]);\n  const cb = React.useCallback(\n    (e: any) => cbRef.current && cbRef.current(e),\n    []\n  );\n\n  const detach = React.useRef(noop);\n  const remove = React.useCallback(() => {\n    detach.current();\n    detach.current = noop;\n  }, []);\n  const add = React.useCallback(\n    (el: HTMLElement | Document | Window) => {\n      if (!canUseDOM) {\n        return;\n      }\n      remove();\n      if (!el) {\n        return;\n      }\n      const options = { ..._options };\n      el.addEventListener(event, cb, options);\n      detach.current = () => el.removeEventListener(event, cb, options);\n    },\n    [_options, cb, event, remove]\n  );\n  React.useEffect(() => remove, [remove]);\n\n  return { add, remove };\n}\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AAqBO,SAASA,gBAAgB,CAI9BC,KAAiB,EACjBC,GAAiD,EACjDC,QAAkC,EACb;EACrB,IAAMC,KAAK,GAAGC,KAAK,CAACC,MAAM,CAACJ,GAAG,CAAC;EAC/B,IAAAK,oDAAyB,EAAC,YAAM;IAC9BH,KAAK,CAACI,OAAO,GAAGN,GAAG;EACrB,CAAC,EAAE,CAACA,GAAG,CAAC,CAAC;EACT,IAAMO,EAAE,GAAGJ,KAAK,CAACK,WAAW,CAC1B,UAACC,CAAM;IAAA,OAAKP,KAAK,CAACI,OAAO,IAAIJ,KAAK,CAACI,OAAO,CAACG,CAAC,CAAC;EAAA,GAC7C,EAAE,CACH;EAED,IAAMC,MAAM,GAAGP,KAAK,CAACC,MAAM,CAACO,WAAI,CAAC;EACjC,IAAMC,MAAM,GAAGT,KAAK,CAACK,WAAW,CAAC,YAAM;IACrCE,MAAM,CAACJ,OAAO,EAAE;IAChBI,MAAM,CAACJ,OAAO,GAAGK,WAAI;EACvB,CAAC,EAAE,EAAE,CAAC;EACN,IAAME,GAAG,GAAGV,KAAK,CAACK,WAAW,CAC3B,UAACM,EAAmC,EAAK;IACvC,IAAI,CAACC,cAAS,EAAE;MACd;IACF;IACAH,MAAM,EAAE;IACR,IAAI,CAACE,EAAE,EAAE;MACP;IACF;IACA,IAAME,OAAO,mCAAQf,QAAQ,CAAE;IAC/Ba,EAAE,CAACG,gBAAgB,CAAClB,KAAK,EAAEQ,EAAE,EAAES,OAAO,CAAC;IACvCN,MAAM,CAACJ,OAAO,GAAG;MAAA,OAAMQ,EAAE,CAACI,mBAAmB,CAACnB,KAAK,EAAEQ,EAAE,EAAES,OAAO,CAAC;IAAA;EACnE,CAAC,EACD,CAACf,QAAQ,EAAEM,EAAE,EAAER,KAAK,EAAEa,MAAM,CAAC,CAC9B;EACDT,KAAK,CAACgB,SAAS,CAAC;IAAA,OAAMP,MAAM;EAAA,GAAE,CAACA,MAAM,CAAC,CAAC;EAEvC,OAAO;IAAEC,GAAG,EAAHA,GAAG;IAAED,MAAM,EAANA;EAAO,CAAC;AACxB"}