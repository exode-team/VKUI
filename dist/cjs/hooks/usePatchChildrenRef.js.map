{"version":3,"file":"usePatchChildrenRef.js","names":["isDOMTypeElement","element","type","warn","warnOnce","usePatchChildrenRef","children","childRef","React","isValidElement","ref","props","getRootRef","patchedRef","useExternRef","useEffect","current","process","env","NODE_ENV","cloneElement"],"sources":["../../../src/hooks/usePatchChildrenRef.ts"],"sourcesContent":["import * as React from \"react\";\nimport { useExternRef } from \"./useExternRef\";\nimport { warnOnce } from \"../lib/warnOnce\";\n\ntype ChildrenElement<T> = React.ReactElement<{ getRootRef?: React.Ref<T> }>;\n\nconst isDOMTypeElement = (\n  element: React.ReactElement\n): element is React.DOMElement<any, any> => {\n  return typeof element.type === \"string\";\n};\n\nconst warn = warnOnce(\"usePatchChildrenRef\");\nexport const usePatchChildrenRef = <T = HTMLElement>(\n  children?: ChildrenElement<T>\n): [React.MutableRefObject<T | null>, ChildrenElement<T> | undefined] => {\n  const childRef =\n    React.isValidElement(children) &&\n    (isDOMTypeElement(children)\n      ? (children.ref as React.Ref<T>)\n      : children.props.getRootRef);\n  const patchedRef = useExternRef<T>(childRef);\n  React.useEffect(() => {\n    if (!patchedRef.current && process.env.NODE_ENV === \"development\") {\n      warn(\n        \"Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента\",\n        \"error\"\n      );\n    }\n  }, [children?.type, patchedRef]);\n  return [\n    patchedRef,\n    React.isValidElement(children)\n      ? React.cloneElement(children, {\n          [isDOMTypeElement(children) ? \"ref\" : \"getRootRef\"]: patchedRef,\n        })\n      : children,\n  ];\n};\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AAIA,IAAMA,gBAAgB,GAAG,SAAnBA,gBAAgB,CACpBC,OAA2B,EACe;EAC1C,OAAO,OAAOA,OAAO,CAACC,IAAI,KAAK,QAAQ;AACzC,CAAC;AAED,IAAMC,IAAI,GAAG,IAAAC,kBAAQ,EAAC,qBAAqB,CAAC;AACrC,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmB,CAC9BC,QAA6B,EAC0C;EACvE,IAAMC,QAAQ,GACZ,aAAAC,KAAK,CAACC,cAAc,CAACH,QAAQ,CAAC,KAC7BN,gBAAgB,CAACM,QAAQ,CAAC,GACtBA,QAAQ,CAACI,GAAG,GACbJ,QAAQ,CAACK,KAAK,CAACC,UAAU,CAAC;EAChC,IAAMC,UAAU,GAAG,IAAAC,0BAAY,EAAIP,QAAQ,CAAC;EAC5CC,KAAK,CAACO,SAAS,CAAC,YAAM;IACpB,IAAI,CAACF,UAAU,CAACG,OAAO,IAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,EAAE;MACjEhB,IAAI,CACF,0JAA0J,EAC1J,OAAO,CACR;IACH;EACF,CAAC,EAAE,CAACG,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEJ,IAAI,EAAEW,UAAU,CAAC,CAAC;EAChC,OAAO,CACLA,UAAU,EACV,aAAAL,KAAK,CAACC,cAAc,CAACH,QAAQ,CAAC,gBAC1BE,KAAK,CAACY,YAAY,CAACd,QAAQ,oCACxBN,gBAAgB,CAACM,QAAQ,CAAC,GAAG,KAAK,GAAG,YAAY,EAAGO,UAAU,EAC/D,GACFP,QAAQ,CACb;AACH,CAAC;AAAC"}