{"version":3,"sources":["../../../../src/components/View/View.tsx"],"names":["SwipeBackResults","scrollsCache","warn","View","popout","modal","activePanelProp","activePanel","history","nav","onTransition","onSwipeBack","onSwipeBackStart","onSwipeBackCancelProp","onSwipeBackCancel","children","restProps","process","env","NODE_ENV","scrolls","React","useRef","id","afterTransition","noop","useEffect","current","panelNodes","window","document","scroll","configProvider","splitCol","platform","useState","animated","setAnimated","visiblePanels","setVisiblePanels","setActivePanel","undefined","isBack","setIsBack","prevPanel","setPrevPanel","nextPanel","setNextPanel","swipingBack","setSwipingBack","swipeBackStartX","setSwipeBackStartX","swipeBackShift","setSwipeBackShift","swipeBackNextPanel","setSwipeBackNextPanel","swipeBackPrevPanel","setSwipeBackPrevPanel","swipeBackResult","setSwipeBackResult","browserSwipe","setBrowserSwipe","prevActivePanel","prevSwipingBack","prevBrowserSwipe","prevSwipeBackResult","prevSwipeBackPrevPanel","prevOnTransition","hasPopout","hasModal","panels","Children","toArray","filter","panel","panelId","props","includes","disableAnimation","transitionMotionEnabled","animate","pickPanel","flushTransition","useCallback","isBackTransition","scrollTo","from","to","transitionEndHandler","e","animationName","Boolean","waitTransitionFinish","animationFinishTimeout","IOS","onSwipeBackSuccess","swipingBackTransitionEndHandler","propertyName","target","fail","success","onMoveX","isWebView","startX","innerWidth","length","getScroll","y","slice","shiftX","onEnd","speed","duration","calcPanelSwipeStyles","canUseDOM","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","firstLayerId","map","find","animationEvent","supported","set","isTransitionTarget","compensateScroll","el","marginTop"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { animationEvent } from \"../../lib/supportEvents\";\nimport { IOS } from \"../../lib/platform\";\nimport { Touch, TouchEvent } from \"../Touch/Touch\";\nimport { useConfigProvider } from \"../ConfigProvider/ConfigProviderContext\";\nimport { useSplitCol } from \"../SplitCol/SplitCol\";\nimport { AppRootPortal } from \"../AppRoot/AppRootPortal\";\nimport { canUseDOM, useDOM, blurActiveElement } from \"../../lib/dom\";\nimport { useScroll } from \"../AppRoot/ScrollContext\";\nimport { NavTransitionProvider } from \"../NavTransitionContext/NavTransitionContext\";\nimport { getNavId, NavIdProps } from \"../../lib/getNavId\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { swipeBackExcluded } from \"./utils\";\nimport { useWaitTransitionFinish } from \"../../hooks/useWaitTransitionFinish\";\nimport { useTimeout } from \"../../hooks/useTimeout\";\nimport { usePrevious } from \"../../hooks/usePrevious\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { noop } from \"../../lib/utils\";\nimport \"./View.css\";\n\nenum SwipeBackResults {\n  fail = 1,\n  success,\n}\n\ninterface Scrolls {\n  [index: string]: number | undefined;\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\nexport let scrollsCache: ViewsScrolls = {};\n\nexport interface ViewProps\n  extends React.HTMLAttributes<HTMLElement>,\n    NavIdProps {\n  activePanel: string;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `Alert`, `ActionSheet` и `ScreenSpinner`.\n   */\n  popout?: React.ReactNode;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `ModalRoot`.\n   */\n  modal?: React.ReactNode;\n  onTransition?(params: { isBack: boolean; from: string; to: string }): void;\n  /**\n   * callback свайпа назад\n   */\n  onSwipeBack?(): void;\n  /**\n   * callback начала анимации свайпа назад.\n   */\n  onSwipeBackStart?(): void;\n  /**\n   * callback завершения анимации отмененного пользователем свайпа\n   */\n  onSwipeBackCancel?(): void;\n  history?: string[];\n}\n\nexport interface ViewState {\n  animated: boolean;\n\n  visiblePanels: string[];\n  activePanel: string | null;\n  isBack: boolean | undefined;\n  prevPanel: string | null;\n  nextPanel: string | null;\n\n  swipingBack: boolean;\n  swipeBackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string | null;\n  swipeBackPrevPanel: string | null;\n  swipeBackResult: SwipeBackResults | null;\n\n  browserSwipe: boolean;\n}\n\nconst warn = warnOnce(\"View\");\n\n/**\n * @see https://vkcom.github.io/VKUI/#/View\n */\nexport const View = ({\n  popout,\n  modal,\n  activePanel: activePanelProp,\n  history,\n  nav,\n  onTransition,\n  onSwipeBack,\n  onSwipeBackStart,\n  onSwipeBackCancel: onSwipeBackCancelProp,\n  children,\n\n  ...restProps\n}: ViewProps) => {\n  if (process.env.NODE_ENV === \"development\") {\n    popout &&\n      warn(\n        \"Свойство popout устарело и будет удалено в 5.0.0. Используйте одноименное свойство у SplitLayout.\"\n      );\n    modal &&\n      warn(\n        \"Свойство modal устарело и будет удалено в 5.0.0. Используйте одноименное свойство у SplitLayout.\"\n      );\n  }\n\n  const scrolls = React.useRef(\n    scrollsCache[getNavId({ nav, id: restProps.id }) as string] || {}\n  );\n  const afterTransition = React.useRef(noop);\n\n  React.useEffect(() => () => {\n    const id = getNavId({ nav, id: restProps.id });\n    if (id) {\n      scrollsCache[id] = scrolls.current;\n    }\n  });\n\n  const panelNodes = React.useRef<{ [id: string]: HTMLDivElement | null }>({});\n\n  const { window, document } = useDOM();\n  const scroll = useScroll();\n  const configProvider = useConfigProvider();\n  const splitCol = useSplitCol();\n  const platform = usePlatform();\n\n  const [animated, setAnimated] = React.useState(false);\n\n  const [visiblePanels, setVisiblePanels] = React.useState([activePanelProp]);\n  const [activePanel, setActivePanel] = React.useState<string | null>(\n    activePanelProp\n  );\n  const [isBack, setIsBack] = React.useState<boolean | undefined>(undefined);\n  const [prevPanel, setPrevPanel] = React.useState<string | null>(null);\n  const [nextPanel, setNextPanel] = React.useState<string | null>(null);\n\n  const [swipingBack, setSwipingBack] = React.useState<boolean>(false);\n  const [swipeBackStartX, setSwipeBackStartX] = React.useState<number>(0);\n  const [swipeBackShift, setSwipeBackShift] = React.useState<number>(0);\n  const [swipeBackNextPanel, setSwipeBackNextPanel] = React.useState<\n    string | null\n  >(null);\n  const [swipeBackPrevPanel, setSwipeBackPrevPanel] = React.useState<\n    string | null\n  >(null);\n  const [swipeBackResult, setSwipeBackResult] =\n    React.useState<SwipeBackResults | null>(null);\n\n  const [browserSwipe, setBrowserSwipe] = React.useState(false);\n\n  const prevActivePanel = usePrevious(activePanelProp);\n  const prevSwipingBack = usePrevious(swipingBack);\n  const prevBrowserSwipe = usePrevious(browserSwipe);\n  const prevSwipeBackResult = usePrevious(swipeBackResult);\n  const prevSwipeBackPrevPanel = usePrevious(swipeBackPrevPanel);\n  const prevOnTransition = usePrevious(onTransition);\n\n  const hasPopout = !!popout;\n  const hasModal = !!modal;\n\n  const panels = (\n    React.Children.toArray(children) as React.ReactElement[]\n  ).filter((panel: React.ReactElement) => {\n    const panelId = getNavId(panel.props, warn);\n\n    return (\n      (panelId !== undefined && visiblePanels.includes(panelId)) ||\n      panelId === swipeBackPrevPanel ||\n      panelId === swipeBackNextPanel\n    );\n  });\n\n  const disableAnimation =\n    configProvider?.transitionMotionEnabled === false || !splitCol?.animate;\n\n  const pickPanel = (id: string | null) => {\n    if (id === null) {\n      return null;\n    }\n    return panelNodes.current[id];\n  };\n\n  const flushTransition = React.useCallback(\n    (prevPanel: string, isBackTransition: boolean) => {\n      if (isBackTransition) {\n        scrolls.current[prevPanel] = 0;\n      }\n      setPrevPanel(null);\n      setNextPanel(null);\n      setVisiblePanels([activePanelProp]);\n      setActivePanel(activePanelProp);\n      setAnimated(false);\n      setIsBack(undefined);\n\n      afterTransition.current = () => {\n        scroll?.scrollTo(\n          0,\n          isBackTransition ? scrolls.current[activePanelProp] : 0\n        );\n        onTransition &&\n          onTransition({\n            isBack: isBackTransition,\n            from: prevPanel,\n            to: activePanelProp,\n          });\n      };\n    },\n    [activePanelProp, onTransition, scroll]\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    afterTransition.current();\n    afterTransition.current = noop;\n  }, [afterTransition.current]);\n\n  const transitionEndHandler = React.useCallback(\n    (e?: React.AnimationEvent): void => {\n      if (\n        (!e ||\n          [\n            \"vkui-animation-ios-next-forward\",\n            \"vkui-animation-ios-prev-back\",\n            \"vkui-animation-view-next-forward\",\n            \"vkui-animation-view-prev-back\",\n          ].includes(e.animationName)) &&\n        prevPanel !== null\n      ) {\n        flushTransition(prevPanel, Boolean(isBack));\n      }\n    },\n    [flushTransition, isBack, prevPanel]\n  );\n\n  const { waitTransitionFinish } = useWaitTransitionFinish();\n  const animationFinishTimeout = useTimeout(\n    transitionEndHandler,\n    platform === IOS ? 600 : 300\n  );\n\n  const onSwipeBackSuccess = React.useCallback(() => {\n    onSwipeBack && onSwipeBack();\n  }, [onSwipeBack]);\n\n  const onSwipeBackCancel = React.useCallback(() => {\n    onSwipeBackCancelProp && onSwipeBackCancelProp();\n    setSwipeBackPrevPanel(null);\n    setSwipeBackNextPanel(null);\n    setSwipingBack(false);\n    setSwipeBackResult(null);\n    setSwipeBackStartX(0);\n    setSwipeBackShift(0);\n  }, [onSwipeBackCancelProp]);\n\n  const swipingBackTransitionEndHandler = React.useCallback(\n    (e?: TransitionEvent): void => {\n      // indexOf because of vendor prefixes in old browsers\n      if (\n        !e ||\n        (e?.propertyName.includes(\"transform\") &&\n          e?.target === pickPanel(swipeBackNextPanel))\n      ) {\n        switch (swipeBackResult) {\n          case SwipeBackResults.fail:\n            onSwipeBackCancel();\n            break;\n          case SwipeBackResults.success:\n            onSwipeBackSuccess();\n        }\n      }\n    },\n    [onSwipeBackCancel, onSwipeBackSuccess, swipeBackNextPanel, swipeBackResult]\n  );\n\n  const onMoveX = (e: TouchEvent): void => {\n    if (swipeBackExcluded(e)) {\n      return;\n    }\n\n    if (\n      platform === IOS &&\n      !configProvider?.isWebView &&\n      (e.startX <= 70 || e.startX >= window!.innerWidth - 70) &&\n      !browserSwipe\n    ) {\n      setBrowserSwipe(true);\n    }\n\n    if (platform === IOS && configProvider?.isWebView && onSwipeBack) {\n      if ((animated && e.startX <= 70) || !window) {\n        return;\n      }\n\n      if (e.startX <= 70 && !swipingBack && history && history.length > 1) {\n        if (activePanel !== null) {\n          scrolls.current[activePanel] = scroll?.getScroll().y;\n        }\n\n        setSwipingBack(true);\n        setSwipeBackStartX(e.startX);\n        setSwipeBackPrevPanel(activePanel);\n        setSwipeBackNextPanel(history.slice(-2)[0]);\n      }\n      if (swipingBack) {\n        let swipeBackShift = 0;\n        if (e.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (e.shiftX > window.innerWidth - swipeBackStartX) {\n          swipeBackShift = window?.innerWidth;\n        } else {\n          swipeBackShift = e.shiftX;\n        }\n        setSwipeBackShift(swipeBackShift);\n      }\n    }\n  };\n\n  const onEnd = React.useCallback(\n    (e: TouchEvent): void => {\n      if (swipingBack && window) {\n        const speed = (swipeBackShift / e.duration) * 1000;\n        if (swipeBackShift === 0) {\n          onSwipeBackCancel();\n        } else if (swipeBackShift >= (window?.innerWidth ?? 0)) {\n          onSwipeBackSuccess();\n        } else if (\n          speed > 250 ||\n          swipeBackStartX + swipeBackShift > window.innerWidth / 2\n        ) {\n          setSwipeBackResult(SwipeBackResults.success);\n        } else {\n          setSwipeBackResult(SwipeBackResults.fail);\n        }\n      }\n    },\n    [\n      onSwipeBackCancel,\n      onSwipeBackSuccess,\n      swipeBackShift,\n      swipeBackStartX,\n      swipingBack,\n      window,\n    ]\n  );\n\n  const calcPanelSwipeStyles = (\n    panelId: string | undefined\n  ): React.CSSProperties => {\n    if (!canUseDOM || !window) {\n      return {};\n    }\n\n    const isPrev = panelId === swipeBackPrevPanel;\n    const isNext = panelId === swipeBackNextPanel;\n\n    if ((!isPrev && !isNext) || swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${swipeBackShift}px`;\n    let nextPanelTranslate = `${\n      -50 + (swipeBackShift * 100) / window.innerWidth / 2\n    }%`;\n    let prevPanelShadow =\n      (0.3 * (window.innerWidth - swipeBackShift)) / window.innerWidth;\n\n    if (swipeBackResult) {\n      return isPrev\n        ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` }\n        : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  };\n\n  React.useEffect(() => {\n    popout && blurActiveElement(document);\n  }, [document, popout]);\n\n  React.useEffect(() => {\n    modal && blurActiveElement(document);\n  }, [document, modal]);\n\n  React.useEffect(() => {\n    // Нужен переход\n    if (\n      prevActivePanel &&\n      prevActivePanel !== activePanelProp &&\n      !prevSwipingBack &&\n      !prevBrowserSwipe\n    ) {\n      const firstLayerId = (\n        React.Children.toArray(children) as React.ReactElement[]\n      )\n        .map((panel) => getNavId(panel.props, warn))\n        .find((id) => id === prevActivePanel || id === activePanelProp);\n\n      const isBackTransition = firstLayerId === activePanelProp;\n      scrolls.current[prevActivePanel] = scroll?.getScroll().y;\n\n      if (disableAnimation) {\n        flushTransition(prevActivePanel, isBackTransition);\n      } else {\n        blurActiveElement(document);\n\n        setVisiblePanels([prevActivePanel, activePanelProp]);\n        setPrevPanel(prevActivePanel);\n        setNextPanel(activePanelProp);\n        setActivePanel(null);\n        setAnimated(true);\n        setIsBack(isBackTransition);\n\n        // Фолбек анимации перехода\n        if (!animationEvent.supported) {\n          animationFinishTimeout.set();\n        }\n      }\n    }\n\n    // Закончилась анимация свайпа назад\n    if (\n      prevActivePanel &&\n      prevActivePanel !== activePanelProp &&\n      prevSwipingBack\n    ) {\n      const nextPanel = activePanelProp;\n      const prevPanel = prevActivePanel;\n      if (prevSwipeBackPrevPanel) {\n        scrolls.current[prevSwipeBackPrevPanel] = 0;\n      }\n\n      setSwipeBackPrevPanel(null);\n      setSwipeBackNextPanel(null);\n      setSwipingBack(false);\n      setSwipeBackResult(null);\n      setSwipeBackStartX(0);\n      setSwipeBackShift(0);\n      setActivePanel(nextPanel);\n      setVisiblePanels([nextPanel]);\n\n      afterTransition.current = () => {\n        if (nextPanel !== null) {\n          scroll?.scrollTo(0, scrolls.current[nextPanel]);\n        }\n        prevOnTransition &&\n          prevOnTransition({\n            isBack: true,\n            from: prevPanel,\n            to: nextPanel,\n          });\n      };\n    }\n\n    // Начался свайп назад\n    if (!prevSwipingBack && swipingBack) {\n      onSwipeBackStart && onSwipeBackStart();\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevSwipeBackResult && swipeBackResult) {\n      waitTransitionFinish(\n        pickPanel(swipeBackNextPanel),\n        swipingBackTransitionEndHandler,\n        platform === IOS ? 600 : 300\n      );\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (\n      prevSwipeBackResult === SwipeBackResults.fail &&\n      !swipeBackResult &&\n      activePanel !== null\n    ) {\n      scroll?.scrollTo(0, scrolls.current[activePanel]);\n    }\n\n    // Закончился Safari свайп\n    if (prevActivePanel !== activePanelProp && browserSwipe) {\n      setBrowserSwipe(false);\n      setNextPanel(null);\n      setPrevPanel(null);\n      setAnimated(false);\n      setVisiblePanels([activePanelProp]);\n      setActivePanel(activePanelProp);\n    }\n  }, [\n    activePanelProp,\n    activePanel,\n    animationFinishTimeout,\n    browserSwipe,\n    children,\n    disableAnimation,\n    document,\n    flushTransition,\n    onSwipeBackStart,\n    panels,\n    platform,\n    prevActivePanel,\n    prevBrowserSwipe,\n    prevOnTransition,\n    prevSwipeBackPrevPanel,\n    prevSwipeBackResult,\n    prevSwipingBack,\n    scroll,\n    swipeBackNextPanel,\n    swipeBackResult,\n    swipingBack,\n    swipingBackTransitionEndHandler,\n    waitTransitionFinish,\n  ]);\n\n  return (\n    <Touch\n      Component=\"section\"\n      {...restProps}\n      vkuiClass={classNames(\n        \"View\",\n        platform === IOS && \"View--ios\",\n        !disableAnimation && animated && \"View--animated\",\n        !disableAnimation && swipingBack && \"View--swiping-back\",\n        disableAnimation && \"View--no-motion\"\n      )}\n      onMoveX={onMoveX}\n      onEnd={onEnd}\n    >\n      <div vkuiClass=\"View__panels\">\n        {panels.map((panel: React.ReactElement) => {\n          const panelId = getNavId(panel.props, warn);\n          const isPrev =\n            panelId === prevPanel || panelId === swipeBackPrevPanel;\n          const isTransitionTarget =\n            animated && panelId === (isBack ? prevPanel : nextPanel);\n          const compensateScroll =\n            isPrev ||\n            panelId === swipeBackNextPanel ||\n            (panelId === nextPanel && isBack);\n\n          return (\n            <div\n              vkuiClass={classNames(\n                \"View__panel\",\n                panelId === activePanel && \"View__panel--active\",\n                panelId === prevPanel && \"View__panel--prev\",\n                panelId === nextPanel && \"View__panel--next\",\n                panelId === swipeBackPrevPanel &&\n                  \"View__panel--swipe-back-prev\",\n                panelId === swipeBackNextPanel &&\n                  \"View__panel--swipe-back-next\",\n                swipeBackResult === SwipeBackResults.success &&\n                  \"View__panel--swipe-back-success\",\n                swipeBackResult === SwipeBackResults.fail &&\n                  \"View__panel--swipe-back-failed\"\n              )}\n              onAnimationEnd={\n                isTransitionTarget ? transitionEndHandler : undefined\n              }\n              ref={(el) =>\n                panelId !== undefined && (panelNodes.current[panelId] = el)\n              }\n              style={calcPanelSwipeStyles(panelId)}\n              key={panelId}\n            >\n              <div\n                vkuiClass=\"View__panel-in\"\n                style={{\n                  marginTop: compensateScroll\n                    ? -(scrolls.current[panelId as string] ?? 0)\n                    : undefined,\n                }}\n              >\n                <NavTransitionProvider\n                  entering={\n                    panelId === nextPanel || panelId === swipeBackNextPanel\n                  }\n                >\n                  {panel}\n                </NavTransitionProvider>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n      <AppRootPortal>\n        {hasPopout && <div vkuiClass=\"View__popout\">{popout}</div>}\n        {hasModal && <div vkuiClass=\"View__modal\">{modal}</div>}\n      </AppRootPortal>\n    </Touch>\n  );\n};\n"],"file":"View.js"}