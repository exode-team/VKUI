{"version":3,"file":"UsersStack.js","names":["UsersStack","props","platform","usePlatform","photos","visibleCount","size","layout","children","restProps","useDOM","document","useIsomorphicLayoutEffect","createMasks","othersCount","Math","max","length","canShowOthers","photosShown","slice","parseSize","xs","s","m","getClipPath","index","classNames","getClassName","map","item","i","clipPath","hasReactNode"],"sources":["../../../../src/components/UsersStack/UsersStack.tsx"],"sourcesContent":["import * as React from 'react';\nimport { getClassName } from '../../helpers/getClassName';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { hasReactNode } from '../../lib/utils';\nimport { classNames } from '../../lib/classNames';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { Caption } from '../Typography/Caption/Caption';\nimport { Subhead } from '../Typography/Subhead/Subhead';\nimport { createMasks } from './masks';\nimport { useDOM } from '../../lib/dom';\nimport './UsersStack.css';\n\nexport interface UsersStackProps extends React.HTMLAttributes<HTMLDivElement> {\n  /**\n   * Массив ссылок на фотографии\n   */\n  photos?: React.ReactNode[];\n  /**\n   * Размер аватарок\n   */\n  size?: 'xs' | 's' | 'm';\n  /**\n   * Вертикальный режим рекомендуется использовать с размером `m`\n   */\n  layout?: 'vertical' | 'horizontal';\n  /**\n   * Количество аватарок, которые будут показаны.\n   * Если в массиве `photos` больше элементов и используется размер `m`, то будет показано количество остальных элементов\n   */\n  visibleCount?: number;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/UsersStack\n */\nexport const UsersStack: React.FC<UsersStackProps> = (props: UsersStackProps) => {\n  const platform = usePlatform();\n  const {\n    photos = [],\n    visibleCount = 3,\n    size = 's',\n    layout = 'horizontal',\n    children,\n    ...restProps\n  } = props;\n  const {document} = useDOM();\n\n  useIsomorphicLayoutEffect(() => {\n    createMasks(document);\n  }, [document]);\n\n  const othersCount = Math.max(0, photos.length - visibleCount);\n  const canShowOthers = othersCount > 0 && size === 'm';\n\n  const photosShown = photos.slice(0, visibleCount);\n\n  const parseSize = {\n    xs: 16,\n    s: 24,\n    m: 32,\n  };\n\n  const getClipPath = (index: number) => index === 0 ? '' : `url(#users_stack_mask_${parseSize[size]}_left)`\n\n  return (\n    <div\n      {...restProps}\n      // eslint-disable-next-line vkui/no-object-expression-in-arguments\n      vkuiClass={classNames(\n        getClassName('UsersStack', platform),\n        `UsersStack--size-${size}`,\n        `UsersStack--l-${layout}`,\n        {\n          'UsersStack--others': canShowOthers,\n        }\n      )}\n    >\n      <div vkuiClass=\"UsersStack__photos\" role=\"presentation\">\n        {photosShown.map((item, i) => (\n          <div\n                key={i}\n                vkuiClass=\"UsersStack__photo\"\n                style={{clipPath: getClipPath(i)}}\n              >\n                {item}\n              </div>\n        ))}\n\n        {canShowOthers && (\n          <Caption\n            weight=\"1\"\n            vkuiClass=\"UsersStack__photo UsersStack__photo--others\"\n            aria-hidden=\"true\"\n          >\n            <span>+{othersCount}</span>\n          </Caption>\n        )}\n      </div>\n      {hasReactNode(children) && (\n        <Subhead Component=\"span\" vkuiClass=\"UsersStack__text\">\n          {children}\n        </Subhead>\n      )}\n    </div>\n  );\n};\n\n// eslint-disable-next-line import/no-default-export\n"],"mappings":";;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAuC;AAuBvC;AACA;AACA;AACO,IAAMA,UAAqC,GAAG,SAAxCA,UAAqC,CAAIC,KAAsB,EAAK;EAC/E,IAAMC,QAAQ,GAAG,IAAAC,wBAAW,GAAE;EAC9B,oBAOIF,KAAK,CANPG,MAAM;IAANA,MAAM,8BAAG,EAAE;IAAA,sBAMTH,KAAK,CALPI,YAAY;IAAZA,YAAY,oCAAG,CAAC;IAAA,cAKdJ,KAAK,CAJPK,IAAI;IAAJA,IAAI,4BAAG,GAAG;IAAA,gBAIRL,KAAK,CAHPM,MAAM;IAANA,MAAM,8BAAG,YAAY;IACrBC,QAAQ,GAENP,KAAK,CAFPO,QAAQ;IACLC,SAAS,0CACVR,KAAK;EACT,cAAmB,IAAAS,WAAM,GAAE;IAApBC,QAAQ,WAARA,QAAQ;EAEf,IAAAC,oDAAyB,EAAC,YAAM;IAC9B,IAAAC,kBAAW,EAACF,QAAQ,CAAC;EACvB,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;EAEd,IAAMG,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEZ,MAAM,CAACa,MAAM,GAAGZ,YAAY,CAAC;EAC7D,IAAMa,aAAa,GAAGJ,WAAW,GAAG,CAAC,IAAIR,IAAI,KAAK,GAAG;EAErD,IAAMa,WAAW,GAAGf,MAAM,CAACgB,KAAK,CAAC,CAAC,EAAEf,YAAY,CAAC;EAEjD,IAAMgB,SAAS,GAAG;IAChBC,EAAE,EAAE,EAAE;IACNC,CAAC,EAAE,EAAE;IACLC,CAAC,EAAE;EACL,CAAC;EAED,IAAMC,WAAW,GAAG,SAAdA,WAAW,CAAIC,KAAa;IAAA,OAAKA,KAAK,KAAK,CAAC,GAAG,EAAE,mCAA4BL,SAAS,CAACf,IAAI,CAAC,WAAQ;EAAA;EAE1G,OACE,uEACMG,SAAS;IACb;IACA,SAAS,EAAE,IAAAkB,sBAAU,EACnB,IAAAC,0BAAY,EAAC,YAAY,EAAE1B,QAAQ,CAAC,6BAChBI,IAAI,2BACPC,MAAM,GACvB;MACE,oBAAoB,EAAEW;IACxB,CAAC;EACD,IAEF;IAAK,SAAS,EAAC,oBAAoB;IAAC,IAAI,EAAC;EAAc,GACpDC,WAAW,CAACU,GAAG,CAAC,UAACC,IAAI,EAAEC,CAAC;IAAA,OACvB;MACM,GAAG,EAAEA,CAAE;MACP,SAAS,EAAC,mBAAmB;MAC7B,KAAK,EAAE;QAACC,QAAQ,EAAEP,WAAW,CAACM,CAAC;MAAC;IAAE,GAEjCD,IAAI,CACD;EAAA,CACX,CAAC,EAEDZ,aAAa,IACZ,qCAAC,gBAAO;IACN,MAAM,EAAC,GAAG;IACV,SAAS,EAAC,6CAA6C;IACvD,eAAY;EAAM,GAElB,wDAAQJ,WAAW,CAAQ,CAE9B,CACG,EACL,IAAAmB,mBAAY,EAACzB,QAAQ,CAAC,IACrB,qCAAC,gBAAO;IAAC,SAAS,EAAC,MAAM;IAAC,SAAS,EAAC;EAAkB,GACnDA,QAAQ,CAEZ,CACG;AAEV,CAAC;;AAED;AAAA"}