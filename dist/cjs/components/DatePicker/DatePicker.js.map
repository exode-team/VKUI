{"version":3,"file":"DatePicker.js","names":["DefaultMonths","convertToInputFormat","day","month","year","leadingZero","parseInputDate","date","splited","split","Number","getMonthMaxDay","Date","getDate","range","start","end","swap","arr","i","Math","min","max","push","reverse","DatePickerCustom","name","dayPlaceholder","monthPlaceholder","yearPlaceholder","popupDirection","defaultValue","hasMouse","monthNames","onDateChange","disabled","restProps","onSelectChange","e","target","value","dayOptions","map","label","String","monthOptions","index","yearOptions","DatePickerNative","defProps","onStringChange","React","useCallback","currentTarget","DatePickerComponent","props","useState","setValue","update","Cmp","DatePicker","withAdaptivity","displayName"],"sources":["../../../../src/components/DatePicker/DatePicker.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Input } from \"../Input/Input\";\nimport { withAdaptivity, AdaptivityProps } from \"../../hoc/withAdaptivity\";\nimport { HasPlatform } from \"../../types\";\nimport { leadingZero } from \"../../lib/utils\";\nimport { CustomSelect } from \"../CustomSelect/CustomSelect\";\nimport \"./DatePicker.css\";\n\nconst DefaultMonths: string[] = [\n  \"Января\",\n  \"Февраля\",\n  \"Марта\",\n  \"Апреля\",\n  \"Мая\",\n  \"Июня\",\n  \"Июля\",\n  \"Августа\",\n  \"Сентября\",\n  \"Октября\",\n  \"Ноября\",\n  \"Декабря\",\n];\n\nexport type DatePickerDateFormat = {\n  day: number;\n  month: number;\n  year: number;\n};\n\nexport interface DatePickerProps\n  extends Omit<\n      React.HTMLAttributes<HTMLDivElement>,\n      \"defaultValue\" | \"min\" | \"max\"\n    >,\n    HasPlatform,\n    AdaptivityProps {\n  min?: DatePickerDateFormat;\n  max?: DatePickerDateFormat;\n  name?: string;\n  defaultValue?: DatePickerDateFormat;\n  popupDirection?: \"top\" | \"bottom\";\n  monthNames?: string[];\n  dayPlaceholder?: string;\n  monthPlaceholder?: string;\n  yearPlaceholder?: string;\n  onDateChange?: (value: DatePickerDateFormat) => void;\n  disabled?: boolean;\n}\n\n// Переводим state к формату гг-мм-дд\nfunction convertToInputFormat({\n  day = 0,\n  month = 0,\n  year = 0,\n}: Partial<DatePickerDateFormat>) {\n  return `${year}-${leadingZero(month)}-${leadingZero(day)}`;\n}\n\n// Переводим дату формата гг-мм-дд к объекту\nfunction parseInputDate(date: string): DatePickerDateFormat {\n  const splited = date.split(\"-\");\n\n  return {\n    day: Number(splited[2]),\n    month: Number(splited[1]),\n    year: Number(splited[0]),\n  };\n}\n\nfunction getMonthMaxDay(month?: number, year?: number) {\n  return month ? new Date(year || 2016, month, 0).getDate() : 31;\n}\n\nconst range = (start: number, end: number) => {\n  const swap = start > end;\n  const arr = [];\n  for (let i = Math.min(start, end); i <= Math.max(start, end); i++) {\n    arr.push(i);\n  }\n  return swap ? arr.reverse() : arr;\n};\n\nconst DatePickerCustom = ({\n  name,\n  min = { day: 0, month: 0, year: 0 },\n  max = { day: 31, month: 12, year: 2100 },\n  dayPlaceholder,\n  monthPlaceholder,\n  yearPlaceholder,\n  popupDirection,\n  defaultValue,\n  hasMouse,\n  monthNames,\n  day = 0,\n  month = 0,\n  year = 0,\n  onDateChange,\n  disabled,\n  ...restProps\n}: DatePickerProps & Partial<DatePickerDateFormat>) => {\n  const onSelectChange: React.ChangeEventHandler<HTMLSelectElement> = (e) => {\n    onDateChange?.({\n      day,\n      month,\n      year,\n      [e.target.name]: Number(e.target.value),\n    });\n  };\n  const dayOptions = range(1, getMonthMaxDay(month, year)).map((value) => ({\n    label: String(value),\n    value,\n  }));\n  const monthOptions = (monthNames || DefaultMonths).map((name, index) => ({\n    label: name,\n    value: index + 1,\n  }));\n  const yearOptions = range(max.year, min.year).map((value) => ({\n    label: String(value),\n    value: value,\n  }));\n  return (\n    <div vkuiClass=\"DatePicker\" {...restProps}>\n      <div vkuiClass=\"DatePicker__container\">\n        <div vkuiClass=\"DatePicker__day\">\n          <CustomSelect\n            name=\"day\"\n            value={day}\n            options={dayOptions}\n            placeholder={dayPlaceholder}\n            popupDirection={popupDirection}\n            onChange={onSelectChange}\n            disabled={disabled}\n          />\n        </div>\n        <div vkuiClass=\"DatePicker__month\">\n          <CustomSelect\n            vkuiClass=\"DatePicker__monthSelect\"\n            name=\"month\"\n            value={month}\n            options={monthOptions}\n            placeholder={monthPlaceholder}\n            popupDirection={popupDirection}\n            onChange={onSelectChange}\n            disabled={disabled}\n          />\n        </div>\n        <div vkuiClass=\"DatePicker__year\">\n          <CustomSelect\n            name=\"year\"\n            value={year}\n            options={yearOptions}\n            placeholder={yearPlaceholder}\n            popupDirection={popupDirection}\n            onChange={onSelectChange}\n            disabled={disabled}\n          />\n        </div>\n      </div>\n      <input\n        type=\"hidden\"\n        name={name}\n        value={convertToInputFormat({ day, month, year })}\n      />\n    </div>\n  );\n};\n\nconst DatePickerNative = ({\n  min = { day: 0, month: 0, year: 0 },\n  max = { day: 31, month: 12, year: 2100 },\n  dayPlaceholder,\n  monthPlaceholder,\n  yearPlaceholder,\n  popupDirection,\n  defaultValue,\n  hasMouse,\n  day,\n  month,\n  year,\n  onDateChange,\n  ...restProps\n}: DatePickerProps & Partial<DatePickerDateFormat>) => {\n  const defProps =\n    day && month && year\n      ? { defaultValue: convertToInputFormat({ day, month, year }) }\n      : {};\n  const onStringChange: React.ChangeEventHandler<HTMLInputElement> =\n    React.useCallback(\n      (e) => {\n        onDateChange?.(parseInputDate(e.currentTarget.value));\n      },\n      [onDateChange]\n    );\n  return (\n    <Input\n      {...restProps}\n      type=\"date\"\n      onChange={onStringChange}\n      min={convertToInputFormat(min)}\n      max={convertToInputFormat(max)}\n      {...defProps}\n    />\n  );\n};\n\n/**\n * @see https://vkcom.github.io/VKUI/#/DatePicker\n */\nconst DatePickerComponent = ({\n  hasMouse,\n  defaultValue,\n  ...props\n}: DatePickerProps) => {\n  const [value, setValue] = React.useState<Partial<DatePickerDateFormat>>(\n    () => ({\n      day: defaultValue?.day || 0,\n      month: defaultValue?.month || 0,\n      year: defaultValue?.year || 0,\n    })\n  );\n\n  const onDateChange = React.useCallback(\n    (update: DatePickerDateFormat) => {\n      setValue(update);\n      props.onDateChange && props.onDateChange({ ...update });\n    },\n    [props]\n  );\n\n  const Cmp = hasMouse ? DatePickerCustom : DatePickerNative;\n  return <Cmp {...props} {...value} onDateChange={onDateChange} />;\n};\n\nexport const DatePicker = withAdaptivity(DatePickerComponent, {\n  hasMouse: true,\n});\n\nDatePicker.displayName = \"DatePicker\";\n"],"mappings":"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"}